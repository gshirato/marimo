const __vite__fileDeps=["./index-Bnk1doKe.js","./VegaLite-WSiVtzoI.js","./index-DsqxS_Ng.js","./index-DwcK_DmX.css","./time-BsMSBVff.js","./timer-Di1g2zcK.js","./linear-DZ3ZOBQ1.js","./init-DLRA0X12.js","./range-CtcPcB_L.js","./index-DN6l6zc8.js","./ordinal-DDUp3AbE.js","./arc-CyWW4RED.js","./path-qnb_ma6O.js","./step-CPXY0cSE.js","./array-DmjLdZ15.js","./line-BfNOlI_-.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var e=Object.defineProperty,t=(t,n,r)=>(((t,n,r)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r})(t,"symbol"!=typeof n?n+"":n,r),r);import{c as n,$ as r,r as o,K as i,M as a,R as s,N as l,O as c,o as d,P as u,Q as h,S as f,U as p,V as g,W as m,X as v,Y as y,j as x,T as b,Z as w,_ as k,a0 as E,D as C,a1 as S,a2 as N,z as j,E as I,F as O,b as M,G as D,a3 as T,B as P,I as A,a4 as _,a5 as R,a6 as z,a7 as L,a8 as B,a9 as F,aa as H,ab as V,ac as $,ad as W,ae as U,af as Y,ag as G,ah as q,ai as K,m as X,aj as Z,ak as J,t as Q,al as ee,am as te,an as ne,ao as re,ap as oe,aq as ie,L as ae,ar as se,as as le,at as ce,au as de,av as ue,aw as he,ax as fe,ay as pe,az as ge,aA as me,aB as ve,aC as ye,aD as xe,aE as be,aF as we,aG as ke,aH as Ee,aI as Ce,aJ as Se,aK as Ne,aL as je,aM as Ie,aN as Oe,aO as Me,aP as De,aQ as Te,aR as Pe,aS as Ae,w as _e,aT as Re,aU as ze,aV as Le,H as Be,aW as Fe,A as He,aX as Ve,aY as $e,aZ as We,a_ as Ue,a$ as Ye,b0 as Ge,b1 as qe,b2 as Ke,b3 as Xe,b4 as Ze,x as Je,J as Qe,b5 as et,b6 as tt,b7 as nt,b8 as rt,b9 as ot,ba as it,bb as at,bc as st,bd as lt,be as ct,bf as dt,bg as ut,bh as ht,bi as ft,bj as pt,bk as gt,bl as mt,bm as vt,bn as yt,bo as xt,bp as bt,bq as wt,br as kt,bs as Et,bt as Ct,bu as St,bv as Nt,bw as jt,bx as It,by as Ot,e as Mt,bz as Dt,bA as Tt,bB as Pt,bC as At,u as _t,bD as Rt,bE as zt,bF as Lt,bG as Bt,bH as Ft,bI as Ht,bJ as Vt,bK as $t,bL as Wt,bM as Ut,bN as Yt,bO as Gt,bP as qt,bQ as Kt,bR as Xt,bS as Zt,bT as Jt,bU as Qt,bV as en,bW as tn,bX as nn,bY as rn,bZ as on,b_ as an,b$ as sn,c0 as ln,c1 as cn,c2 as dn,c3 as un,c4 as hn,c5 as fn,c6 as pn,c7 as gn,c8 as mn,c9 as vn,ca as yn,cb as xn,cc as bn,cd as wn,ce as kn,cf as En,cg as Cn,ch as Sn,ci as Nn,cj as jn,ck as In,cl as On,cm as Mn,cn as Dn,co as Tn,cp as Pn,cq as An,cr as _n,cs as Rn,ct as zn,cu as Ln,cv as Bn,cw as Fn,cx as Hn,cy as Vn,cz as $n,cA as Wn,cB as Un,cC as Yn,cD as Gn,cE as qn,cF as Kn,cG as Xn,cH as Zn,cI as Jn,cJ as Qn,cK as er,cL as tr,cM as nr,cN as rr,cO as or,cP as ir,cQ as ar,cR as sr,cS as lr,cT as cr,cU as dr,cV as ur,cW as hr,cX as fr,cY as pr,cZ as gr,c_ as mr,c$ as vr,d0 as yr,d1 as xr,d2 as br,d3 as wr,d4 as kr,d5 as Er,d6 as Cr,d7 as Sr,d8 as Nr,d9 as jr,da as Ir,db as Or,dc as Mr,dd as Dr,de as Tr,df as Pr,dg as Ar,dh as _r,di as Rr,dj as zr,dk as Lr,dl as Br,dm as Fr,dn as Hr,dp as Vr,dq as $r,dr as Wr,C as Ur,ds as Yr,dt as Gr,du as qr,dv as Kr,dw as Xr,dx as Zr,dy as Jr,dz as Qr,dA as eo,dB as to,dC as no,dD as ro,dE as oo,dF as io,dG as ao,dH as so,dI as lo,dJ as co,dK as uo,dL as ho,dM as fo,dN as po,dO as go,dP as mo,dQ as vo,dR as yo,dS as xo,dT as bo,dU as wo,dV as ko,dW as Eo,dX as Co,p as So,n as No,f as jo,dY as Io,dZ as Oo,d_ as Mo,d$ as Do,e0 as To,q as Po,e1 as Ao,e2 as _o,e3 as Ro,e4 as zo,e5 as Lo,e6 as Bo,e7 as Fo,e8 as Ho,e9 as Vo,ea as $o,eb as Wo,ec as Uo,ed as Yo,ee as Go,ef as qo,eg as Ko,eh as Xo,ei as Zo,ej as Jo,ek as Qo,el as ei,em as ti,en as ni,eo as ri,ep as oi,eq as ii,er as ai,es as si,et as li,eu as ci,ev as di,ew as ui,ex as hi,ey as fi,ez as pi,eA as gi,eB as mi,eC as vi,eD as yi,eE as xi,eF as bi,eG as wi,eH as ki,eI as Ei,eJ as Ci,eK as Si,eL as Ni,eM as ji,eN as Ii,eO as Oi,eP as Mi,eQ as Di,eR as Ti,eS as Pi,eT as Ai,eU as _i,eV as Ri,eW as zi,eX as Li,eY as Bi,eZ as Fi,e_ as Hi,e$ as Vi,f0 as $i,f1 as Wi,f2 as Ui}from"./index-DsqxS_Ng.js";import{K as Yi,B as Gi,M as qi,b as Ki,C as Xi,a as Zi,i as Ji,c as Qi,d as ea,e as ta,g as na,f as ra,h as oa,L as ia,k as aa,u as sa,P as la,S as ca,j as da}from"./icons-B78K2GQn.js";import{b as ua,c as ha,v as fa,N as pa,V as ga,d as ma,W as va,F as ya,e as xa,M as ba,f as wa,g as ka,h as Ea,i as Ca,j as Sa,k as Na,l as ja,m as Ia,n as Oa,R as Ma,u as Da,o as Ta,A as Pa,a as Aa,C as _a,T as Ra,p as za,q as La,r as Ba}from"./useMarimoWebSocket-dPuoiHCa.js";import{s as Fa,i as Ha,T as Va,a as $a}from"./transform-Ce3W16l2.js";import{d as Wa}from"./timer-Di1g2zcK.js";import{i as Ua,e as Ya}from"./index-DN6l6zc8.js";import{s as Ga}from"./sortBy-TyFKKSh6.js";import{H as qa,T as Ka,L as Xa}from"./type-DpPsb-lg.js";import"./_baseEach-BF5ufIXD.js";
/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=n("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Ja=n("ArrowRightFromLine",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M21 12H7",key:"13ipq5"}],["path",{d:"m15 18 6-6-6-6",key:"6tx3qv"}]]),Qa=n("ArrowRightToLine",[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]]),es=n("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),ts=n("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),ns=n("BetweenHorizontalStart",[["rect",{width:"13",height:"7",x:"8",y:"3",rx:"1",key:"pkso9a"}],["path",{d:"m2 9 3 3-3 3",key:"1agib5"}],["rect",{width:"13",height:"7",x:"8",y:"14",rx:"1",key:"1q5fc1"}]]),rs=n("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]),os=n("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),is=n("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]),as=n("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]),ss=n("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ls=n("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),cs=n("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),ds=n("ClipboardPaste",[["path",{d:"M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z",key:"1pp7kr"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10",key:"2ik1ml"}],["path",{d:"m17 10 4 4-4 4",key:"vp2hj1"}]]),us=n("CloudDownload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),hs=n("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),fs=n("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]),ps=n("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),gs=n("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),ms=n("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),vs=n("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ys=n("FilePen",[["path",{d:"M12 22h6a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v10",key:"x7tsz2"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10.4 12.6a2 2 0 1 1 3 3L8 21l-4 1 1-4Z",key:"o3xyfb"}]]),xs=n("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]),bs=n("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),ws=n("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),ks=n("HardDriveDownload",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 18h.01",key:"h775k"}]]),Es=n("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),Cs=n("LayoutTemplate",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]]),Ss=n("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Ns=n("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),js=n("MemoryStick",[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]]),Is=n("MessageCircleQuestion",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Os=n("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),Ms=n("PackageCheck",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),Ds=n("PackageX",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]]),Ts=n("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]),Ps=n("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12v0c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"bpx1uq"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11v0c-.11.7-.72 1.22-1.43 1.22H17",key:"1pd0s7"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98v0C9.52 4.9 9 5.52 9 6.23V7",key:"zq5xbz"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]),As=n("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),_s=n("Regex",[["path",{d:"M17 3v10",key:"15fgeh"}],["path",{d:"m12.67 5.5 8.66 5",key:"1gpheq"}],["path",{d:"m12.67 10.5 8.66-5",key:"1dkfa6"}],["path",{d:"M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z",key:"swwfx4"}]]),Rs=n("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),zs=n("Rows3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]]),Ls=n("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Bs=n("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),Fs=n("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]),Hs=n("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Vs=n("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),$s=n("SquareCode",[["path",{d:"M10 9.5 8 12l2 2.5",key:"3mjy60"}],["path",{d:"m14 9.5 2 2.5-2 2.5",key:"1bir2l"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),Ws=n("SquareDashedBottomCode",[["path",{d:"M10 9.5 8 12l2 2.5",key:"3mjy60"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"m14 9.5 2 2.5-2 2.5",key:"1bir2l"}],["path",{d:"M5 21a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2",key:"as5y1o"}],["path",{d:"M9 21h1",key:"15o7lz"}]]),Us=n("SquareEqual",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M7 14h10",key:"1mhdw3"}]]),Ys=n("SquareM",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 16V8l4 4 4-4v8",key:"141u4e"}]]),Gs=n("SquarePlay",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 8 6 4-6 4Z",key:"f1r3lt"}]]),qs=n("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Ks=n("SquarePower",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 7v5",key:"ma6bk"}],["path",{d:"M8 9a5.14 5.14 0 0 0 4 8 4.95 4.95 0 0 0 4-8",key:"15eubv"}]]),Xs=n("TextCursorInput",[["path",{d:"M5 4h1a3 3 0 0 1 3 3 3 3 0 0 1 3-3h1",key:"18xjzo"}],["path",{d:"M13 20h-1a3 3 0 0 1-3-3 3 3 0 0 1-3 3H5",key:"fj48gi"}],["path",{d:"M5 16H4a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2h1",key:"1n9rhb"}],["path",{d:"M13 8h7a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-7",key:"13ksps"}],["path",{d:"M9 7v10",key:"1vc8ob"}]]),Zs=n("TextSearch",[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M10 12H3",key:"1ulcyk"}],["path",{d:"M10 18H3",key:"13769t"}],["circle",{cx:"17",cy:"15",r:"3",key:"1upz2a"}],["path",{d:"m21 19-1.9-1.9",key:"dwi7p8"}]]),Js=n("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),Qs=n("View",[["path",{d:"M5 12s2.545-5 7-5c4.454 0 7 5 7 5s-2.546 5-7 5c-4.455 0-7-5-7-5z",key:"vptub8"}],["path",{d:"M12 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2z",key:"10lhjs"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2",key:"mrq65r"}],["path",{d:"M21 7V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2",key:"be3xqs"}]]),el=n("WholeWord",[["circle",{cx:"7",cy:"12",r:"3",key:"12clwm"}],["path",{d:"M10 9v6",key:"17i7lo"}],["circle",{cx:"17",cy:"12",r:"3",key:"gl7c2s"}],["path",{d:"M14 7v8",key:"dl84cr"}],["path",{d:"M22 17v1c0 .5-.5 1-1 1H3c-.5 0-1-.5-1-1v-1",key:"lt2kga"}]]),tl=n("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),nl=n("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),rl=n("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);
/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function ol(e,t){return(ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function il(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function al(e,t){return"#comment"!==e.nodeName&&function(e){const t=r(e);if(!(e instanceof t.HTMLElement||e instanceof t.SVGElement))return!1;let{display:n,visibility:o}=e.style,i="none"!==n&&"hidden"!==o&&"collapse"!==o;if(i){const{getComputedStyle:t}=e.ownerDocument.defaultView;let{display:n,visibility:r}=t(e);i="none"!==n&&"hidden"!==r&&"collapse"!==r}return i}(e)&&function(e,t){return!e.hasAttribute("hidden")&&!e.hasAttribute("data-react-aria-prevent-focus")&&("DETAILS"!==e.nodeName||!t||"SUMMARY"===t.nodeName||e.hasAttribute("open"))}(e,t)&&(!e.parentElement||al(e.parentElement,e))}const sl=s.createContext(null);let ll=null;function cl(e){let{children:t,contain:n,restoreFocus:r,autoFocus:l}=e,c=o.useRef(null),d=o.useRef(null),u=o.useRef([]),{parentNode:h}=o.useContext(sl)||{},f=o.useMemo((()=>new El({scopeRef:u})),[u]);i((()=>{let e=h||Cl.root;if(Cl.getTreeNode(e.scopeRef)&&ll&&!yl(ll,e.scopeRef)){let t=Cl.getTreeNode(ll);t&&(e=t)}e.addChild(f),Cl.addNode(f)}),[f,h]),i((()=>{let e=Cl.getTreeNode(u);e&&(e.contain=!!n)}),[n]),i((()=>{var e;let t=null===(e=c.current)||void 0===e?void 0:e.nextSibling,n=[];for(;t&&t!==d.current;)n.push(t),t=t.nextSibling;u.current=n}),[t]),function(e,t,n){i((()=>{if(t||n)return;let r=e.current;const o=a(r?r[0]:void 0);let i=t=>{let n=t.target;ml(n,e.current)?ll=e:gl(n)||(ll=null)};return o.addEventListener("focusin",i,!1),null==r||r.forEach((e=>e.addEventListener("focusin",i,!1))),()=>{o.removeEventListener("focusin",i,!1),null==r||r.forEach((e=>e.removeEventListener("focusin",i,!1)))}}),[e,t,n])}(u,r,n),function(e,t){let n=o.useRef(),r=o.useRef();i((()=>{let o=e.current;if(!t)return void(r.current&&(cancelAnimationFrame(r.current),r.current=void 0));const i=a(o?o[0]:void 0);let s=t=>{if("Tab"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!pl(e)||t.isComposing)return;let n=i.activeElement,r=e.current;if(!r||!ml(n,r))return;let o=wl(fl(r),{tabbable:!0},r);if(!n)return;o.currentNode=n;let a=t.shiftKey?o.previousNode():o.nextNode();a||(o.currentNode=t.shiftKey?r[r.length-1].nextElementSibling:r[0].previousElementSibling,a=t.shiftKey?o.previousNode():o.nextNode()),t.preventDefault(),a&&xl(a,!0)},l=t=>{ll&&!yl(ll,e)||!ml(t.target,e.current)?pl(e)&&!vl(t.target,e)?n.current?n.current.focus():ll&&ll.current&&bl(ll.current):pl(e)&&(n.current=t.target):(ll=e,n.current=t.target)},c=t=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame((()=>{var r;i.activeElement&&pl(e)&&!vl(i.activeElement,e)&&(ll=e,i.body.contains(t.target)?(n.current=t.target,null===(r=n.current)||void 0===r||r.focus()):ll.current&&bl(ll.current))}))};return i.addEventListener("keydown",s,!1),i.addEventListener("focusin",l,!1),null==o||o.forEach((e=>e.addEventListener("focusin",l,!1))),null==o||o.forEach((e=>e.addEventListener("focusout",c,!1))),()=>{i.removeEventListener("keydown",s,!1),i.removeEventListener("focusin",l,!1),null==o||o.forEach((e=>e.removeEventListener("focusin",l,!1))),null==o||o.forEach((e=>e.removeEventListener("focusout",c,!1)))}}),[e,t]),i((()=>()=>{r.current&&cancelAnimationFrame(r.current)}),[r])}(u,n),function(e,t,n){const r=o.useRef("undefined"!=typeof document?a(e.current?e.current[0]:void 0).activeElement:null);i((()=>{let r=e.current;const o=a(r?r[0]:void 0);if(!t||n)return;let i=()=>{ll&&!yl(ll,e)||!ml(o.activeElement,e.current)||(ll=e)};return o.addEventListener("focusin",i,!1),null==r||r.forEach((e=>e.addEventListener("focusin",i,!1))),()=>{o.removeEventListener("focusin",i,!1),null==r||r.forEach((e=>e.removeEventListener("focusin",i,!1)))}}),[e,n]),i((()=>{const r=a(e.current?e.current[0]:void 0);if(!t)return;let o=t=>{if("Tab"!==t.key||t.altKey||t.ctrlKey||t.metaKey||!pl(e)||t.isComposing)return;let n=r.activeElement;if(!ml(n,e.current))return;let o=Cl.getTreeNode(e);if(!o)return;let i=o.nodeToRestore,a=wl(r.body,{tabbable:!0});a.currentNode=n;let s=t.shiftKey?a.previousNode():a.nextNode();if(i&&r.body.contains(i)&&i!==r.body||(i=void 0,o.nodeToRestore=void 0),(!s||!ml(s,e.current))&&i){a.currentNode=i;do{s=t.shiftKey?a.previousNode():a.nextNode()}while(ml(s,e.current));t.preventDefault(),t.stopPropagation(),s?xl(s,!0):gl(i)?xl(i,!0):n.blur()}};return n||r.addEventListener("keydown",o,!0),()=>{n||r.removeEventListener("keydown",o,!0)}}),[e,t,n]),i((()=>{const n=a(e.current?e.current[0]:void 0);if(!t)return;let o=Cl.getTreeNode(e);var i;return o?(o.nodeToRestore=null!==(i=r.current)&&void 0!==i?i:void 0,()=>{let r=Cl.getTreeNode(e);if(!r)return;let o=r.nodeToRestore;if(t&&o&&(ml(n.activeElement,e.current)||n.activeElement===n.body&&function(e){let t=Cl.getTreeNode(ll);for(;t&&t.scopeRef!==e;){if(t.nodeToRestore)return!1;t=t.parent}return(null==t?void 0:t.scopeRef)===e}(e))){let t=Cl.clone();requestAnimationFrame((()=>{if(n.activeElement===n.body){let n=t.getTreeNode(e);for(;n;){if(n.nodeToRestore&&n.nodeToRestore.isConnected)return void xl(n.nodeToRestore);n=n.parent}for(n=t.getTreeNode(e);n;){if(n.scopeRef&&n.scopeRef.current&&Cl.getTreeNode(n.scopeRef))return void bl(n.scopeRef.current,!0);n=n.parent}}}))}}):void 0}),[e,t])}(u,r,n),function(e,t){const n=s.useRef(t);o.useEffect((()=>{if(n.current){ll=e;!ml(a(e.current?e.current[0]:void 0).activeElement,ll.current)&&e.current&&bl(e.current)}n.current=!1}),[e])}(u,l),o.useEffect((()=>{const e=a(u.current?u.current[0]:void 0).activeElement;let t=null;if(ml(e,u.current)){for(let n of Cl.traverse())n.scopeRef&&ml(e,n.scopeRef.current)&&(t=n);t===Cl.getTreeNode(u)&&(ll=t.scopeRef)}}),[u]),i((()=>()=>{var e,t,n;let r=null!==(n=null===(t=Cl.getTreeNode(u))||void 0===t||null===(e=t.parent)||void 0===e?void 0:e.scopeRef)&&void 0!==n?n:null;u!==ll&&!yl(u,ll)||r&&!Cl.getTreeNode(r)||(ll=r),Cl.removeTreeNode(u)}),[u]);let p=o.useMemo((()=>function(e){return{focusNext(t={}){let n=e.current,{from:r,tabbable:o,wrap:i,accept:s}=t,l=r||a(n[0]).activeElement,c=n[0].previousElementSibling,d=wl(fl(n),{tabbable:o,accept:s},n);d.currentNode=ml(l,n)?l:c;let u=d.nextNode();return!u&&i&&(d.currentNode=c,u=d.nextNode()),u&&xl(u,!0),u},focusPrevious(t={}){let n=e.current,{from:r,tabbable:o,wrap:i,accept:s}=t,l=r||a(n[0]).activeElement,c=n[n.length-1].nextElementSibling,d=wl(fl(n),{tabbable:o,accept:s},n);d.currentNode=ml(l,n)?l:c;let u=d.previousNode();return!u&&i&&(d.currentNode=c,u=d.previousNode()),u&&xl(u,!0),u},focusFirst(t={}){let n=e.current,{tabbable:r,accept:o}=t,i=wl(fl(n),{tabbable:r,accept:o},n);i.currentNode=n[0].previousElementSibling;let a=i.nextNode();return a&&xl(a,!0),a},focusLast(t={}){let n=e.current,{tabbable:r,accept:o}=t,i=wl(fl(n),{tabbable:r,accept:o},n);i.currentNode=n[n.length-1].nextElementSibling;let a=i.previousNode();return a&&xl(a,!0),a}}}(u)),[]),g=o.useMemo((()=>({focusManager:p,parentNode:f})),[f,p]);return s.createElement(sl.Provider,{value:g},s.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:c}),t,s.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:d}))}const dl=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],ul=dl.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";dl.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const hl=dl.join(':not([hidden]):not([tabindex="-1"]),');function fl(e){return e[0].parentElement}function pl(e){let t=Cl.getTreeNode(ll);for(;t&&t.scopeRef!==e;){if(t.contain)return!1;t=t.parent}return!0}function gl(e){return vl(e)}function ml(e,t){return!!e&&(!!t&&t.some((t=>t.contains(e))))}function vl(e,t=null){if(e instanceof Element&&e.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of Cl.traverse(Cl.getTreeNode(t)))if(n&&ml(e,n.current))return!0;return!1}function yl(e,t){var n;let r=null===(n=Cl.getTreeNode(t))||void 0===n?void 0:n.parent;for(;r;){if(r.scopeRef===e)return!0;r=r.parent}return!1}function xl(e,t=!1){if(null==e||t){if(null!=e)try{e.focus()}catch(n){}}else try{l(e)}catch(n){}}function bl(e,t=!0){let n=e[0].previousElementSibling,r=fl(e),o=wl(r,{tabbable:t},e);o.currentNode=n;let i=o.nextNode();t&&!i&&(r=fl(e),o=wl(r,{tabbable:!1},e),o.currentNode=n,i=o.nextNode()),xl(i)}function wl(e,t,n){let r=(null==t?void 0:t.tabbable)?hl:ul,o=a(e).createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode(e){var o;return(null==t||null===(o=t.from)||void 0===o?void 0:o.contains(e))?NodeFilter.FILTER_REJECT:!e.matches(r)||!al(e)||n&&!ml(e,n)||(null==t?void 0:t.accept)&&!t.accept(e)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}});return(null==t?void 0:t.from)&&(o.currentNode=t.from),o}class kl{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,t,n){let r=this.fastMap.get(null!=t?t:null);if(!r)return;let o=new El({scopeRef:e});r.addChild(o),o.parent=r,this.fastMap.set(e,o),n&&(o.nodeToRestore=n)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(null===e)return;let t=this.fastMap.get(e);if(!t)return;let n=t.parent;for(let o of this.traverse())o!==t&&t.nodeToRestore&&o.nodeToRestore&&t.scopeRef&&t.scopeRef.current&&ml(o.nodeToRestore,t.scopeRef.current)&&(o.nodeToRestore=t.nodeToRestore);let r=t.children;n&&(n.removeChild(t),r.size>0&&r.forEach((e=>n&&n.addChild(e)))),this.fastMap.delete(t.scopeRef)}*traverse(e=this.root){if(null!=e.scopeRef&&(yield e),e.children.size>0)for(let t of e.children)yield*this.traverse(t)}clone(){var e;let t=new kl;var n;for(let r of this.traverse())t.addTreeNode(r.scopeRef,null!==(n=null===(e=r.parent)||void 0===e?void 0:e.scopeRef)&&void 0!==n?n:null,r.nodeToRestore);return t}constructor(){this.fastMap=new Map,this.root=new El({scopeRef:null}),this.fastMap.set(null,this.root)}}class El{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}let Cl=new kl;const Sl=c({});function Nl(e,t){const{registerAction:n,unregisterAction:r}=function(){const e=u(Sl);return{registerAction:(t,n)=>{e((e=>({...e,[t]:n})))},unregisterAction:t=>{e((e=>{const{[t]:n,...r}=e;return r}))}}}(),i=t===m.NOOP,a=h((()=>t())),s=h((n=>{const r=f.getHotkey(e).key;if(p(r)(n)){!1!==t()&&(n.preventDefault(),n.stopPropagation())}}));g(document,"keydown",s),o.useEffect((()=>{if(!i)return n(e,a),()=>r(e)}),[a,e,i])}function jl(e){const t=f.getHotkey(e);return x.jsxs("span",{className:"flex",children:[x.jsx("span",{className:"mr-2",children:t.name}),x.jsx(Il,{shortcut:t.key})]})}const Il=({shortcut:e})=>{const t=e.split("-");return x.jsx("div",{className:"flex gap-1",children:t.map(Ml).map((([e,t])=>t?x.jsx(b,{asChild:!1,tabIndex:-1,content:e,delayDuration:300,children:x.jsx(Yi,{children:t},e)},e):x.jsx(Yi,{children:Tl(e)},e)))})};function Ol(e){const t=f.getHotkey(e).key.split("-");return x.jsx(k,{className:"flex gap-1 items-center",children:t.map(Ml).map((([e,t])=>t?x.jsx(b,{content:e,delayDuration:300,tabIndex:-1,children:x.jsx("span",{children:t},e)},e):x.jsx("span",{children:Tl(e)},e)))})}function Ml(e){const t=w()?"mac":"default",n=e.toLowerCase(),r=Dl[e.toLowerCase()];if(r){const e=r.symbols[t]||r.symbols.default;return[r.label,e]}return[n]}const Dl={ctrl:{symbols:{mac:"⌃",default:"Ctrl"},label:"Control"},control:{symbols:{mac:"⌃",default:"Ctrl"},label:"Control"},shift:{symbols:{mac:"⇧",default:"Shift"},label:"Shift"},alt:{symbols:{mac:"⌥",default:"Alt"},label:"Alt/Option"},escape:{symbols:{mac:"⎋",default:"Esc"},label:"Escape"},arrowup:{symbols:{default:"↑"},label:"Arrow Up"},arrowdown:{symbols:{default:"↓"},label:"Arrow Down"},arrowleft:{symbols:{default:"←"},label:"Arrow Left"},arrowright:{symbols:{default:"→"},label:"Arrow Right"},backspace:{symbols:{mac:"⌫",default:"⟵"},label:"Backspace"},tab:{symbols:{mac:"⇥",default:"⭾"},label:"Tab"},capslock:{symbols:{default:"⇪"},label:"Caps Lock"},fn:{symbols:{default:"Fn"},label:"Fn"},cmd:{symbols:{mac:"⌘",windows:"⊞ Win",default:"Command"},label:"Command"},insert:{symbols:{default:"Ins"},label:"Insert"},delete:{symbols:{mac:"⌦",default:"Del"},label:"Delete"},home:{symbols:{mac:"↖",default:"Home"},label:"Home"},end:{symbols:{mac:"↘",default:"End"},label:"End"}};function Tl(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Pl=c(!1),Al=()=>{const[e,t]=E(Pl);if(Nl("global.showHelp",(()=>t((e=>!e)))),!e)return null;const n=f.getHotkeyGroups(),r=e=>{const t=n[e];return x.jsxs("div",{className:"keyboard-shortcut-group gap-2 flex flex-col",children:[x.jsx("h3",{className:"text-lg font-medium",children:e}),t.map((e=>(e=>{const t=f.getHotkey(e);return x.jsxs("div",{className:"keyboard-shortcut flex flex-col",children:[x.jsx(Il,{shortcut:t.key}),x.jsx("span",{children:t.name.toLowerCase()})]},e)})(e)))]})};return x.jsx(C,{open:e,onOpenChange:e=>t(e),children:x.jsxs(S,{className:"sm:items-center sm:top-0",children:[x.jsx(N,{}),x.jsxs(j,{usePortal:!1,className:"max-h-screen sm:max-h-[90vh] overflow-y-auto sm:max-w-[850px]",children:[x.jsx(I,{children:x.jsx(O,{children:"Shortcuts"})}),x.jsxs("div",{className:"flex flex-row gap-3",children:[x.jsxs("div",{className:"w-1/2",children:[r("Editing"),r("Markdown")]}),x.jsxs("div",{className:"w-1/2",children:[r("Navigation"),r("Running Cells"),r("Creation and Ordering"),r("Other")]})]})]})]})})},_l=e=>x.jsx(j,{className:"w-fit",children:x.jsxs("form",{onSubmit:t=>{t.preventDefault(),A(new Blob([e.getCellsAsJSON()],{type:"text/plain"}),`${e.proposedName}.json`),e.closeModal()},onKeyDown:t=>{"Escape"===t.key&&e.closeModal()},children:[x.jsx(O,{className:"text-accent mb-6",children:"Download unsaved changes?"}),x.jsxs(D,{className:"markdown",children:[x.jsx("p",{children:"This app has unsaved changes. To recover:"}),x.jsxs("ol",{children:[x.jsxs("li",{style:{paddingBottom:"10px"},children:['Click the "Download" button. This will download a file called ',x.jsxs("code",{children:[e.proposedName,".json"]}),". This file contains your code."]}),x.jsxs("li",{style:{paddingBottom:"10px"},children:["In your terminal, type",x.jsxs("code",{style:{display:"block",padding:"10px"},children:["marimo recover ",e.proposedName,".json ",">"," ",e.proposedName,".py"]}),"to overwrite ",x.jsxs("code",{children:[e.proposedName,".py"]})," with the recovered changes."]})]})]}),x.jsxs(T,{children:[x.jsx(P,{"aria-label":"Cancel",variant:"secondary","data-testid":"cancel-recovery-button",onClick:e.closeModal,children:"Cancel"}),x.jsx(P,{"data-testid":"download-recovery-button","aria-label":"Download",variant:"default",type:"submit",children:"Download"})]})]})}),Rl=e=>{const{filename:t,needsSave:n,getCellsAsJSON:r}=e,{openModal:o,closeModal:i}=M(),a=null===t?"app":t.slice(0,-3),s=()=>{n&&o(x.jsx(_l,{getCellsAsJSON:r,proposedName:a,closeModal:i}))};return Nl("global.save",s),x.jsx(b,{content:jl("global.save"),children:x.jsx(Gi,{onClick:s,id:"save-button","aria-label":"Save",className:"rectangle",color:n?"yellow":"gray",children:x.jsx(Ls,{strokeWidth:1.5,size:18})})})},zl=()=>{const{selectedLayout:e}=ua(),{setLayoutView:t}=ha();return _()?null:x.jsxs(R,{"data-testid":"layout-select",value:e,onValueChange:e=>t(e),children:[x.jsx(z,{className:"min-w-[110px] border-border bg-background","data-testid":"layout-select",children:x.jsx(L,{placeholder:"Select a view"})}),x.jsx(B,{children:x.jsxs(F,{children:[x.jsx(H,{children:"View as"}),["vertical","grid"].map((e=>x.jsx(V,{value:e,children:x.jsxs("div",{className:"flex items-center gap-1.5 leading-5",children:[Ll(e),x.jsx("span",{children:Bl(e)})]})},e)))]})})]})};function Ll(e){switch(e){case"vertical":return x.jsx(Ns,{className:"h-4 w-4"});case"grid":return x.jsx(bs,{className:"h-4 w-4"});default:return x.jsx($,{className:"h-4 w-4"})}}function Bl(e){switch(e){case"vertical":return"Vertical";case"grid":return"Grid";default:return"Unknown"}}function Fl(){const[e,t]=function(e,t){const n=new W(e,t),[r,i]=o.useState((()=>n.get()));return[r,e=>{i(e),n.set(e)}]}("marimo:commands",[]);return{recentCommands:e,addRecentCommand:n=>{const r=(o=[n,...e],[...new Set(o)]);var o;t(r.slice(0,3))}}}function Hl(e){return void 0!==e.dropdown}function Vl(e,t=""){return e.flatMap((e=>Hl(e)?Vl(e.dropdown,`${t+e.label} > `):{...e,label:t+e.label}))}const $l=({children:e,layerTop:t=!1})=>{const[n,r]=s.Children.toArray(e),o=t?"top-[-1px] left-[-1px]":"bottom-[-1px] right-[-1px]";return x.jsxs("div",{className:"multi-icon relative w-fit",children:[n,x.jsx("div",{className:`second-icon absolute ${o} rounded-full`,children:r})]})};function Wl(e){const t=e.current;if(null===t)throw new ReferenceError("Attempting to dereference null object.");return t}function Ul(){const e=Y();return h((async t=>{if(0===t.length)return;const{cellHandles:n}=e,r=[];for(const e of t){const t=Wl(n[e]);r.push(q(t.editorView)),t.registerRun()}await K(t,r).catch((e=>{y.error(e)}))}))}const Yl=c(null),Gl=c(!1);function ql(){const{deleteCell:e,undoDeleteCell:t}=X();return h((n=>{if(1===Z().length)return;const{cellId:r}=n;e({cellId:r}),J(r).catch((()=>{t()}));const{dismiss:o}=Q({title:"Cell deleted",description:"You can bring it back by clicking undo or through the command palette.",action:x.jsx(P,{"data-testid":"undo-delete-button",size:"sm",variant:"outline",onClick:()=>{t(),o()},children:"Undo"})})}))}function Kl(e,t,n,r=te){if(t in r.get(fa))return!1;const{cellData:o,cellIds:i}=r.get(ee),a=new RegExp(`import[ \t]+${e}[ \t]+as[ \t]+${t}`,"g");for(const s of i)if(a.test(o[s].code))return!1;return n(`import ${e} as ${t}`),!0}function Xl(e,t,n){return Kl("marimo","mo",(r=>{const o=ne.create();t({cellId:n??"__end__",before:!1,code:r,lastCodeRun:e?r:void 0,newCellId:o,autoFocus:!1}),e&&K([o],[r])}))}function Zl({cell:e}){const{createNewCell:t,updateCellConfig:n,updateCellCode:r,updateCellName:o,moveCell:i,sendToTop:a,sendToBottom:s}=X(),l=function(e){const t=Ul();return h((()=>{void 0!==e&&t([e])}))}(null==e?void 0:e.cellId),c=!d(re),f=ql(),{openModal:p}=M(),g=u(Yl),m=d(oe),v=d(ie);if(!e)return[];const{cellId:y,config:b,getEditorView:w,name:k,hasOutput:E,status:C}=e,S=w(),N=async()=>{const e={disabled:!b.disabled};await xe({configs:{[y]:e}}),n({cellId:y,config:e})};return[[{icon:x.jsx(Xs,{size:13,strokeWidth:1.5}),label:"Name",disableClick:!0,handle:e=>{null==e||e.stopPropagation(),null==e||e.preventDefault()},handleHeadless:()=>{p(x.jsxs(j,{children:[x.jsx(I,{children:x.jsx(O,{children:"Rename cell"})}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx(ae,{htmlFor:"cell-name",children:"Cell name"}),x.jsx(pa,{placeholder:`cell_${y}`,value:k,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),p(null))},onChange:e=>o({cellId:y,name:e})})]})]}))},rightElement:x.jsx(pa,{placeholder:`cell_${y}`,value:k,onChange:e=>o({cellId:y,name:e})})},{icon:x.jsx(se,{size:13,strokeWidth:1.5}),label:"Run cell",hotkey:"cell.run",hidden:"running"===C||"queued"===C||"disabled-transitively"===C||!0===b.disabled,handle:()=>l()},{icon:x.jsx(Vs,{size:13,strokeWidth:1.5}),label:"AI completion",hidden:!m,handle:()=>{g((e=>e===y?null:y))},hotkey:"cell.aiCompletion"},{icon:x.jsx(le,{size:13,strokeWidth:1.5}),label:"Export output as PNG",hidden:!E,handle:()=>function(e){const t=document.getElementById(`output-${e}`);t&&(t.classList.add("printing-output"),U(t,"result.png").finally((()=>{t.classList.remove("printing-output")})))}(y)},{icon:x.jsx(ce,{size:13,strokeWidth:1.5}),label:"Format cell",hotkey:"cell.format",handle:()=>{S&&de({[y]:S},r)}},{icon:"python"===ue(S)?x.jsx(qi,{}):x.jsx(Ki,{}),label:"python"===ue(S)?"View as Markdown":"View as Python",hotkey:"cell.viewAsMarkdown",hidden:!he(S)&&"markdown"!==ue(S),handle:()=>{S&&(Xl(v,t),fe(y,S,r))}},{icon:b.hide_code?x.jsx(pe,{size:13,strokeWidth:1.5}):x.jsx(vs,{size:13,strokeWidth:1.5}),label:!0===b.hide_code?"Show code":"Hide code",handle:async()=>{const e={hide_code:!b.hide_code};await xe({configs:{[y]:e}}),n({cellId:y,config:e}),S&&(e.hide_code?S.contentDOM.blur():S.focus())},hotkey:"cell.hideCode"},{icon:b.disabled?x.jsx(rl,{size:13,strokeWidth:1.5}):x.jsx(nl,{size:13,strokeWidth:1.5}),label:!0===b.disabled?"Enable cell":"Disable cell",rightElement:x.jsx(ge,{"data-testid":"cell-disable-switch",checked:!b.disabled,size:"sm",onCheckedChange:N}),handle:N}],[{icon:x.jsxs($l,{children:[x.jsx(ls,{size:13,strokeWidth:1.5}),x.jsx(me,{size:8,strokeWidth:2})]}),label:"Create cell above",hotkey:"cell.createAbove",handle:()=>t({cellId:y,before:!0})},{icon:x.jsxs($l,{children:[x.jsx(ls,{size:13,strokeWidth:1.5}),x.jsx(ve,{size:8,strokeWidth:2})]}),label:"Create cell below",hotkey:"cell.createBelow",handle:()=>t({cellId:y,before:!1})},{icon:x.jsx(me,{size:13,strokeWidth:1.5}),label:"Move cell up",hotkey:"cell.moveUp",handle:()=>i({cellId:y,before:!0})},{icon:x.jsx(ve,{size:13,strokeWidth:1.5}),label:"Move cell down",hotkey:"cell.moveDown",handle:()=>i({cellId:y,before:!1})},{icon:x.jsx(as,{size:13,strokeWidth:1.5}),label:"Send to top",hotkey:"cell.sendToTop",handle:()=>a({cellId:y})},{icon:x.jsx(is,{size:13,strokeWidth:1.5}),label:"Send to bottom",hotkey:"cell.sendToBottom",handle:()=>s({cellId:y})}],[{label:"Delete",hidden:!c,variant:"danger",icon:x.jsx(ye,{size:13,strokeWidth:1.5}),handle:()=>{f({cellId:y})}}]].map((e=>e.filter((e=>!e.hidden)))).filter((e=>e.length>0))}const Jl=c(null),Ql=c((e=>{const t=e(Jl);return t?ec(t,e(ee)):null}));function ec(e,t){const{cellData:n,cellHandles:r,cellRuntime:o}=t,i=n[e],a=o[e],s=r[e].current;if(!i||!s)return null;return{cellId:e,name:i.name,config:i.config,status:a?a.status:"idle",getEditorView:()=>s.editorView,hasOutput:null!=(null==a?void 0:a.output)}}function tc(){const{theme:e}=be(),[t,n]=we(),[r,o]=ke(),i=async e=>{await Ce({config:e}).then((()=>{n(e)}))};return[...Ee.filter((e=>e!==r.width)).map((e=>({label:`App config > Set width=${e}`,handle:()=>{(async e=>{await Se({config:e}).then((()=>{o(e)}))})({...r,width:e})}}))),{label:"Config > Toggle dark mode",handle:()=>{i({...t,display:{...t.display,theme:"dark"===e?"light":"dark"}})}},{label:"Config > Switch keymap to  VIM",hidden:"vim"===t.keymap.preset,handle:()=>{i({...t,keymap:{...t.keymap,preset:"vim"}})}},{label:"Config > Switch keymap to default (current: VIM)",hidden:"default"===t.keymap.preset,handle:()=>{i({...t,keymap:{...t.keymap,preset:"default"}})}},{label:t.completion.copilot?"Config > Disable GitHub Copilot":"Config > Enable GitHub Copilot",handle:()=>{i({...t,completion:{...t.completion,copilot:!t.completion.copilot}})}}].filter((e=>!e.hidden))}const nc=c(!1),rc=()=>{const[e,t]=E(nc),n=d(Sl);let r=Zl({cell:d(Ql)}).flat();r=Vl(r);const o=tc();let i=xc();i=[...Vl(i),...Vl(o)];const a=i.filter((e=>!e.hotkey)),l=v.keyBy(a,(e=>e.label)),{recentCommands:c,addRecentCommand:u}=Fl(),h=new Set(c);s.useEffect((()=>{const e=e=>{p(f.getHotkey("global.commandPalette").key)(e)&&(e.preventDefault(),t((e=>!e)))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[t]);const g=e=>{const r=n[e];if(!r)return null;const o=f.getHotkey(e);return x.jsxs(Pe,{onSelect:()=>{u(e),t(!1),requestAnimationFrame((()=>{r()}))},value:o.name,children:[x.jsx("span",{children:o.name}),x.jsx(Ae,{children:x.jsx(Il,{shortcut:o.key})})]},e)},m=(e,n,r)=>x.jsxs(Pe,{onSelect:()=>{u(e),t(!1),requestAnimationFrame((()=>{n()}))},value:e,children:[x.jsx("span",{children:e}),r&&x.jsx(Ae,{children:x.jsx(Il,{shortcut:f.getHotkey(r).key})})]},e);return x.jsxs(Ne,{open:e,onOpenChange:t,children:[x.jsx(je,{placeholder:"Type to search..."}),x.jsxs(Ie,{children:[x.jsx(Oe,{children:"No results found."}),c.length>0&&x.jsxs(x.Fragment,{children:[x.jsx(Me,{heading:"Recently Used",children:c.map((e=>{if(De(e))return g(e);const t=l[e];return t&&!Hl(t)?m(t.label,t.handleHeadless||t.handle):null}))}),x.jsx(Te,{})]}),x.jsxs(Me,{heading:"Commands",children:[f.iterate().map((e=>h.has(e)?null:g(e))),a.map((e=>h.has(e.label)?null:m(e.label,e.handleHeadless||e.handle))),r.map((e=>h.has(e.label)?null:m(`Cell > ${e.label}`,e.handleHeadless||e.handle)))]})]})]})},oc=c(_e());function ic(){return E(oc)}const ac="https://static.marimo.app",sc=({onClose:e})=>{const[t,n]=o.useState(""),r=`${t}-${o.useRef(Math.random().toString(36).slice(2,6)).current}`,i=`${ac}/static/${r}`;return x.jsx(j,{className:"w-fit",children:x.jsxs("form",{onSubmit:async t=>{t.preventDefault(),e();const n=await Re({download:!1,includeCode:!0,files:ga.INSTANCE.filenames()}),o=Q({title:"Uploading static notebook...",description:"Please wait."});await fetch(`${ac}/api/static`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:n,path:r})}).catch((()=>{o.dismiss(),Q({title:"Error uploading static page",description:x.jsxs("div",{children:["Please try again later. If the problem persists, please file a bug report on"," ",x.jsx("a",{href:ze.issuesPage,target:"_blank",rel:"noreferrer",className:"underline",children:"GitHub"}),"."]})})})),o.dismiss(),Q({title:"Static page uploaded!",description:x.jsxs("div",{children:["The URL has been copied to your clipboard.",x.jsx("br",{}),"You can share it with anyone."]})})},children:[x.jsxs(I,{children:[x.jsx(O,{children:"Share static notebook"}),x.jsxs(D,{children:["You can publish a static, non-interactive version of this notebook to the public web. We will create a link for you that lives on"," ",x.jsx("a",{href:ac,target:"_blank",rel:"noreferrer",children:ac}),"."]})]}),x.jsxs("div",{className:"flex flex-col gap-6 py-4",children:[x.jsx(Le,{"data-testid":"slug-input",id:"slug",autoFocus:!0,value:t,placeholder:"Notebook slug",onChange:e=>{const t=e.target.value.toLowerCase().replaceAll(/\s/g,"-").replaceAll(/[^\da-z-]/g,"");n(t)},required:!0,autoComplete:"off"}),x.jsxs("div",{className:"font-semibold text-sm text-muted-foreground gap-2 flex flex-col",children:["Anyone will be able to access your notebook at this URL:",x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(lc,{text:i}),x.jsx("span",{className:"text-primary",children:i})]})]})]}),x.jsxs(T,{children:[x.jsx(P,{"data-testid":"cancel-share-static-notebook-button",variant:"secondary",onClick:e,children:"Cancel"}),x.jsx(P,{"data-testid":"share-static-notebook-button","aria-label":"Save",variant:"default",type:"submit",onClick:()=>{navigator.clipboard.writeText(i)},children:"Create"})]})]})})},lc=e=>{const[t,n]=s.useState(!1),r=Fe.stopPropagation((t=>{t.preventDefault(),navigator.clipboard.writeText(e.text),n(!0),setTimeout((()=>n(!1)),2e3)}));return x.jsx(b,{content:"Copied!",open:t,children:x.jsx(P,{"data-testid":"copy-static-notebook-url-button",onClick:r,size:"xs",variant:"secondary",children:x.jsx(Be,{size:14,strokeWidth:1.5})})})};function cc(){const{openConfirm:e}=M(),t=u(ma);return()=>{e({title:"Restart Kernel",description:"This will restart the Python kernel. You'll lose all data that's in memory. You will also lose any unsaved changes, so make sure to save your work before restarting.",variant:"destructive",confirmAction:x.jsx(He,{onClick:async()=>{t({state:va.CLOSING}),await Ve(),window.location.reload()},"aria-label":"Confirm Restart",children:"Restart"})})}}const{reducer:dc,createActions:uc,valueAtom:hc,useActions:fc}=$e((function(){return{selectedPanel:"variables",isOpen:!1,panelLocation:"left"}}),{openApplication:(e,t)=>({...e,selectedPanel:t,isOpen:!e.isOpen||e.selectedPanel!==t}),openPanel:e=>({...e,isOpen:!0}),closePanel:e=>({...e,isOpen:!1}),togglePanel:e=>({...e,isOpen:!e.isOpen}),setIsOpen:(e,t)=>({...e,isOpen:t}),changePanelLocation:(e,t)=>({...e,panelLocation:t})}),pc=()=>{const e=d(hc);return e.isOpen?e:{...e,selectedPanel:void 0}};function gc(){return fc()}const mc={errors:We,files:xs,variables:Ue,datasources:Ye,dependencies:Os,outline:Fs,documentation:Zs,logs:Ge,snippets:Ws},vc=v.keys(mc),yc=e=>{null==e||e.preventDefault(),null==e||e.stopPropagation()};function xc(){const[e]=ic(),{openModal:t,closeModal:n}=M(),{openApplication:r}=gc(),{selectedPanel:o}=pc(),i=Y(),{updateCellConfig:a,undoDeleteCell:s}=X(),l=cc(),c=u(nc),d=u(Pl),h=qe(i),f=Ke(i);return[{icon:x.jsx(Hs,{size:14,strokeWidth:1.5}),label:"Share",handle:yc,dropdown:[{icon:x.jsx(Xe,{size:14,strokeWidth:1.5}),label:"Publish HTML to web",handle:async()=>{t(x.jsx(sc,{onClose:n}))}},{icon:x.jsx(Ss,{size:14,strokeWidth:1.5}),label:"Create WebAssembly link",handle:async()=>{const e=await Ze(),t=Je({code:e.contents});window.navigator.clipboard.writeText(t),Q({title:"Copied",description:"Link copied to clipboard."})}}]},{icon:x.jsx(Qe,{size:14,strokeWidth:1.5}),label:"Download",handle:yc,dropdown:[{icon:x.jsx(ya,{size:14,strokeWidth:1.5}),label:"Download as HTML",handle:async()=>{e?await xa({filename:e}):Q({variant:"danger",title:"Error",description:"Notebooks must be named to be exported."})}},{icon:x.jsx(le,{size:14,strokeWidth:1.5}),label:"Download as PNG",handle:async()=>{const e=Q({title:"Starting download",description:"Downloading as PNG..."});await et((async()=>{const e=document.getElementById("App");e&&(await new Promise((e=>setTimeout(e,2e3))),await U(e,document.title))})),e.dismiss()}},{icon:x.jsx(qi,{strokeWidth:1.5,style:{width:14,height:14}}),label:"Download as Markdown",handle:async()=>{const e=await tt({download:!1});A(new Blob([e],{type:"text/plain"}),nt.toMarkdown(document.title))}},{icon:x.jsx(hs,{size:14,strokeWidth:1.5}),label:"Download Python code",handle:async()=>{const e=await Ze();A(new Blob([e.contents],{type:"text/plain"}),nt.toPY(document.title))}}]},{divider:!0,icon:x.jsx(Ts,{size:14,strokeWidth:1.5}),label:"Helper panel",handle:yc,dropdown:vc.map((e=>{const t=mc[e];return{label:rt(e),rightElement:x.jsx("div",{className:"w-8 flex justify-end",children:o===e&&x.jsx(ot,{size:14})}),icon:x.jsx(t,{size:14,strokeWidth:1.5}),handle:()=>r(e)}}))},{icon:x.jsx(cs,{size:14,strokeWidth:1.5}),label:"Copy code to clipboard",hidden:!e,handle:async()=>{const e=await Ze();navigator.clipboard.writeText(e.contents),Q({title:"Copied",description:"Code copied to clipboard."})}},{icon:x.jsx(rl,{size:14,strokeWidth:1.5}),label:"Enable all cells",hidden:0===h.length,handle:async()=>{const e=h.map((e=>e.id)),t=v.fromEntries(e.map((e=>[e,{disabled:!1}])));await xe({configs:t}),e.forEach((e=>a({cellId:e,config:{disabled:!1}})))}},{icon:x.jsx(nl,{size:14,strokeWidth:1.5}),label:"Disable all cells",hidden:0===f.length,handle:async()=>{const e=f.map((e=>e.id)),t=v.fromEntries(e.map((e=>[e,{disabled:!0}])));await xe({configs:t}),e.forEach((e=>a({cellId:e,config:{disabled:!0}})))}},{icon:x.jsx(Js,{size:14,strokeWidth:1.5}),label:"Undo cell deletion",hidden:!it(i),handle:()=>{s()}},{divider:!0,icon:x.jsx(fs,{size:14,strokeWidth:1.5}),label:"Command palette",hotkey:"global.commandPalette",handle:()=>c((e=>!e))},{icon:x.jsx(Es,{size:14,strokeWidth:1.5}),label:"Keyboard shortcuts",hotkey:"global.showHelp",handle:()=>d((e=>!e))},{icon:x.jsx(rs,{size:14,strokeWidth:1.5}),label:"Open documentation",handle:()=>{window.open("https://docs.marimo.io","_blank")}},{divider:!0,icon:x.jsx(Ks,{size:14,strokeWidth:1.5}),label:"Restart kernel",variant:"danger",handle:l}].filter((e=>!e.hidden))}const bc=()=>{const e=xc(),t=x.jsx(Gi,{"aria-label":"Config",shape:"circle",size:"small",className:"h-[27px] w-[27px]","data-testid":"notebook-menu-dropdown",color:"hint-green",children:x.jsx(ba,{strokeWidth:1.8})}),n=e=>x.jsxs(x.Fragment,{children:[e.icon&&x.jsx("span",{className:"flex-0 mr-2",children:e.icon}),x.jsx("span",{className:"flex-1",children:e.label}),e.hotkey&&Ol(e.hotkey),e.rightElement]}),r=e=>x.jsx(gt,{variant:e.variant,onSelect:t=>e.handle(t),"data-testid":`notebook-menu-dropdown-${e.label}`,children:n(e)},e.label);return x.jsxs(at,{modal:!1,children:[x.jsx(st,{asChild:!0,children:t}),x.jsxs(lt,{align:"end",className:"no-print w-[220px]",children:[e.map((e=>e.hidden?null:e.dropdown?x.jsxs(ct,{children:[x.jsx(dt,{"data-testid":`notebook-menu-dropdown-${e.label}`,children:n(e)}),x.jsx(ut,{children:x.jsx(ht,{children:e.dropdown.map(r)})})]},e.label):x.jsxs(s.Fragment,{children:[e.divider&&x.jsx(ft,{}),r(e)]},e.label))),x.jsx(ft,{}),x.jsx("div",{className:"flex-1 px-2 text-xs text-muted-foreground",children:x.jsxs("span",{children:["Version: ",pt()]})})]})]})},wc=mt({findText:"",replaceText:"",caseSensitive:!1,wholeWord:!1,regexp:!1,isOpen:!1,currentView:void 0},((e,t)=>{if(void 0===t)return e;switch(t.type){case"setFind":return{...e,findText:t.find};case"setReplace":return{...e,replaceText:t.replace};case"setCaseSensitive":return{...e,caseSensitive:t.caseSensitive};case"setWholeWord":return{...e,wholeWord:t.wholeWord};case"setRegex":return{...e,regexp:t.regexp};case"setIsOpen":return{...e,isOpen:t.isOpen};case"setCurrentView":return{...e,currentView:{view:t.view,range:t.range}};case"clearCurrentView":return{...e,currentView:void 0}}}));function kc(e){if([...document.querySelectorAll('[role="dialog"][data-state="open"]')].some((e=>e instanceof HTMLElement&&e.childNodes.length>0)))return!1;if(e){const t=e.state.selection.main,n=e.state.sliceDoc(t.from,t.to);n?(te.set(wc,{type:"setFind",find:n}),te.set(wc,{type:"setCurrentView",view:e,range:{from:t.from,to:t.to}})):te.set(wc,{type:"setCurrentView",view:e,range:{from:0,to:0}})}return te.get(wc).isOpen?(te.set(wc,{type:"setIsOpen",isOpen:!1}),requestAnimationFrame((()=>{te.set(wc,{type:"setIsOpen",isOpen:!0})})),!0):(te.set(wc,{type:"setIsOpen",isOpen:!0}),!0)}function Ec(){return!!te.get(wc).isOpen&&(te.set(wc,{type:"setIsOpen",isOpen:!1}),!0)}function Cc(e){return vt("create"in e,'Expected query to have a "create" method'),e}function Sc(e){return()=>{const t=te.get(wc),n=new yt({search:t.findText,caseSensitive:t.caseSensitive,regexp:t.regexp,replace:t.replaceText,wholeWord:t.wholeWord});return!!n.valid&&e({query:Cc(n).create(),search:n})}}const Nc=e=>Sc((({query:t})=>{const n=xt(),r=te.get(wc).currentView||{view:n[0],range:{from:0,to:0}};let o=r.range.to;"prev"===e&&(n.reverse(),o=r.range.from);let i=n.indexOf(r.view);i<0&&(i=0);const a=[...n,...n].slice(i);for(const s of a){const n="next"===e?t.nextMatch(s.state,0,o??0):t.prevMatch(s.state,o??s.state.doc.length,s.state.doc.length);if(!n){o=null,s.dispatch({selection:bt.single(0)});continue}const r=bt.single(n.from,n.to);return s.dispatch({selection:r,effects:[wt.scrollIntoView(r.main,{y:"center"})],userEvent:"select.search"}),te.set(wc,{type:"setCurrentView",view:s,range:{from:n.from,to:n.to}}),n}return!1})),jc=Nc("next"),Ic=Nc("prev"),Oc=Sc((({query:e})=>{var t;const n=xt(),r=[];for(const o of n){if(o.state.readOnly)continue;const n=null==(t=e.matchAll(o.state,1e9))?void 0:t.map((t=>{const{from:n,to:r}=t;return{from:n,to:r,insert:e.getReplacement(t)}}));if(!n||0===n.length)continue;const i=o.state.doc.toString();r.push((()=>{o.dispatch({changes:[{from:0,to:o.state.doc.length,insert:i}],userEvent:"input.replace.all"})})),o.dispatch({changes:n,userEvent:"input.replace.all"})}return()=>{for(const e of r)e()}})),Mc=Sc((({query:e})=>{const t=xt(),n=te.get(wc).currentView||{view:t[0],range:{from:0,to:0}};let r=n.range.from,o=t.indexOf(n.view);o<0&&(o=0);const i=[...t,...t].slice(o);for(const a of i){const t=e.nextMatch(a.state,0,r??0);if(!t){r=null,a.dispatch({selection:bt.single(0)});continue}const n=a.state.toText(e.getReplacement(t));return a.dispatch({changes:[{from:t.from,to:t.to,insert:n}],userEvent:"input.replace"}),jc()}return!1})),Dc=Sc((({query:e})=>{const t=xt();let n=0;const r=new Map;for(const o of t){const t=e.matchAll(o.state,1e9)||[];for(const e of t){const{from:t,to:i}=e,a=r.get(o)||new Map;a.set(`${t}:${i}`,n++),r.set(o,a)}}return{count:n,position:r}})),Tc=kt.define();function Pc(){const e=xt();for(const t of e)t.state.readOnly||t.dispatch({effects:Tc.of(new yt({search:""}))})}const Ac=Et.define({create(){const e=te.get(wc);return Cc(new yt({search:e.findText,caseSensitive:e.caseSensitive,regexp:e.regexp,replace:e.replaceText,wholeWord:e.wholeWord})).create()},update(e,t){for(const n of t.effects)n.is(Tc)&&(e=Cc(n.value).create());return e}}),_c=Ct.mark({class:"cm-searchMatch"}),Rc=Ct.mark({class:"cm-searchMatch cm-searchMatch-selected"}),zc=St.fromClass(class{constructor(e){t(this,"decorations"),this.view=e,this.decorations=this.highlight(e.state.field(Ac))}update(e){const t=e.state.field(Ac);(t!=e.startState.field(Ac)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight(e){if(!e.spec.valid)return Ct.none;const{view:t}=this,n=new Nt,r=t.visibleRanges,o=r.length;for(let i=0;i<o;i++){let{to:a}=r[i];const{from:s}=r[i];for(;i<o-1&&a>r[i+1].from-500;)a=r[++i].to;e.highlight(t.state,s,a,((e,r)=>{const o=t.state.selection.ranges.some((t=>t.from==e&&t.to==r));n.add(e,r,o?Rc:_c)}))}return n.finish()}},{decorations:e=>e.decorations}),Lc=wt.baseTheme({"&light .cm-searchMatch":{backgroundColor:"#99ff7780"},"&dark .cm-searchMatch":{backgroundColor:"#22bb0070"},"&light .cm-searchMatch-selected":{backgroundColor:"transparent"},"&dark .cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff88 !important"}}),Bc=()=>{var e;const[t,n]=o.useState(!1),[r,i]=E(wc),[a,s]=o.useState();if(Nl("cell.findAndReplace",(()=>(!t||!r.isOpen)&&kc())),o.useEffect((()=>{if(!r.isOpen)return void Pc();if(""===r.findText)return s(void 0),void Pc();const e=Dc();s(!1===e?void 0:e),function(){const e=te.get(wc),t=xt();for(const n of t)n.state.readOnly||n.dispatch({effects:Tc.of(new yt({search:e.findText,caseSensitive:e.caseSensitive,regexp:e.regexp,replace:e.replaceText,wholeWord:e.wholeWord}))})}()}),[r.findText,r.isOpen,r.caseSensitive,r.regexp,r.wholeWord]),!r.isOpen)return null;const l=r.currentView,c=l&&a?null==(e=a.position.get(l.view))?void 0:e.get(`${l.range.from}:${l.range.to}`):void 0;return x.jsx(cl,{restoreFocus:!0,autoFocus:!0,children:x.jsxs("div",{onFocus:()=>n(!0),onClick:e=>{e.stopPropagation(),e.preventDefault()},onBlur:()=>n(!1),className:"fixed top-0 right-0 w-[500px] flex flex-col bg-[var(--sage-1)] p-4 z-50 mt-2 mr-3 rounded-md shadow-lg border gap-2",onKeyDown:e=>{"Escape"===e.key&&i({type:"setIsOpen",isOpen:!1})},children:[x.jsx("div",{className:"absolute top-0 right-0",children:x.jsx(P,{"data-testid":"close-find-replace-button",onClick:()=>i({type:"setIsOpen",isOpen:!1}),size:"xs",variant:"text",children:x.jsx(jt,{className:"w-4 h-4"})})}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("div",{className:"flex flex-col flex-2 gap-2 w-[55%]",children:[x.jsx(Le,{"data-testid":"find-input",value:r.findText,autoFocus:!0,className:"mr-2 mb-0",placeholder:"Find",onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey?Ic():jc())},onChange:e=>{i({type:"setFind",find:e.target.value})}}),x.jsx(Le,{"data-testid":"replace-input",value:r.replaceText,placeholder:"Replace",onChange:e=>{i({type:"setReplace",replace:e.target.value})}})]}),x.jsxs("div",{className:"flex flex-col gap-2",children:[x.jsxs("div",{className:"flex items-center gap-[2px]",children:[x.jsx(b,{content:"Case Sensitive",children:x.jsx(It,{size:"sm",pressed:r.caseSensitive,"data-state":r.caseSensitive?"on":"off",onPressedChange:e=>i({type:"setCaseSensitive",caseSensitive:e}),children:x.jsx(Ot,{className:"w-4 h-4"})})}),x.jsx(b,{content:"Match Whole Word",children:x.jsx(It,{size:"sm",pressed:r.wholeWord,"data-state":r.wholeWord?"on":"off",onPressedChange:e=>i({type:"setWholeWord",wholeWord:e}),children:x.jsx(el,{className:"w-4 h-4"})})}),x.jsx(b,{content:"Use Regular Expression",children:x.jsx(It,{size:"sm",pressed:r.regexp,"data-state":r.regexp?"on":"off",onPressedChange:e=>i({type:"setRegex",regexp:e}),children:x.jsx(_s,{className:"w-4 h-4"})})})]}),x.jsxs("div",{className:"flex items-center gap-[2px]",children:[x.jsx(P,{"data-testid":"replace-next-button",size:"xs",variant:"outline",className:"h-6 text-xs",onClick:()=>Mc(),disabled:""===r.findText||""===r.replaceText,children:"Replace Next"}),x.jsx(P,{"data-testid":"replace-all-button",size:"xs",variant:"outline",className:"h-6 text-xs",onClick:()=>{const e=Oc();if(!e)return;const{dismiss:t}=Q({title:"Replaced all occurrences",action:x.jsx(P,{"data-testid":"undo-replace-all-button",size:"sm",variant:"outline",onClick:()=>{e(),t()},children:"Undo"})})},disabled:""===r.findText||""===r.replaceText,children:"Replace All"})]})]})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(b,{content:"Find Previous",children:x.jsx(P,{"data-testid":"find-prev-button",size:"xs",variant:"secondary",onClick:()=>Ic(),children:x.jsx(Za,{className:"w-4 h-4"})})}),x.jsx(b,{content:"Find Next",children:x.jsx(P,{"data-testid":"find-next-button",size:"xs",variant:"secondary",onClick:()=>jc(),children:x.jsx(es,{className:"w-4 h-4"})})}),null!=a&&null==c&&x.jsxs("span",{className:"text-sm",children:[a.count," matches"]}),null!=a&&null!=c&&x.jsxs("span",{className:"text-sm",children:[c+1," of ",a.count]})]}),x.jsxs("div",{className:"text-xs text-muted-foreground flex gap-1 mt-2",children:["Press"," ",x.jsx(Il,{shortcut:f.getHotkey("cell.findAndReplace").key})," ","again to open the native browser search."]})]})})};function Fc(e){const[t,n]=o.useState(!1);return o.useEffect((()=>{if(!e)return;n(!1);const t=setTimeout((()=>{n(!0)}),200);return()=>clearTimeout(t)}),[e]),e&&t}const Hc=()=>{const e=u(nc);return x.jsx(b,{content:jl("global.commandPalette"),children:x.jsx(Gi,{"data-testid":"command-palette-button",onClick:()=>e((e=>!e)),shape:"rectangle",color:"hint-green",children:x.jsx(fs,{strokeWidth:1.5,size:18})})})},Vc=({filename:e,needsSave:t,onSaveNotebook:n,getCellsAsJSON:r,presenting:o,onTogglePresenting:i,onInterrupt:a,onRun:s,closed:l,running:c,needsRun:d,undoAvailable:u,appWidth:h})=>{const{undoDeleteCell:f}=X();let p=null;return!l&&u&&(p=x.jsx(b,{content:"Undo cell deletion",children:x.jsx(Gi,{"data-testid":"undo-delete-cell",size:"medium",color:"hint-green",shape:"circle",onClick:f,children:x.jsx(Js,{size:16,strokeWidth:1.5})})})),x.jsxs(x.Fragment,{children:[!o&&x.jsx(Bc,{}),!l&&x.jsxs("div",{className:Wc,children:[o&&x.jsx(zl,{}),x.jsx(bc,{}),x.jsx(Xi,{}),x.jsx(Zi,{description:"This will terminate the Python kernel. You'll lose all data that's in memory."})]}),x.jsxs("div",{className:Mt(Uc,"normal"===h&&"xl:flex-row items-end"),children:[l?x.jsx(Rl,{filename:e,getCellsAsJSON:r,needsSave:t}):x.jsx(b,{content:jl("global.save"),children:x.jsx(Gi,{"data-testid":"save-button",id:"save-button",shape:"rectangle",color:t?"yellow":"hint-green",onClick:e=>{e.preventDefault(),e.stopPropagation(),n()},children:x.jsx(Ls,{strokeWidth:1.5,size:18})})}),x.jsx(b,{content:jl("global.hideCode"),children:x.jsx(Gi,{"data-testid":"hide-code-button",id:"preview-button",shape:"rectangle",color:"hint-green",onClick:i,children:o?x.jsx(Dt,{strokeWidth:1.5,size:18}):x.jsx(Cs,{strokeWidth:1.5,size:18})})}),x.jsx(Hc,{}),x.jsx(Al,{}),x.jsx("div",{}),x.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[p,!l&&x.jsx($c,{running:c,needsRun:d,onRun:s,onInterrupt:a})]})]})]})},$c=({running:e,needsRun:t,onRun:n,onInterrupt:r})=>Fc(e)?x.jsx(b,{content:jl("global.interrupt"),children:x.jsx(Gi,{"data-testid":"interrupt-button",size:"medium",color:"yellow",shape:"circle",onClick:r,children:x.jsx($,{strokeWidth:1.5,size:16})})}):t?x.jsx(b,{content:jl("global.runStale"),children:x.jsx(Gi,{"data-testid":"run-button",size:"medium",color:"yellow",shape:"circle",onClick:n,children:x.jsx(se,{strokeWidth:1.5,size:16})})}):x.jsx(b,{content:"Nothing to run",children:x.jsx(Gi,{"data-testid":"run-button",className:"inactive-button",color:"disabled",size:"medium",shape:"circle",children:x.jsx(se,{strokeWidth:1.5,size:16})})}),Wc="absolute top-3 right-5 m-0 flex items-center space-x-3 min-h-[28px] no-print pointer-events-auto z-30",Uc="absolute bottom-5 right-5 flex flex-col gap-2 items-center no-print pointer-events-auto z-30",Yc={markdown:!0};Tt((function(e,t){const n=Pt();n.experimental[e]=t,Ce({config:n})}),"setFeatureFlag");const Gc=({resetOnBlur:e=!1,placeholderText:t,initialValue:n=null,flexibleWidth:r=!1,onNameChange:i,className:a})=>{const[s,l]=o.useState(n),[c,d]=o.useState([]),[u,h]=o.useState(!1),f=o.useRef(null),p=o.useRef(!1);o.useEffect((()=>{l(n)}),[n]);const g=At.dirname(s||""),m=At.basename(s||""),v=c.filter((e=>At.basename(e.path).startsWith(m))),{loading:y}=_t((async()=>{if(!u)return void d([]);const e=await Rt({path:g});d(e.files)}),[g,u]),b=function(e,t,n){if(!e)return;if(e.endsWith("/"))return;(r="markdown",(null==(o=Pt().experimental)?void 0:o[r])??Yc[r]?new Set(["py","md","markdown","qmd"]):new Set(["py"])).has(At.extension(e))||(e=e.endsWith(".")?`${e}py`:e.endsWith(".p")?`${e}y`:`${e}.py`);var r,o;if(t.some((t=>t.path===e||At.basename(t.path)===e)))return;if(n&&(n===e||At.basename(n)===e))return;return e}(s,c,n),w=(b||v.length>0)&&x.jsxs(Ie,{className:"font-mono",children:[!y&&x.jsx(Oe,{children:"No files"}),b&&x.jsxs(Pe,{variant:"success",className:"py-2 px-3",onSelect:()=>{var e;b&&(p.current=!0,i(b),null==(e=f.current)||e.blur())},children:[x.jsx(ys,{className:"w-4 h-4 mr-2"})," ",x.jsxs("span",{className:"text-sm",children:[n?"Rename to: ":"Save as: ",x.jsx("span",{className:"font-medium text-sm",children:At.basename(b)})]})]},"_rename_"),v.map((e=>{const t=e.isDirectory?"directory":zt(e.path),n=Vt[t];return x.jsxs(Pe,{variant:e.isDirectory?"default":"muted",className:"py-2 px-3",onSelect:()=>{e.isDirectory?l(`${e.path}/`):l(e.path)},children:[x.jsx(n,{className:"w-4 h-4 mr-2"})," ",At.basename(e.path)]},e.path)}))]}),k=10*Math.max(20,(null==s?void 0:s.length)||(null==t?void 0:t.length)||0);return x.jsx(Lt,{open:!0,modal:!1,children:x.jsxs(Bt,{onFocus:()=>{h(!0)},onBlur:t=>{var r;(null==(r=t.relatedTarget)?void 0:r.closest(".filename-input"))||(h(!1),e&&l(n))},shouldFilter:!1,className:"bg-transparent group filename-input",children:[x.jsx(Ft,{children:x.jsx(je,{"data-testid":"dir-completion-input",tabIndex:-1,rootClassName:"border-none justify-center px-1",spellCheck:"false",value:u?s||"":n||"",onKeyDown:e=>{"Escape"===e.key&&e.currentTarget.blur()},icon:null,ref:f,onValueChange:l,placeholder:t,autoComplete:"off",style:r?{maxWidth:k}:void 0,className:Mt(a,"w-full px-4 py-1 my-1 h-9 font-mono text-foreground/60")})}),x.jsx(Ht,{side:"bottom",className:Mt("p-0 w-full min-w-80 max-w-80vw hidden",w&&"group-focus-within:block"),portal:!1,children:w})]})})};const qc=({filename:e,setFilename:t})=>x.jsx(Gc,{placeholderText:e?At.basename(e):"untitled marimo app",initialValue:e,onNameChange:t,flexibleWidth:!0,resetOnBlur:!0,"data-testid":"filename-input",className:null===e?"missing-filename":"filename"});const Kc=e=>{let{transform:t}=e;return{...t,x:0}},Xc=s.memo((({children:e,disabled:t})=>{const n=Y(),{dropCellOver:r}=X(),o=$t(Wt(Zt,{activationConstraint:{distance:8}}),Wt(Xt,{coordinateGetter:Kt})),i=n.cellIds,a=h((e=>{const{active:t,over:n}=e;null!==n&&t.id!==n.id&&r({cellId:t.id,overCellId:n.id})}));return x.jsx(Ut,{sensors:o,collisionDetection:Yt,modifiers:[Kc],onDragEnd:a,children:x.jsx(Gt,{items:i,disabled:t,strategy:qt,children:e})})}));function Zc(e,t){const{updateCellCode:n,afterToggleMarkdown:r}=t;return Jt.of([{key:f.getHotkey("cell.format").key,preventDefault:!0,run:t=>(de({[e]:t},n),!0)},{key:f.getHotkey("cell.viewAsMarkdown").key,preventDefault:!0,run:t=>{const o=fe(e,t,n);return"markdown"===o&&r(),!1!==o}}])}function Jc(){return wt.updateListener.of((e=>{if(e.heightChanged&&e.docChanged){const t=e.view.dom.getElementsByClassName("cm-activeLine cm-line");if(1===t.length){const e=t[0],n=document.getElementById("App");vt(n,"App not found"),function(e,t,n=window){const r=(null==t?void 0:t.top)??0,o=(null==t?void 0:t.bottom)??0,i=e.getBoundingClientRect();i.top<r?n.scrollBy({top:i.top-r,behavior:"smooth"}):i.bottom>window.innerHeight-o&&n.scrollBy({top:i.bottom-window.innerHeight+o,behavior:"smooth"})}(e,{top:30,bottom:150},n)}}}))}async function Qc(e,t,n){const r=on.findElement(e.dom);if(!r)return y.error("Failed to find active cell."),null;const o=on.parse(r.id),{startToken:i,endToken:a}=ed(e.state.doc,t),s=await an.request({document:e.state.doc.slice(0,a).toString(),cellId:o});if(!s)return"cancelled";const l=e.state.doc.slice(i,a).toString();return sn.asHoverTooltip({position:a,message:s,exactName:l,excludeTypes:n})??null}function ed(e,t){let n=t,r=t;for(;n>0;){const t=e.sliceString(n-1,n);if(!/\w/.test(t))break;n--}for(;r<e.length;){const t=e.sliceString(r,r+1);if(!/\w/.test(t))break;r++}return{startToken:n,endToken:r}}const td=nn((async(e,t)=>{const n=await Qc(e,t);"cancelled"!==n&&te.set(rn,{documentation:(null==n?void 0:n.html)??null})}),300),nd=wt.updateListener.of((e=>{if(e.selectionSet&&function(e){const{head:t}=e.selection.main,n=e.doc.sliceString(t-1,t);return/\w/.test(n)}(e.state)){const t=e.state.selection.main.head;td(e.view,t)}}));function rd(e){const{state:t}=e,n=function(e){const{from:t,to:n}=e.selection.main;if(t===n){const{startToken:n,endToken:r}=ed(e.doc,t);return e.doc.sliceString(n,r)}return e.doc.sliceString(t,n)}(t);return!!n&&(ln(e),e.dispatch({effects:cn}),od(e,n))}function od(e,t){const n=function(e,t){var n;if(function(e){return e.startsWith("_")}(t))return e;const r=function(e,t){if(!t)return null;const n=e[t];return n&&0!==n.declaredBy.length?n.declaredBy[0]:null}(te.get(fa),t);if(r){return(null==(n=te.get(ee).cellHandles[r].current)?void 0:n.editorView)??null}return null}(e,t);return!!n&&dn(n,t)}function id(e,t){const{onRun:n,deleteCell:r,createAbove:o,createBelow:i,moveUp:a,moveDown:s,focusUp:l,focusDown:c,sendToTop:d,sendToBottom:u,splitCell:h,moveToNextCell:p,toggleHideCode:g,aiCellCompletion:m}=t,v=[{key:f.getHotkey("cell.run").key,preventDefault:!0,stopPropagation:!0,run:()=>(n(),!0)},{key:f.getHotkey("cell.runAndNewBelow").key,preventDefault:!0,stopPropagation:!0,run:t=>(n(),t.contentDOM.blur(),p({cellId:e,before:!1}),!0)},{key:f.getHotkey("cell.runAndNewAbove").key,preventDefault:!0,stopPropagation:!0,run:t=>(n(),t.contentDOM.blur(),p({cellId:e,before:!0}),!0)},{key:f.getHotkey("cell.delete").key,preventDefault:!0,stopPropagation:!0,run:e=>(0===e.state.doc.length&&r(),!0)},{key:f.getHotkey("cell.moveDown").key,preventDefault:!0,stopPropagation:!0,run:()=>(s(),!0)},{key:f.getHotkey("cell.moveUp").key,preventDefault:!0,stopPropagation:!0,run:()=>(a(),!0)},{key:"ArrowUp",preventDefault:!0,stopPropagation:!0,run:e=>!un(e.state)&&(!!Ji(e)&&(l(),!0))},{key:"ArrowDown",preventDefault:!0,stopPropagation:!0,run:e=>!un(e.state)&&(!!Qi(e)&&(c(),!0))},{key:f.getHotkey("cell.focusDown").key,preventDefault:!0,stopPropagation:!0,run:()=>(c(),!0)},{key:f.getHotkey("cell.focusUp").key,preventDefault:!0,stopPropagation:!0,run:()=>(l(),!0)},{key:f.getHotkey("cell.sendToBottom").key,preventDefault:!0,stopPropagation:!0,run:()=>(u({cellId:e}),!0)},{key:f.getHotkey("cell.sendToTop").key,preventDefault:!0,stopPropagation:!0,run:()=>(d({cellId:e}),!0)},{key:f.getHotkey("cell.createAbove").key,preventDefault:!0,stopPropagation:!0,run:e=>(e.contentDOM.blur(),o(),!0)},{key:f.getHotkey("cell.createBelow").key,preventDefault:!0,stopPropagation:!0,run:e=>(e.contentDOM.blur(),i(),!0)},{key:f.getHotkey("cell.hideCode").key,preventDefault:!0,stopPropagation:!0,run:t=>{var n;const r=g();return ln(t),r?(t.contentDOM.blur(),null==(n=document.getElementById(on.create(e)))||n.focus()):t.contentDOM.focus(),!0}},{key:f.getHotkey("cell.aiCompletion").key,preventDefault:!0,stopPropagation:!0,run:e=>(m()&&e.contentDOM.focus(),!0)},{key:f.getHotkey("cell.goToDefinition").key,preventDefault:!0,stopPropagation:!0,run:e=>(rd(e),!0)},{key:f.getHotkey("cell.splitCell").key,preventDefault:!0,stopPropagation:!0,run:t=>(h({cellId:e}),requestAnimationFrame((()=>{t.contentDOM.blur(),p({cellId:e,before:!1})})),!0)}];return[hn.high(Jt.of(v))]}function ad(e,t){const{updateCellCode:n}=t;return[wt.updateListener.of((t=>{const r=t.transactions.some((e=>e.effects.some((e=>e.is(fn)))));if(t.docChanged){const o=q(t.view);n({cellId:e,code:o,formattingChange:r})}})),Zc(e,t)]}var sd=Object.defineProperty,ld=(e,t,n)=>(((e,t,n)=>{t in e?sd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const cd=Et.define({create:()=>({suggestion:null}),update(e,t){const n=t.effects.find((e=>e.is(dd)));return t.state.doc&&n&&t.state.doc==n.value.doc?{suggestion:n.value.text}:{suggestion:null}}}),dd=kt.define();class ud extends pn{constructor(e){super(),ld(this,"suggestion"),this.suggestion=e}toDOM(){const e=document.createElement("span");return e.style.opacity="0.4",e.className="cm-inline-suggestion",e.textContent=this.suggestion,e}get lineBreaks(){return this.suggestion.split("\n").length-1}}const hd=e=>St.fromClass(class{async update(t){const n=t.state.doc;if(!t.docChanged)return;const r=await e(t.state);t.view.dispatch({effects:dd.of({text:r,doc:n})})}}),fd=St.fromClass(class{constructor(){ld(this,"decorations"),this.decorations=Ct.none}update(e){var t;const n=null==(t=e.state.field(cd))?void 0:t.suggestion;this.decorations=n?function(e,t){const n=e.state.selection.main.head,r=[],o=Ct.widget({widget:new ud(t),side:1});return r.push(o.range(n)),Ct.set(r)}(e.view,n):Ct.none}},{decorations:e=>e.decorations}),pd=hn.highest(Jt.of([{key:"Tab",run:e=>{var t;const n=null==(t=e.state.field(cd))?void 0:t.suggestion;return!!n&&(e.dispatch({...gd(e.state,n,e.state.selection.main.head,e.state.selection.main.head)}),!0)}}]));function gd(e,t,n,r){return{...e.changeByRange((o=>{if(o==e.selection.main)return{changes:{from:n,to:r,insert:t},range:bt.cursor(n+t.length)};const i=r-n;return!o.empty||i&&e.sliceDoc(o.from-i,o.from)!=e.sliceDoc(n,r)?{range:o}:{changes:{from:o.from-i,to:o.from,insert:t},range:bt.cursor(o.from-i+t.length)}})),userEvent:"input.complete"}}function md(e){const{delay:t=500}=e,n=function(e,t,n){let r=()=>{};return(...o)=>(r(),new Promise(((i,a)=>{const s=setTimeout((()=>i(e(...o))),t);r=()=>{clearTimeout(s),void 0!==n&&a(n)}})))}(e.fetchFn,t);return[cd,hd(n),fd,pd]}function vd(e,t){return 0===e.state.doc.length&&(e.dispatch({changes:{from:0,to:e.state.doc.length,insert:t}}),e.dispatch({selection:{anchor:e.state.doc.length,head:e.state.doc.length}}),!0)}function yd(e){const{beforeText:t,linkText:n,afterText:r,onClick:o}=e,i=document.createElement("span");i.append(document.createTextNode(t));const a=document.createElement("span");return a.textContent=n,a.classList.add("cm-clickable-placeholder"),a.onclick=e=>{e.stopPropagation(),o()},i.append(a),i.append(document.createTextNode(r)),[gn(i),wt.theme({".cm-placeholder":{color:"var(--slate-8)"},".cm-clickable-placeholder":{cursor:"pointer !important",pointerEvents:"auto",color:"var(--slate-9)",textDecoration:"underline",textUnderlineOffset:"0.2em"},".cm-clickable-placeholder:hover":{color:"var(--sky-11)"}})]}const xd=Ct.mark({class:"underline"}),bd=kt.define(),wd=kt.define(),kd=Et.define({create:()=>Ct.none,update(e,t){let n=e.map(t.changes);for(const r of t.effects)r.is(bd)?n=e.update({add:[xd.range(r.value.from,r.value.to)]}):r.is(wd)&&(n=Ct.none);return n},provide:e=>wt.decorations.from(e)});class Ed{constructor(e,n){t(this,"view"),t(this,"commandClickMode"),t(this,"hoveredRange"),t(this,"onClick"),t(this,"keydown",(e=>{"Meta"!==e.key&&"Control"!==e.key||(this.commandClickMode=!0,this.view.dom.addEventListener("mousemove",this.mousemove),this.view.dom.addEventListener("click",this.click))})),t(this,"keyup",(e=>{"Meta"!==e.key&&"Control"!==e.key||(this.commandClickMode=!1,this.view.dom.removeEventListener("mousemove",this.mousemove),this.view.dom.removeEventListener("click",this.click),this.clearUnderline())})),t(this,"windowBlur",(()=>{this.commandClickMode&&(this.commandClickMode=!1,this.view.dom.removeEventListener("mousemove",this.mousemove),this.view.dom.removeEventListener("click",this.click),this.clearUnderline())})),t(this,"mousemove",(e=>{if(!this.commandClickMode)return void this.clearUnderline();const t=this.view.posAtCoords({x:e.clientX,y:e.clientY});if(null==t)return void this.clearUnderline();const n=mn(this.view.state).cursorAt(t);if("VariableName"===n.name){const{from:e,to:r}=n;if(this.hoveredRange&&this.hoveredRange.from===e&&this.hoveredRange.to===r)return;this.clearUnderline(),this.hoveredRange={from:e,to:r,position:t},this.view.dispatch({effects:bd.of(this.hoveredRange)})}else this.clearUnderline()})),t(this,"click",(e=>{if(this.hoveredRange){const t=this.view.state.doc.sliceString(this.hoveredRange.from,this.hoveredRange.to);e.preventDefault(),e.stopPropagation(),this.onClick(this.view,t),this.view.dispatch({selection:{head:this.hoveredRange.position,anchor:this.hoveredRange.position}})}})),this.view=e,this.commandClickMode=!1,this.hoveredRange=null,this.onClick=n,window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),window.addEventListener("blur",this.windowBlur)}update(e){}destroy(){window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),window.removeEventListener("blur",this.windowBlur),this.view.dom.removeEventListener("mousemove",this.mousemove),this.view.dom.removeEventListener("click",this.click)}clearUnderline(){this.hoveredRange&&(this.view.dispatch({effects:wd.of(null)}),this.hoveredRange=null)}}const Cd=(e,t)=>[wt.lineWrapping,vn(),yn(),xn(),bn(),wn(),kn(),En(),Cn({position:"fixed",parent:document.querySelector("#App")??void 0}),Jc(),"dark"===t?Sn:[],[tn((async(e,t)=>{const n=await Qc(e,t,["tooltip"]);return null===n||"cancelled"===n?null:n}),{hideOnChange:!0}),nd],[md({delay:500,fetchFn:async e=>{if(!ta())return"";await new Promise((e=>setTimeout(e,10)));const t=e.doc.toString(),n=na(t),r=n.split("\n").length-t.split("\n").length,o=function(e,t){const n=e.lineAt(t);return{line:n.number-1,character:t-n.from}}(e.doc,e.selection.main.head);return o.line+=r,(await ra().getCompletion({doc:{source:n,tabSize:e.tabSize,indentSize:1,insertSpaces:!0,path:oa,version:0,uri:`file://${oa}`,relativePath:oa,languageId:ia,position:o}})).completions.map((e=>e.displayText))[0]??""}}),ea().slice(0,-2)],Nn(),jn(),hn.high(Jt.of(In)),On(),Mn(),Dn.of("    "),Tn(Pn,{fallback:!0}),Jt.of([...An,..._n]),Rn(e),zn.of(Ln()),Bn.allowMultipleSelections.of(!0),[Jt.of([{key:"Escape",preventDefault:!1,run:Ec},{key:f.getHotkey("cell.selectNextOccurrence").key,preventDefault:!0,run:Qt},{key:f.getHotkey("cell.findAndReplace").key,preventDefault:!0,run:kc}]),en(),zc,Ac,Lc],Jt.of([{key:"Tab",run:e=>Fn(e)||(e=>{const{from:t,to:n}=e.state.selection.main;if(t!==n)return!1;const r=e.state.doc.lineAt(n);return""!==r.text.slice(0,n-r.from).trim()&&Wn(e)})(e)||Hn(e),preventDefault:!0}]),Jt.of([...Vn,$n])],Sd=({appClosed:e,onClick:t,tooltipContent:n})=>x.jsx(b,{content:n,usePortal:!1,children:x.jsx(Gi,{onClick:t,className:"ShoulderButton "+(e?" inactive-button":""),shape:"circle",size:"small",color:"hint-green","data-testid":"create-cell-button",children:x.jsx(Un,{strokeWidth:1.8})})});const Nd=e=>{const{onClick:t,appClosed:n,needsRun:r,status:o,config:i,edited:a}=e,s="disabled-transitively"===o,l="running"===o||"queued"===o,c=n||l||!i.disabled&&s&&!a,d=function(e,t,n,r){return e?"disabled":t&&!n?"yellow":n||r?"disabled":"hint-green"}(n,r,l,c),u=Fc("running"===o);if(i.disabled)return x.jsx(b,{content:"Add code to notebook",usePortal:!1,children:x.jsx(Gi,{className:Mt(!r&&"hover-action",c&&"inactive-button"),onClick:t,color:d,shape:"circle",size:"small","data-testid":"run-button",children:x.jsx(ks,{strokeWidth:1.8})})});if(!i.disabled&&s&&!a)return x.jsx(b,{content:"This cell can't be run because it has a disabled ancestor",usePortal:!1,children:x.jsx(Gi,{className:Mt(!r&&"hover-action",c&&"inactive-button"),onClick:t,color:d,shape:"circle",size:"small","data-testid":"run-button",children:x.jsx(se,{strokeWidth:1.8})})});if(u)return x.jsx(b,{content:jl("global.interrupt"),usePortal:!1,children:x.jsx(Gi,{className:Mt(n&&"inactive-button"),onClick:Yn,color:"yellow",shape:"circle",size:"small","data-testid":"run-button",children:x.jsx($,{strokeWidth:1.5})})});let h="";return h=n?"App disconnected":"queued"===o?"This cell is already queued to run":jl("cell.run"),x.jsx(b,{content:h,usePortal:!1,children:x.jsx(Gi,{className:Mt(!r&&"hover-action",c&&"inactive-button"),onClick:t,color:d,shape:"circle",size:"small","data-testid":"run-button",children:x.jsx(se,{strokeWidth:1.8})})})},jd=e=>{const{status:t,appClosed:n,onClick:r}=e,o="running"===t||"queued"===t;let i=null;return i=n?"App disconnected":"running"===t?"A cell can't be deleted when it's running":"queued"===t?"A cell can't be deleted when it's queued to run":"Delete",x.jsx(b,{content:i,usePortal:!1,children:x.jsx(P,{variant:"ghost",size:"icon",onClick:r,"data-testid":"delete-button",className:Mt("hover:bg-transparent text-destructive/60 hover:text-destructive",{DeleteButton:!0,"inactive-button":n||o,running:o}),style:{boxShadow:"none"},children:x.jsx(ye,{size:14})})})};const Id=({editing:e,status:t,disabled:n,staleInputs:r,edited:o,interrupted:i,elapsedTime:a,runStartTimestamp:s})=>{if(!e)return null;if(n&&"running"===t)return y.error("CellStatusComponent: disabled and running"),null;if(n&&r)return x.jsx(b,{content:"This cell is stale, but it's disabled and can't be run",usePortal:!1,children:x.jsx("div",{className:"cell-status-icon cell-status-stale","data-testid":"cell-status","data-status":"stale",children:x.jsxs($l,{children:[x.jsx(ts,{className:"h-5 w-5",strokeWidth:1.5}),x.jsx(qn,{className:"h-3 w-3",strokeWidth:2.5})]})})});if(n)return x.jsx(b,{content:"This cell is disabled",usePortal:!1,children:x.jsx("div",{className:"cell-status-icon cell-status-disabled","data-testid":"cell-status","data-status":"disabled",children:x.jsx(ts,{className:"h-5 w-5",strokeWidth:1.5})})});if(!r&&"disabled-transitively"===t)return x.jsx(b,{content:"An ancestor of this cell is disabled, so it can't be run",usePortal:!1,children:x.jsx("div",{className:"cell-status-icon cell-status-stale","data-testid":"cell-status","data-status":"disabled-transitively",children:x.jsxs($l,{layerTop:!0,children:[x.jsx(tl,{className:"h-5 w-5",strokeWidth:1.5}),x.jsx(ts,{className:"h-3 w-3",strokeWidth:2.5})]})})});if(r&&"disabled-transitively"===t)return x.jsx(b,{content:"This cell is stale, but an ancestor is disabled so it can't be run",usePortal:!1,children:x.jsx("div",{className:"cell-status-icon cell-status-stale","data-testid":"cell-status","data-status":"stale",children:x.jsxs($l,{children:[x.jsx(qn,{className:"h-5 w-5",strokeWidth:1}),x.jsx(ts,{className:"h-3 w-3",strokeWidth:2.5})]})})});if("running"===t)return x.jsx(b,{content:"This cell is running",usePortal:!1,children:x.jsx("div",{className:"cell-status-icon elapsed-time running","data-testid":"cell-status","data-status":"running",children:x.jsx(Md,{startTime:Gn.fromSeconds(s)||Gn.now()})})});if("queued"===t)return x.jsx(b,{content:"This cell is queued to run",usePortal:!1,children:x.jsx("div",{className:"cell-status-icon cell-status-queued","data-testid":"cell-status","data-status":"queued",children:x.jsx(ms,{className:"h-5 w-5",strokeWidth:1.5})})});if(o||i||r){const e=Od(a);let t="",n="";return i?(t="This cell was interrupted when it was last run",n=`This cell ran for ${e} before being interrupted`):o?(t="This cell has been modified since it was last run",n=`This cell took ${e} to run`):(t="This cell has not been run with the latest inputs.",n=`This cell took ${e} to run`),x.jsxs("div",{className:"cell-status-icon flex items-center gap-2",children:[x.jsx(b,{content:t,usePortal:!1,children:x.jsx("div",{className:"cell-status-stale","data-testid":"cell-status","data-status":"outdated",children:x.jsx(qn,{className:"h-5 w-5",strokeWidth:1.5})})}),e&&x.jsx(b,{content:n,usePortal:!1,children:x.jsx("div",{className:"elapsed-time hover-action","data-testid":"cell-status","data-status":"outdated",children:x.jsx("span",{children:e})})})]})}if(null!==a){const e=Od(a);return x.jsx(b,{content:`This cell took ${e} to run`,usePortal:!1,children:x.jsx("div",{className:"cell-status-icon elapsed-time hover-action","data-testid":"cell-status","data-status":"idle",children:x.jsx("span",{children:e})})})}return null};function Od(e){if(null===e)return"";if(e>6e4){const t=(e/6e4).toFixed(0),n=(e%6e4/1e3).toFixed(0);return`${t.toString()}m${n.toString()}s`}return e>1e3?`${(e/1e3).toFixed(2).toString()}s`:`${e.toFixed(0).toString()}ms`}const Md=e=>{const t=function(e){const t=o.useRef(e),[n,r]=o.useState(e);return o.useEffect((()=>{const e=setInterval((()=>{r(Gn.now().toMilliseconds())}),17);return()=>clearInterval(e)}),[]),n-t.current}(e.startTime.toMilliseconds());return x.jsx("span",{children:Od(t)})};function Dd(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}const Td=s.createContext(null),Pd=o.memo((()=>o.useContext(Td)));Pd.displayName="DragHandle";const Ad=s.forwardRef((({cellId:e,...t},n)=>{const{attributes:r,listeners:o,setNodeRef:i,transform:a,transition:s,isDragging:l}=Kn({id:e.toString()}),c={transform:a?Xn.Transform.toString({x:0,y:a.y,scaleX:1,scaleY:1}):void 0,transition:s,zIndex:l?2:void 0,position:"relative"},d=Dd(n,i),u=x.jsx("div",{...r,...o,"data-testid":"drag-button",className:"py-[1px] mx-2 cursor-grab opacity-50 hover:opacity-100 hover-action hover:bg-muted rounded border border-transparent hover:border-border active:bg-accent",children:x.jsx(ws,{strokeWidth:1,size:20})}),h=Boolean(a);return x.jsx("div",{tabIndex:-1,ref:d,...t,className:Mt(t.className,h&&"is-moving"),style:c,children:x.jsx(Td.Provider,{value:u,children:t.children})})}));Ad.displayName="SortableCell";const _d=o.memo(Ad),Rd=s.memo(s.forwardRef((({children:e,showTooltip:t=!0,...n},r)=>{const[i,a]=o.useState(!1),s=Zl({cell:n}),l=Zn();o.useImperativeHandle(r,(()=>({toggle:()=>a((e=>!e))})));const c=x.jsx(Ht,{className:"w-[300px] p-0 pt-1",...l,children:x.jsxs(Bt,{children:[x.jsx(je,{placeholder:"Search actions...",className:"h-6 m-1"}),x.jsx(Oe,{children:"No results"}),s.map(((e,t)=>x.jsxs(o.Fragment,{children:[x.jsx(Me,{children:e.map((e=>x.jsx(Pe,{onSelect:()=>{e.disableClick||(e.handle(),a(!1))},variant:e.variant,children:x.jsxs("div",{className:"flex items-center flex-1",children:[e.icon&&x.jsx("div",{className:"mr-2 w-5",children:e.icon}),x.jsx("div",{className:"flex-1",children:e.label}),x.jsxs("div",{className:"flex-shrink-0 text-sm",children:[e.hotkey&&Ol(e.hotkey),e.rightElement]})]})},e.label)))},t),t<s.length-1&&x.jsx(Te,{})]},t)))]})});if(!t)return x.jsxs(Lt,{open:i,onOpenChange:a,children:[x.jsx(Jn,{asChild:!0,children:e}),c]});const d=x.jsx(tr,{className:"w-full bg-card",tabIndex:-1,children:x.jsxs("div",{className:"text-foreground-muted flex flex-col text-center",children:[x.jsxs("span",{children:[x.jsx("span",{className:"text-foreground font-semibold",children:"Drag "}),"to move cell"]}),x.jsxs("span",{children:[x.jsx("span",{className:"text-foreground font-semibold",children:"Click "}),"to open menu"]})]})});return x.jsxs(Lt,{open:i,onOpenChange:a,children:[x.jsxs(Qn,{delayDuration:400,disableHoverableContent:!0,children:[!i&&d,x.jsx(er,{children:x.jsx(Jn,{className:"flex",children:e})})]}),c]})}))),zd=s.memo((({children:e,cellId:t})=>{const n=d(o.useMemo((()=>function(e){return c((t=>ec(e,t(ee))))}(t)),[t]));return n?x.jsx(Rd,{showTooltip:!1,...n,children:e}):null}));zd.displayName="ConnectionCellActionsDropdown";const Ld="ContextMenu",[Bd,Fd]=nr(Ld,[rr]),Hd=rr(),[Vd,$d]=Bd(Ld),Wd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...i}=e,a=$d("ContextMenuTrigger",n),s=Hd(n),l=o.useRef({x:0,y:0}),c=o.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),d=o.useRef(0),u=o.useCallback((()=>window.clearTimeout(d.current)),[]),h=e=>{l.current={x:e.clientX,y:e.clientY},a.onOpenChange(!0)};return o.useEffect((()=>u),[u]),o.useEffect((()=>{r&&u()}),[r,u]),o.createElement(o.Fragment,null,o.createElement(vr,ir({},s,{virtualRef:c})),o.createElement(yr.span,ir({"data-state":a.open?"open":"closed","data-disabled":r?"":void 0},i,{ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:xr(e.onContextMenu,(e=>{u(),h(e),e.preventDefault()})),onPointerDown:r?e.onPointerDown:xr(e.onPointerDown,Ud((e=>{u(),d.current=window.setTimeout((()=>h(e)),700)}))),onPointerMove:r?e.onPointerMove:xr(e.onPointerMove,Ud(u)),onPointerCancel:r?e.onPointerCancel:xr(e.onPointerCancel,Ud(u)),onPointerUp:r?e.onPointerUp:xr(e.onPointerUp,Ud(u))})))}));function Ud(e){return t=>"mouse"!==t.pointerType?e(t):void 0}const Yd=e=>{const{__scopeContextMenu:t,...n}=e,r=Hd(t);return o.createElement(or,ir({},r,n))},Gd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=$d("ContextMenuContent",n),a=Hd(n),s=o.useRef(!1);return o.createElement(ar,ir({},a,r,{ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:t=>{var n;null===(n=e.onCloseAutoFocus)||void 0===n||n.call(e,t),!t.defaultPrevented&&s.current&&t.preventDefault(),s.current=!1},onInteractOutside:t=>{var n;null===(n=e.onInteractOutside)||void 0===n||n.call(e,t),t.defaultPrevented||i.modal||(s.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))})),qd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(sr,ir({},i,r,{ref:t}))})),Kd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(lr,ir({},i,r,{ref:t}))})),Xd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(cr,ir({},i,r,{ref:t}))})),Zd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(dr,ir({},i,r,{ref:t}))})),Jd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(ur,ir({},i,r,{ref:t}))})),Qd=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(hr,ir({},i,r,{ref:t}))})),eu=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(fr,ir({},i,r,{ref:t}))})),tu=o.forwardRef(((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Hd(n);return o.createElement(pr,ir({},i,r,{ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))})),nu=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:i,modal:a=!0}=e,[s,l]=o.useState(!1),c=Hd(t),d=gr(r),u=o.useCallback((e=>{l(e),d(e)}),[d]);return o.createElement(Vd,{scope:t,open:s,onOpenChange:u,modal:a},o.createElement(mr,ir({},c,{dir:i,open:s,onOpenChange:u,modal:a}),n))},ru=Wd;o.forwardRef((({className:e,inset:t,children:n,...r},o)=>x.jsxs(eu,{ref:o,className:br({className:e,inset:t}),...r,children:[n,x.jsx(wr,{className:"ml-auto h-4 w-4"})]}))).displayName=eu.displayName;const ou="data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2";o.forwardRef((({className:e,...t},n)=>x.jsx(tu,{ref:n,className:Mt(kr({subcontent:!0}),ou,e),...t}))).displayName=tu.displayName;const iu=o.forwardRef((({className:e,...t},n)=>x.jsx(Yd,{children:x.jsx(Gd,{ref:n,className:Mt(kr(),ou,e),...t})})));iu.displayName=Gd.displayName;const au=o.forwardRef((({className:e,inset:t,variant:n,...r},o)=>x.jsx(Kd,{ref:o,className:Er({className:e,inset:t,variant:n}),...r})));au.displayName=Kd.displayName;o.forwardRef((({className:e,children:t,checked:n,...r},o)=>x.jsxs(Xd,{ref:o,className:Cr({className:e}),checked:n,...r,children:[x.jsx("span",{className:Cr(),children:x.jsx(Jd,{children:x.jsx(Sr,{className:"h-4 w-4"})})}),t]}))).displayName=Xd.displayName;o.forwardRef((({className:e,children:t,...n},r)=>x.jsxs(Zd,{ref:r,className:Cr({className:e}),...n,children:[x.jsx("span",{className:Cr(),children:x.jsx(Jd,{children:x.jsx(Nr,{className:"h-4 w-4 fill-current"})})}),t]}))).displayName=Zd.displayName;o.forwardRef((({className:e,inset:t,...n},r)=>x.jsx(qd,{ref:r,className:jr({className:e,inset:t}),...n}))).displayName=qd.displayName;const su=o.forwardRef((({className:e,...t},n)=>x.jsx(Qd,{ref:n,className:Mt(Ir({className:e})),...t})));su.displayName=Qd.displayName;const lu=({children:e,...t})=>{const n=Zl({cell:t}),[r,i]=s.useState(),a=[{label:"Copy",icon:x.jsx(Be,{size:13,strokeWidth:1.5}),handle:()=>{document.execCommand("copy")}},{label:"Cut",icon:x.jsx(Bs,{size:13,strokeWidth:1.5}),handle:()=>{document.execCommand("cut")}},{label:"Paste",icon:x.jsx(ds,{size:13,strokeWidth:1.5}),handle:async()=>{const{getEditorView:e}=t,n=e();if(!n)return;const r=await navigator.clipboard.readText();if(r){const{from:e,to:t}=n.state.selection.main,o=n.state.update({changes:{from:e,to:t,insert:r}});n.dispatch(o)}}},{icon:x.jsx(le,{size:13,strokeWidth:1.5}),label:"Download image",hidden:!r,handle:()=>{if(r){const e=document.createElement("a");e.download="image.png",e.href=r.src,e.click()}}},{label:"Go to Definition",icon:x.jsx(Or,{size:13,strokeWidth:1.5}),handle:()=>{const{getEditorView:e}=t,n=e();n&&rd(n)}}];return x.jsxs(nu,{children:[x.jsx(ru,{onContextMenu:e=>{e.target instanceof HTMLImageElement?i(e.target):i(void 0)},asChild:!0,children:e}),x.jsx(iu,{className:"w-[300px]",children:[a,...n].map(((e,t)=>x.jsxs(o.Fragment,{children:[e.map((e=>e.hidden?null:x.jsx(au,{onSelect:t=>{e.handle(t)},variant:e.variant,children:x.jsxs("div",{className:"flex items-center flex-1",children:[e.icon&&x.jsx("div",{className:"mr-2 w-5",children:e.icon}),x.jsx("div",{className:"flex-1",children:e.label}),x.jsxs("div",{className:"flex-shrink-0 text-sm",children:[e.hotkey&&Ol(e.hotkey),e.rightElement]})]})},e.label))),t<e.length-1&&x.jsx(su,{})]},t)))})]})},cu=({editorView:e,languageAdapter:t,canUseMarkdown:n,onAfterToggleMarkdown:r})=>{if(!n&&"markdown"!==t)return null;const o="markdown"===t?"python":"markdown",i="markdown"===t?Ki:qi;return x.jsx("div",{className:"absolute top-0 right-5 z-20 hover-action",children:x.jsx(b,{content:`View as ${rt(o)}`,children:x.jsx(P,{"data-testid":"language-toggle-button",variant:"text",size:"xs",className:"opacity-80",children:x.jsx(i,{className:"cursor-pointer",fill:"var(--sky-11)",fontSize:20,onClick:()=>{e&&(Mr(e,o),r())}})})})})};var du={modified:{doc:""},original:{doc:""}},uu=o.createContext(du);function hu(e,t){return ir({},e,t,{modified:ir({},e.modified,t.modified),original:ir({},e.original,t.original)})}var fu=()=>o.useContext(uu),pu=e=>{var{children:t,theme:n}=e,[r,i]=o.useReducer(hu,ir({},du,{theme:n}));return o.useEffect((()=>i({theme:n})),[n]),x.jsx(uu.Provider,{value:ir({},r,{dispatch:i}),children:t})},gu=["extensions","value","selection","onChange"],mu=e=>{var{extensions:t=[],value:n,selection:r,onChange:i}=e,a=Dr(e,gu),{theme:s,dispatch:l}=fu(),c=Tr(ir({},a,{theme:s})),d=wt.updateListener.of((e=>{if(e.docChanged&&"function"==typeof i){var t=e.state.doc.toString();i(t,e)}}));return o.useEffect((()=>l({original:{doc:n,selection:r,extensions:[d,...c,...t]},originalExtension:{onChange:i,option:a,extension:[t,d]}})),[e]),null};mu.displayName="CodeMirrorMerge.Original";var vu=["extensions","value","selection","onChange"],yu=e=>{var{extensions:t=[],value:n,selection:r,onChange:i}=e,a=Dr(e,vu),{theme:s,dispatch:l}=fu(),c=Tr(ir({},a,{theme:s})),d=wt.updateListener.of((e=>{if(e.docChanged&&"function"==typeof i){var t=e.state.doc.toString();i(t,e)}}));return o.useEffect((()=>l({modified:{doc:n,selection:r,extensions:[d,...c,...t]},modifiedExtension:{onChange:i,option:a,extension:[d,t]}})),[e]),null};yu.displayName="CodeMirrorMerge.Modified";class xu{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}offset(e,t){return new xu(this.fromA+e,this.toA+e,this.fromB+t,this.toB+t)}}function bu(e,t,n,r,o,i){if(e==r)return[];let a=ju(e,t,n,r,o,i),s=Iu(e,t+a,n,r,o+a,i),l=(n-=s)-(t+=a),c=(i-=s)-(o+=a);if(!l||!c)return[new xu(t,n,o,i)];if(l>c){let a=e.slice(t,n).indexOf(r.slice(o,i));if(a>-1)return[new xu(t,t+a,o,o),new xu(t+a+c,n,i,i)]}else if(c>l){let a=r.slice(o,i).indexOf(e.slice(t,n));if(a>-1)return[new xu(t,t,o,o+a),new xu(n,n,o+a+l,i)]}if(1==l||1==c)return[new xu(t,n,o,i)];let d=Mu(e,t,n,r,o,i);if(d){let[a,s,l]=d;return bu(e,t,a,r,o,s).concat(bu(e,a+l,n,r,s+l,i))}return function(e,t,n,r,o,i){let a=n-t,s=i-o;if(wu<1e9&&Math.min(a,s)>16*wu)return Math.min(a,s)>64*wu?[new xu(t,n,o,i)]:Du(e,t,n,r,o,i);let l=Math.ceil((a+s)/2);Eu.reset(l),Cu.reset(l);let c=(n,i)=>e.charCodeAt(t+n)==r.charCodeAt(o+i),d=(t,o)=>e.charCodeAt(n-t-1)==r.charCodeAt(i-o-1),u=(a-s)%2!=0?Cu:null,h=u?null:Eu;for(let f=0;f<l;f++){if(f>wu)return Du(e,t,n,r,o,i);let p=Eu.advance(f,a,s,l,u,!1,c)||Cu.advance(f,a,s,l,h,!0,d);if(p)return Su(e,t,n,t+p[0],r,o,i,o+p[1])}return[new xu(t,n,o,i)]}(e,t,n,r,o,i)}let wu=1e9;class ku{constructor(){this.vec=[]}reset(e){this.len=e<<1;for(let t=0;t<this.len;t++)this.vec[t]=-1;this.vec[e+1]=0,this.start=this.end=0}advance(e,t,n,r,o,i,a){for(let s=-e+this.start;s<=e-this.end;s+=2){let l=r+s,c=s==-e||s!=e&&this.vec[l-1]<this.vec[l+1]?this.vec[l+1]:this.vec[l-1]+1,d=c-s;for(;c<t&&d<n&&a(c,d);)c++,d++;if(this.vec[l]=c,c>t)this.end+=2;else if(d>n)this.start+=2;else if(o){let e=r+(t-n)-s;if(e>=0&&e<this.len&&-1!=o.vec[e])if(i){let n=o.vec[e];if(n>=t-c)return[n,r+n-e]}else{if(c>=t-o.vec[e])return[c,d]}}}return null}}const Eu=new ku,Cu=new ku;function Su(e,t,n,r,o,i,a,s){let l=!1;return Vu(e,r)||++r!=n||(l=!0),Vu(o,s)||++s!=a||(l=!0),l?[new xu(t,n,i,a)]:bu(e,t,r,o,i,s).concat(bu(e,r,n,o,s,a))}function Nu(e,t){let n=1,r=Math.min(e,t);for(;n<r;)n<<=1;return n}function ju(e,t,n,r,o,i){if(t==n||t==i||e.charCodeAt(t)!=r.charCodeAt(o))return 0;let a=Nu(n-t,i-o);for(let s=t,l=o;;){let o=s+a,c=l+a;if(o>n||c>i||e.slice(s,o)!=r.slice(l,c)){if(1==a)return s-t-(Vu(e,s)?0:1);a>>=1}else{if(o==n||c==i)return o-t;s=o,l=c}}}function Iu(e,t,n,r,o,i){if(t==n||o==i||e.charCodeAt(n-1)!=r.charCodeAt(i-1))return 0;let a=Nu(n-t,i-o);for(let s=n,l=i;;){let i=s-a,c=l-a;if(i<t||c<o||e.slice(i,s)!=r.slice(c,l)){if(1==a)return n-s-(Vu(e,s)?0:1);a>>=1}else{if(i==t||c==o)return n-i;s=i,l=c}}}function Ou(e,t,n,r,o,i,a,s){let l=r.slice(o,i),c=null;for(;;){if(c||a<s)return c;for(let s=t+a;;){Vu(e,s)||s++;let d=s+a;if(Vu(e,d)||(d+=d==s+1?1:-1),d>=n)break;let u=e.slice(s,d),h=-1;for(;-1!=(h=l.indexOf(u,h+1));){let a=ju(e,d,n,r,o+h+u.length,i),l=Iu(e,t,s,r,o,o+h),f=u.length+a+l;(!c||c[2]<f)&&(c=[s-l,o+h-l,f])}s=d}if(s<0)return c;a>>=1}}function Mu(e,t,n,r,o,i){let a=n-t,s=i-o;if(a<s){let a=Mu(r,o,i,e,t,n);return a&&[a[1],a[0],a[2]]}return a<4||2*s<a?null:Ou(e,t,n,r,o,i,Math.floor(a/4),-1)}function Du(e,t,n,r,o,i){let a,s=n-t,l=i-o;if(s<l){let l=Ou(r,o,i,e,t,n,Math.floor(s/6),50);a=l&&[l[1],l[0],l[2]]}else a=Ou(e,t,n,r,o,i,Math.floor(l/6),50);if(!a)return[new xu(t,n,o,i)];let[c,d,u]=a;return bu(e,t,c,r,o,d).concat(bu(e,c+u,n,r,d+u,i))}function Tu(e,t){for(let n=1;n<e.length;n++){let r=e[n-1],o=e[n];r.toA>o.fromA-t&&r.toB>o.fromB-t&&(e[n-1]=new xu(r.fromA,o.toA,r.fromB,o.toB),e.splice(n--,1))}}let Pu;try{Pu=new RegExp("[\\p{Alphabetic}\\p{Number}]","u")}catch(dM){}function Au(e){return e>48&&e<58||e>64&&e<91||e>96&&e<123}function _u(e,t){if(t==e.length)return 0;let n=e.charCodeAt(t);return n<192?Au(n)?1:0:Pu?Fu(n)&&t!=e.length-1?Pu.test(e.slice(t,t+2))?2:0:Pu.test(String.fromCharCode(n))?1:0:0}function Ru(e,t){if(!t)return 0;let n=e.charCodeAt(t-1);return n<192?Au(n)?1:0:Pu?Hu(n)&&1!=t?Pu.test(e.slice(t-2,t))?2:0:Pu.test(String.fromCharCode(n))?1:0:0}function zu(e,t,n){if(t==e.length||!Ru(e,t))return t;for(let r=t,o=t+n;;){let n=_u(e,r);if(!n)return r;if(r+=n,r>o)return t}}function Lu(e,t,n){if(!t||!_u(e,t))return t;for(let r=t,o=t-n;;){let n=Ru(e,r);if(!n)return r;if(r-=n,r<o)return t}}function Bu(e,t,n){for(let r=t,o=t-n;;){let n=r?e.charCodeAt(r-1):10;if(10==n)return r;if(r--,r<o||32!=n&&9!=n)return t}}const Fu=e=>e>=55296&&e<=56319,Hu=e=>e>=56320&&e<=57343;function Vu(e,t){return!t||t==e.length||!Fu(e.charCodeAt(t-1))||!Hu(e.charCodeAt(t))}function $u(e,t,n){var r;return wu=(null!==(r=null==n?void 0:n.scanLimit)&&void 0!==r?r:1e9)>>1,function(e,t,n){for(;;){Tu(n,1);let r=!1;for(let o=0;o<n.length;o++){let i,a,s=n[o];(i=ju(e,s.fromA,s.toA,t,s.fromB,s.toB))&&(s=n[o]=new xu(s.fromA+i,s.toA,s.fromB+i,s.toB)),(a=Iu(e,s.fromA,s.toA,t,s.fromB,s.toB))&&(s=n[o]=new xu(s.fromA,s.toA-a,s.fromB,s.toB-a));let l=s.toA-s.fromA,c=s.toB-s.fromB;if(l&&c)continue;let d=s.fromA-(o?n[o-1].toA:0),u=(o<n.length-1?n[o+1].fromA:e.length)-s.toA;if(!d||!u)continue;let h=l?e.slice(s.fromA,s.toA):t.slice(s.fromB,s.toB);d<=h.length&&e.slice(s.fromA-d,s.fromA)==h.slice(h.length-d)?(n[o]=new xu(s.fromA-d,s.toA-d,s.fromB-d,s.toB-d),r=!0):u<=h.length&&e.slice(s.toA,s.toA+u)==h.slice(0,u)&&(n[o]=new xu(s.fromA+u,s.toA+u,s.fromB+u,s.toB+u),r=!0)}if(!r)break}return n}(e,t,bu(e,0,e.length,t,0,t.length))}function Wu(e,t,n){return function(e,t,n){for(let r=0,o=0;o<e.length;o++){let i=e[o],a=i.toA-i.fromA,s=i.toB-i.fromB;if(a&&s||a>3||s>3){let l=o==e.length-1?t.length:e[o+1].fromA,c=i.fromA-r,d=l-i.toA,u=Lu(t,i.fromA,Math.min(c,5)),h=zu(t,i.toA,Math.min(d,5)),f=i.fromA-u,p=h-i.toA;if(!a||!s){let d,g,m=Math.max(a,s),[v,y,x]=a?[t,i.fromA,i.toA]:[n,i.fromB,i.toB];f&&p?(m>f&&t.slice(u,i.fromA)==v.slice(x-f,x)?(i=e[o]=new xu(u,u+a,i.fromB-f,i.toB-f),u=i.fromA,h=zu(t,i.toA,Math.min(l-i.toA,5))):m>p&&t.slice(i.toA,h)==v.slice(y,y+p)&&(i=e[o]=new xu(h-a,h,i.fromB+p,i.toB+p),h=i.toA,u=Lu(t,i.fromA,Math.min(i.fromA-r,5))),f=i.fromA-u,p=h-i.toA):f||p||!(g=i.fromA-(d=Bu(t,i.fromA,c)))||t.slice(d,i.fromA)!=v.slice(x-g,x)||(i=e[o]=new xu(d,d+a,i.fromB-g,i.toB-g))}(f||p)&&(i=e[o]=new xu(i.fromA-f,i.toA+p,i.fromB-f,i.toB+p)),r=i.toA}}return Tu(e,3),e}($u(e,t,n),e,t)}const Uu=Ar.define({combine:e=>e[0]}),Yu=kt.define(),Gu=Et.define({create:e=>null,update(e,t){for(let n of t.effects)n.is(Yu)&&(e=n.value);return e}});class qu{constructor(e,t,n,r,o){this.changes=e,this.fromA=t,this.toA=n,this.fromB=r,this.toB=o}offset(e,t){return e||t?new qu(this.changes,this.fromA+e,this.toA+e,this.fromB+t,this.toB+t):this}get endA(){return Math.max(this.fromA,this.toA-1)}get endB(){return Math.max(this.fromB,this.toB-1)}static build(e,t,n){return Zu(Wu(e.toString(),t.toString(),n),e,t,0,0)}static updateA(e,t,n,r,o){return th(eh(e,r,!0,n.length),e,t,n,o)}static updateB(e,t,n,r,o){return th(eh(e,r,!1,t.length),e,t,n,o)}}function Ku(e,t,n,r){let o=n.lineAt(e),i=r.lineAt(t);return o.to==e&&i.to==t&&e<n.length&&t<r.length?[e+1,t+1]:[o.from,i.from]}function Xu(e,t,n,r){let o=n.lineAt(e),i=r.lineAt(t);return o.from==e&&i.from==t?[e,t]:[o.to+1,i.to+1]}function Zu(e,t,n,r,o){let i=[];for(let a=0;a<e.length;a++){let s=e[a],[l,c]=Ku(s.fromA+r,s.fromB+o,t,n),[d,u]=Xu(s.toA+r,s.toB+o,t,n),h=[s.offset(-l+r,-c+o)];for(;a<e.length-1;){let i=e[a+1],[s,f]=Ku(i.fromA+r,i.fromB+o,t,n);if(s>d+1&&f>u+1)break;h.push(i.offset(-l+r,-c+o)),[d,u]=Xu(i.toA+r,i.toB+o,t,n),a++}i.push(new qu(h,l,Math.max(l,d),c,Math.max(c,u)))}return i}const Ju=1e3;function Qu(e,t,n,r){let o=0,i=e.length;for(;;){if(o==i){let r=0,i=0;o&&({toA:r,toB:i}=e[o-1]);let a=t-(n?r:i);return[r+a,i+a]}let a=o+i>>1,s=e[a],[l,c]=n?[s.fromA,s.toA]:[s.fromB,s.toB];if(l>t)i=a;else{if(!(c<=t))return r?[s.fromA,s.fromB]:[s.toA,s.toB];o=a+1}}}function eh(e,t,n,r){let o=[];return t.iterChangedRanges(((i,a,s,l)=>{let c=0,d=n?t.length:r,u=0,h=n?r:t.length;i>Ju&&([c,u]=Qu(e,i-Ju,n,!0)),a<t.length-Ju&&([d,h]=Qu(e,a+Ju,n,!1));let f,p=l-s-(a-i),[g,m]=n?[p,0]:[0,p];o.length&&(f=o[o.length-1]).toA>=c?o[o.length-1]={fromA:f.fromA,fromB:f.fromB,toA:d,toB:h,diffA:f.diffA+g,diffB:f.diffB+m}:o.push({fromA:c,toA:d,fromB:u,toB:h,diffA:g,diffB:m})})),o}function th(e,t,n,r,o){if(!e.length)return t;let i=0,a=0,s=0,l=[];for(let c of e){let e=c.fromA+a,d=c.toA+a+c.diffA,u=c.fromB+s,h=c.toB+s+c.diffB;for(;i<t.length;){let n=t[i];if(n.toA+a<=e&&n.toB+s<=u)l.push(n.offset(a,s));else if(n.fromA+a>d)break;i++}for(let t of Zu(Wu(n.sliceString(e,d),r.sliceString(u,h),o),n,r,e,u))l.push(t);for(a+=c.diffA,s+=c.diffB;i<t.length;){let e=t[i];if(e.fromA>d+a&&e.fromB>h+s)break;i++}}for(;i<t.length;)l.push(t[i++].offset(a,s));return l}const nh=St.fromClass(class{constructor(e){({deco:this.deco,gutter:this.gutter}=dh(e))}update(e){var t,n;(e.docChanged||e.viewportChanged||(t=e.startState,n=e.state,t.field(Gu,!1)!=n.field(Gu,!1))||function(e,t){return e.facet(Uu)!=t.facet(Uu)}(e.startState,e.state))&&({deco:this.deco,gutter:this.gutter}=dh(e.view))}},{decorations:e=>e.deco}),rh=hn.low(_r({class:"cm-changeGutter",markers:e=>{var t;return(null===(t=e.plugin(nh))||void 0===t?void 0:t.gutter)||Rr.empty}}));const oh=Ct.line({class:"cm-changedLine"}),ih=Ct.mark({class:"cm-changedText"}),ah=Ct.mark({tagName:"ins",class:"cm-insertedLine"}),sh=Ct.mark({tagName:"del",class:"cm-deletedLine"}),lh=new class extends Br{constructor(){super(...arguments),this.elementClass="cm-changedLineGutter"}};function ch(e,t,n,r,o,i){let a=n?e.fromA:e.fromB,s=n?e.toA:e.toB,l=0;if(a!=s){o.add(a,a,oh),o.add(a,s,n?sh:ah),i&&i.add(a,a,lh);for(let c=t.iterRange(a,s-1),d=a;!c.next().done;){if(c.lineBreak){d++,o.add(d,d,oh),i&&i.add(d,d,lh);continue}let t=d+c.value.length;if(r)for(;l<e.changes.length;){let r=e.changes[l],i=a+(n?r.fromA:r.fromB),s=a+(n?r.toA:r.toB),c=Math.max(d,i),u=Math.min(t,s);if(c<u&&o.add(c,u,ih),!(s<t))break;l++}d=t}}}function dh(e){let t=e.state.field(Gu),{side:n,highlightChanges:r,markGutter:o}=e.state.facet(Uu),i="a"==n,a=new Nt,s=o?new Nt:null,{from:l,to:c}=e.viewport;for(let d of t){if((i?d.fromA:d.fromB)>=c)break;(i?d.toA:d.toB)>l&&ch(d,e.state.doc,i,r,a,s)}return{deco:a.finish(),gutter:s&&s.finish()}}class uh extends pn{constructor(e){super(),this.height=e}eq(e){return this.height==e.height}toDOM(){let e=document.createElement("div");return e.className="cm-mergeSpacer",e.style.height=this.height+"px",e}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}const hh=kt.define({map:(e,t)=>e.map(t)}),fh=Et.define({create:()=>Ct.none,update:(e,t)=>{for(let n of t.effects)if(n.is(hh))return n.value;return e.map(t.changes)},provide:e=>wt.decorations.from(e)}),ph=.01;const gh=kt.define({map:(e,t)=>t.mapPos(e)});class mh extends pn{constructor(e){super(),this.lines=e}eq(e){return this.lines==e.lines}toDOM(e){let t=document.createElement("div");return t.className="cm-collapsedLines",t.textContent="⦚ "+e.state.phrase("$ unchanged lines",this.lines)+" ⦚",t.addEventListener("click",(t=>{let n=e.posAtDOM(t.target);e.dispatch({effects:gh.of(n)});let{side:r,sibling:o}=e.state.facet(Uu);o&&o().dispatch({effects:gh.of(vh(n,e.state.field(Gu),"a"==r))})})),t}ignoreEvent(e){return e instanceof MouseEvent}get estimatedHeight(){return 27}}function vh(e,t,n){let r=0,o=0;for(let i=0;;i++){let a=i<t.length?t[i]:null;if(!a||(n?a.fromA:a.fromB)>=e)return o+(e-r);[r,o]=n?[a.toA,a.toB]:[a.toB,a.toA]}}const yh=Et.define({create:e=>Ct.none,update(e,t){e=e.map(t.changes);for(let n of t.effects)n.is(gh)&&(e=e.update({filter:e=>e!=n.value}));return e},provide:e=>wt.decorations.from(e)});function xh({margin:e=3,minSize:t=4}){return yh.init((n=>function(e,t,n){let r=new Nt,o="a"==e.facet(Uu).side,i=e.field(Gu),a=1;for(let s=0;;s++){let l=s<i.length?i[s]:null,c=s?a+t:1,d=l?e.doc.lineAt(o?l.fromA:l.fromB).number-1-t:e.doc.lines,u=d-c+1;if(u>=n&&r.add(e.doc.line(c).from,e.doc.line(d).to,Ct.replace({widget:new mh(u),block:!0})),!l)break;a=e.doc.lineAt(Math.min(e.doc.length,o?l.toA:l.toB)).number}return r.finish()}(n,e,t)))}const bh=wt.styleModule.of(new zr({".cm-mergeView":{overflowY:"auto"},".cm-mergeViewEditors":{display:"flex",alignItems:"stretch"},".cm-mergeViewEditor":{flexGrow:1,flexBasis:0,overflow:"hidden"},".cm-merge-revert":{width:"1.6em",flexGrow:0,flexShrink:0,position:"relative"},".cm-merge-revert button":{position:"absolute",display:"block",width:"100%",boxSizing:"border-box",textAlign:"center",background:"none",border:"none",font:"inherit",cursor:"pointer"}})),wh=wt.baseTheme({".cm-mergeView & .cm-scroller, .cm-mergeView &":{height:"auto !important",overflowY:"visible !important"},"&.cm-merge-a .cm-changedLine, .cm-deletedChunk":{backgroundColor:"rgba(160, 128, 100, .08)"},"&.cm-merge-b .cm-changedLine":{backgroundColor:"rgba(100, 160, 128, .08)"},"&light.cm-merge-a .cm-changedText, &light .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ee443366, #ee443366) bottom/100% 2px no-repeat"},"&dark.cm-merge-a .cm-changedText, &dark .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ffaa9966, #ffaa9966) bottom/100% 2px no-repeat"},"&light.cm-merge-b .cm-changedText":{background:"linear-gradient(#22bb2266, #22bb2266) bottom/100% 2px no-repeat"},"&dark.cm-merge-b .cm-changedText":{background:"linear-gradient(#88ff8866, #88ff8866) bottom/100% 2px no-repeat"},".cm-insertedLine, .cm-deletedLine":{textDecoration:"none"},".cm-deletedChunk":{paddingLeft:"6px","& .cm-chunkButtons":{position:"absolute",insetInlineEnd:"5px"},"& button":{border:"none",cursor:"pointer",color:"white",margin:"0 2px",borderRadius:"3px","&[name=accept]":{background:"#2a2"},"&[name=reject]":{background:"#d43"}}},".cm-collapsedLines":{padding:"5px 5px 5px 10px",cursor:"pointer"},"&light .cm-collapsedLines":{color:"#444",background:"linear-gradient(to bottom, transparent 0, #f3f3f3 30%, #f3f3f3 70%, transparent 100%)"},"&dark .cm-collapsedLines":{color:"#ddd",background:"linear-gradient(to bottom, transparent 0, #222 30%, #222 70%, transparent 100%)"},".cm-changeGutter":{width:"3px",paddingLeft:"1px"},"&light.cm-merge-a .cm-changedLineGutter, &light .cm-deletedLineGutter":{background:"#e43"},"&dark.cm-merge-a .cm-changedLineGutter, &dark .cm-deletedLineGutter":{background:"#fa9"},"&light.cm-merge-b .cm-changedLineGutter":{background:"#2b2"},"&dark.cm-merge-b .cm-changedLineGutter":{background:"#8f8"}}),kh=new Lr,Eh=new Lr;class Ch{constructor(e){this.revertDOM=null,this.revertToA=!1,this.revertToLeft=!1,this.measuring=-1,this.diffConf=e.diffConfig;let t=[hn.low(nh),wh,bh,fh,wt.updateListener.of((e=>{this.measuring<0&&(e.heightChanged||e.viewportChanged)&&!e.transactions.some((e=>e.effects.some((e=>e.is(hh)))))&&this.measure()}))],n=[Uu.of({side:"a",sibling:()=>this.b,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&n.push(rh);let r=Bn.create({doc:e.a.doc,selection:e.a.selection,extensions:[e.a.extensions||[],wt.editorAttributes.of({class:"cm-merge-a"}),Eh.of(n),t]}),o=[Uu.of({side:"b",sibling:()=>this.a,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&o.push(rh);let i=Bn.create({doc:e.b.doc,selection:e.b.selection,extensions:[e.b.extensions||[],wt.editorAttributes.of({class:"cm-merge-b"}),Eh.of(o),t]});this.chunks=qu.build(r.doc,i.doc,this.diffConf);let a=[Gu.init((()=>this.chunks)),kh.of(e.collapseUnchanged?xh(e.collapseUnchanged):[])];r=r.update({effects:kt.appendConfig.of(a)}).state,i=i.update({effects:kt.appendConfig.of(a)}).state,this.dom=document.createElement("div"),this.dom.className="cm-mergeView",this.editorDOM=this.dom.appendChild(document.createElement("div")),this.editorDOM.className="cm-mergeViewEditors";let s=e.orientation||"a-b",l=document.createElement("div");l.className="cm-mergeViewEditor";let c=document.createElement("div");c.className="cm-mergeViewEditor",this.editorDOM.appendChild("a-b"==s?l:c),this.editorDOM.appendChild("a-b"==s?c:l),this.a=new wt({state:r,parent:l,root:e.root,dispatchTransactions:e=>this.dispatch(e,this.a)}),this.b=new wt({state:i,parent:c,root:e.root,dispatchTransactions:e=>this.dispatch(e,this.b)}),this.setupRevertControls(!!e.revertControls,"b-to-a"==e.revertControls,e.renderRevertControl),e.parent&&e.parent.appendChild(this.dom),this.scheduleMeasure()}dispatch(e,t){if(e.some((e=>e.docChanged))){let n=e[e.length-1],r=e.reduce(((e,t)=>e.compose(t.changes)),Pr.empty(e[0].startState.doc.length));this.chunks=t==this.a?qu.updateA(this.chunks,n.newDoc,this.b.state.doc,r,this.diffConf):qu.updateB(this.chunks,this.a.state.doc,n.newDoc,r,this.diffConf),t.update([...e,n.state.update({effects:Yu.of(this.chunks)})]);let o=t==this.a?this.b:this.a;o.update([o.state.update({effects:Yu.of(this.chunks)})]),this.scheduleMeasure()}else t.update(e)}reconfigure(e){if("diffConfig"in e&&(this.diffConf=e.diffConfig),"orientation"in e){let t="b-a"!=e.orientation;if(t!=(this.editorDOM.firstChild==this.a.dom.parentNode)){let e=this.a.dom.parentNode,n=this.b.dom.parentNode;e.remove(),n.remove(),this.editorDOM.insertBefore(t?e:n,this.editorDOM.firstChild),this.editorDOM.appendChild(t?n:e),this.revertToLeft=!this.revertToLeft,this.revertDOM&&(this.revertDOM.textContent="")}}if("revertControls"in e||"renderRevertControl"in e){let t=!!this.revertDOM,n=this.revertToA,r=this.renderRevert;"revertControls"in e&&(t=!!e.revertControls,n="b-to-a"==e.revertControls),"renderRevertControl"in e&&(r=e.renderRevertControl),this.setupRevertControls(t,n,r)}let t="highlightChanges"in e,n="gutter"in e,r="collapseUnchanged"in e;if(t||n||r){let o=[],i=[];if(t||n){let r=this.a.state.facet(Uu),a=n?!1!==e.gutter:r.markGutter,s=t?!1!==e.highlightChanges:r.highlightChanges;o.push(Eh.reconfigure([Uu.of({side:"a",sibling:()=>this.b,highlightChanges:s,markGutter:a}),a?rh:[]])),i.push(Eh.reconfigure([Uu.of({side:"b",sibling:()=>this.a,highlightChanges:s,markGutter:a}),a?rh:[]]))}if(r){let t=kh.reconfigure(e.collapseUnchanged?xh(e.collapseUnchanged):[]);o.push(t),i.push(t)}this.a.dispatch({effects:o}),this.b.dispatch({effects:i})}this.scheduleMeasure()}setupRevertControls(e,t,n){this.revertToA=t,this.revertToLeft=this.revertToA==(this.editorDOM.firstChild==this.a.dom.parentNode),this.renderRevert=n,!e&&this.revertDOM?(this.revertDOM.remove(),this.revertDOM=null):e&&!this.revertDOM?(this.revertDOM=this.editorDOM.insertBefore(document.createElement("div"),this.editorDOM.firstChild.nextSibling),this.revertDOM.addEventListener("mousedown",(e=>this.revertClicked(e))),this.revertDOM.className="cm-merge-revert"):this.revertDOM&&(this.revertDOM.textContent="")}scheduleMeasure(){if(this.measuring<0){let e=this.dom.ownerDocument.defaultView||window;this.measuring=e.requestAnimationFrame((()=>{this.measuring=-1,this.measure()}))}}measure(){!function(e,t,n){let r=new Nt,o=new Nt,i=e.state.field(fh).iter(),a=t.state.field(fh).iter(),s=0,l=0,c=0,d=0;for(let p=0;;p++){let u=p<n.length?n[p]:null;if(s<(u?u.fromA:e.state.doc.length)){let n=e.lineBlockAt(s).top+c-(t.lineBlockAt(l).top+d);n<-.01?(c-=n,r.add(s,s,Ct.widget({widget:new uh(-n),block:!0,side:-1}))):n>ph&&(d+=n,o.add(l,l,Ct.widget({widget:new uh(n),block:!0,side:-1})))}if(!u)break;for(s=u.toA,l=u.toB;i.value&&i.from<s;)c-=i.value.spec.widget.height,i.next();for(;a.value&&a.from<l;)d-=a.value.spec.widget.height,a.next()}for(;i.value;)c-=i.value.spec.widget.height,i.next();for(;a.value;)d-=a.value.spec.widget.height,a.next();let u=e.contentHeight+c-(t.contentHeight+d);u<ph?r.add(e.state.doc.length,e.state.doc.length,Ct.widget({widget:new uh(-u),block:!0,side:1})):u>ph&&o.add(t.state.doc.length,t.state.doc.length,Ct.widget({widget:new uh(u),block:!0,side:1}));let h=r.finish(),f=o.finish();Rr.eq([h],[e.state.field(fh)])||e.dispatch({effects:hh.of(h)}),Rr.eq([f],[t.state.field(fh)])||t.dispatch({effects:hh.of(f)})}(this.a,this.b,this.chunks),this.revertDOM&&this.updateRevertButtons()}updateRevertButtons(){let e=this.revertDOM,t=e.firstChild,n=this.a.viewport,r=this.b.viewport;for(let o=0;o<this.chunks.length;o++){let i=this.chunks[o];if(i.fromA>n.to||i.fromB>r.to)break;if(i.fromA<n.from||i.fromB<r.from)continue;let a=this.a.lineBlockAt(i.fromA).top+"px";for(;t&&+t.dataset.chunk<o;)t=Sh(t);t&&t.dataset.chunk==String(o)?(t.style.top!=a&&(t.style.top=a),t=t.nextSibling):e.insertBefore(this.renderRevertButton(a,o),t)}for(;t;)t=Sh(t)}renderRevertButton(e,t){let n;if(this.renderRevert)n=this.renderRevert();else{n=document.createElement("button");let e=this.a.state.phrase("Revert this chunk");n.setAttribute("aria-label",e),n.setAttribute("title",e),n.textContent=this.revertToLeft?"⇜":"⇝"}return n.style.top=e,n.setAttribute("data-chunk",String(t)),n}revertClicked(e){let t,n=e.target;for(;n&&n.parentNode!=this.revertDOM;)n=n.parentNode;if(n&&(t=this.chunks[n.dataset.chunk])){let[n,r,o,i,a,s]=this.revertToA?[this.b,this.a,t.fromB,t.toB,t.fromA,t.toA]:[this.a,this.b,t.fromA,t.toA,t.fromB,t.toB],l=n.state.sliceDoc(o,Math.max(o,i-1));o!=i&&s<=r.state.doc.length&&(l+=n.state.lineBreak),r.dispatch({changes:{from:a,to:Math.min(r.state.doc.length,s),insert:l},userEvent:"revert"}),e.preventDefault()}}destroy(){this.a.destroy(),this.b.destroy(),this.measuring>-1&&(this.dom.ownerDocument.defaultView||window).cancelAnimationFrame(this.measuring),this.dom.remove()}}function Sh(e){let t=e.nextSibling;return e.remove(),t}var Nh=["className","children","orientation","revertControls","highlightChanges","gutter","collapseUnchanged","destroyRerender","renderRevertControl"],jh=["modified","modifiedExtension","original","originalExtension","theme","dispatch"],Ih=s.forwardRef(((e,t)=>{var{className:n,children:r,orientation:i,revertControls:a,highlightChanges:s,gutter:l,collapseUnchanged:c,destroyRerender:d=!0,renderRevertControl:u}=e,h=Dr(e,Nh),f=fu(),{modified:p,modifiedExtension:g,original:m,originalExtension:v,theme:y,dispatch:b}=f,w=Dr(f,jh),k=o.useRef(null),E=o.useRef(),C={orientation:i,revertControls:a,highlightChanges:s,gutter:l,collapseUnchanged:c,renderRevertControl:u};o.useImperativeHandle(t,(()=>({container:k.current,view:E.current,modified:p,original:m,config:ir({a:m,b:p,parent:k.current},C)})),[k,E,p,m,C]),o.useEffect((()=>{!E.current&&k.current&&(E.current=new Ch(ir({a:ir({},m,{extensions:[...(null==v?void 0:v.extension)||[],...Tr(ir({},null==v?void 0:v.option,{theme:y}))]}),b:ir({},p,{extensions:[...(null==g?void 0:g.extension)||[],...Tr(ir({},null==g?void 0:g.option,{theme:y}))]}),parent:k.current},C)))}),[E,k]),o.useEffect((()=>{if(m&&m.doc&&E.current){var e,t,n=null==(e=E.current)?void 0:e.a.state.doc.toString();if(n!==m.doc)null==(t=E.current)||t.a.dispatch({changes:{from:0,to:n.length,insert:m.doc||""}})}if(p&&p.doc&&E.current){var r,o,i=null==(r=E.current)?void 0:r.b.state.doc.toString();if(i!==p.doc)null==(o=E.current)||o.b.dispatch({changes:{from:0,to:i.length,insert:p.doc||""}})}if(d&&E.current){var a=E.current.a.state.selection.ranges[0].from,s=E.current.b.state.selection.ranges[0].from;E.current.destroy(),E.current=new Ch(ir({a:ir({},m,{extensions:[...(null==v?void 0:v.extension)||[],...Tr(ir({},null==v?void 0:v.option,{theme:y}))]}),b:ir({},p,{extensions:[...(null==g?void 0:g.extension)||[],...Tr(ir({},null==g?void 0:g.option,{theme:y}))]}),parent:k.current},C)),a&&(E.current.a.focus(),E.current.a.dispatch({selection:{anchor:a,head:a}})),s&&(E.current.b.focus(),E.current.b.dispatch({selection:{anchor:s,head:s}}))}}),[E,y,k.current,m,p,v,g,d]),o.useEffect((()=>()=>E.current&&E.current.destroy()),[]),o.useEffect((()=>{if(E.current){var e={};w.orientation!==i&&(e.orientation=i),w.revertControls!==a&&(e.revertControls=a),w.highlightChanges!==s&&(e.highlightChanges=s),w.gutter!==l&&(e.gutter=l),w.collapseUnchanged!==c&&(e.collapseUnchanged=c),w.renderRevertControl!==u&&(e.collapseUnchanged=c),Object.keys(e).length&&b&&E.current&&(E.current.reconfigure(ir({},e)),b(ir({},e)))}}),[b,E,i,a,s,l,c,u]);return x.jsx("div",ir({ref:k,className:"cm-merge-theme"+(n?" "+n:"")},h,{children:r}))}));Ih.displayName="CodeMirrorMerge.Internal";var Oh=["theme"],Mh=s.forwardRef(((e,t)=>{var{theme:n}=e,r=Dr(e,Oh);return x.jsx(pu,{theme:n,children:x.jsx(Ih,ir({},r,{ref:t}))})}));Mh.Original=mu,Mh.Modified=yu,Mh.displayName="CodeMirrorMerge";const Dh=()=>{},Th=Dh(),Ph=Object,Ah=e=>e===Th,_h=e=>"function"==typeof e,Rh=(e,t)=>({...e,...t}),zh=new WeakMap;let Lh=0;const Bh=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let o,i;if(Ph(e)!==e||r||n==RegExp)o=r?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(o=zh.get(e),o)return o;if(o=++Lh+"~",zh.set(e,o),n==Array){for(o="@",i=0;i<e.length;i++)o+=Bh(e[i])+",";zh.set(e,o)}if(n==Ph){o="#";const t=Ph.keys(e).sort();for(;!Ah(i=t.pop());)Ah(e[i])||(o+=i+":"+Bh(e[i])+",");zh.set(e,o)}}return o},Fh=new WeakMap,Hh={},Vh={},$h="undefined",Wh=typeof window!=$h,Uh=typeof document!=$h,Yh=(e,t)=>{const n=Fh.get(e);return[()=>!Ah(t)&&e.get(t)||Hh,r=>{if(!Ah(t)){const o=e.get(t);t in Vh||(Vh[t]=o),n[5](t,Rh(o,r),o||Hh)}},n[6],()=>!Ah(t)&&t in Vh?Vh[t]:!Ah(t)&&e.get(t)||Hh]};let Gh=!0;const[qh,Kh]=Wh&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Dh,Dh],Xh={isOnline:()=>Gh,isVisible:()=>{const e=Uh&&document.visibilityState;return Ah(e)||"hidden"!==e}},Zh={initFocus:e=>(Uh&&document.addEventListener("visibilitychange",e),qh("focus",e),()=>{Uh&&document.removeEventListener("visibilitychange",e),Kh("focus",e)}),initReconnect:e=>{const t=()=>{Gh=!0,e()},n=()=>{Gh=!1};return qh("online",t),qh("offline",n),()=>{Kh("online",t),Kh("offline",n)}}},Jh=!s.useId,Qh=!Wh||"Deno"in window,ef=e=>Wh&&typeof window.requestAnimationFrame!=$h?window.requestAnimationFrame(e):setTimeout(e,1),tf=Qh?o.useEffect:o.useLayoutEffect,nf="undefined"!=typeof navigator&&navigator.connection,rf=!Qh&&nf&&(["slow-2g","2g"].includes(nf.effectiveType)||nf.saveData),of=e=>{if(_h(e))try{e=e()}catch(n){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?Bh(e):"",t]};let af=0;const sf=()=>++af;var lf=3,cf=0,df=2,uf=1;async function hf(...e){const[t,n,r,o]=e,i=Rh({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{});let a=i.populateCache;const s=i.rollbackOnError;let l=i.optimisticData;const c=!1!==i.revalidate,d=i.throwOnError;if(_h(n)){const e=n,r=[],o=t.keys();for(const n of o)!/^\$(inf|sub)\$/.test(n)&&e(t.get(n)._k)&&r.push(n);return Promise.all(r.map(u))}return u(n);async function u(n){const[o]=of(n);if(!o)return;const[i,u]=Yh(t,o),[h,f,p,g]=Fh.get(t),m=h[o],v=()=>c&&(delete p[o],delete g[o],m&&m[0])?m[0](2).then((()=>i().data)):i().data;if(e.length<3)return v();let y,x=r;const b=sf();f[o]=[b,0];const w=!Ah(l),k=i(),E=k.data,C=k._c,S=Ah(C)?E:C;if(w&&(l=_h(l)?l(S,E):l,u({data:l,_c:S})),_h(x))try{x=x(S)}catch(j){y=j}if(x&&_h(x.then)){if(x=await x.catch((e=>{y=e})),b!==f[o][0]){if(y)throw y;return x}y&&w&&(e=>"function"==typeof s?s(e):!1!==s)(y)&&(a=!0,x=S,u({data:x,_c:Th}))}a&&(y||(_h(a)&&(x=a(x,S)),u({data:x,error:Th,_c:Th}))),f[o][1]=sf();const N=await v();if(u({_c:Th}),!y)return a?N:x;if(d)throw y}}const ff=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},[pf,gf]=((e,t)=>{if(!Fh.has(e)){const n=Rh(Zh,t),r={},o=hf.bind(Th,e);let i=Dh;const a={},s=(e,t)=>{const n=a[e]||[];return a[e]=n,n.push(t),()=>n.splice(n.indexOf(t),1)},l=(t,n,r)=>{e.set(t,n);const o=a[t];if(o)for(const e of o)e(n,r)},c=()=>{if(!Fh.has(e)&&(Fh.set(e,[r,{},{},{},o,l,s]),!Qh)){const t=n.initFocus(setTimeout.bind(Th,ff.bind(Th,r,0))),o=n.initReconnect(setTimeout.bind(Th,ff.bind(Th,r,1)));i=()=>{t&&t(),o&&o(),Fh.delete(e)}}};return c(),[e,o,c,i]}return[e,Fh.get(e)[4]]})(new Map),mf=Rh({onLoadingSlow:Dh,onSuccess:Dh,onError:Dh,onErrorRetry:(e,t,n,r,o)=>{const i=n.errorRetryCount,a=o.retryCount,s=~~((Math.random()+.5)*(1<<(a<8?a:8)))*n.errorRetryInterval;!Ah(i)&&a>i||setTimeout(r,s,o)},onDiscarded:Dh,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:rf?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:rf?5e3:3e3,compare:(e,t)=>Bh(e)==Bh(t),isPaused:()=>!1,cache:pf,mutate:gf,fallback:{}},Xh),vf=o.createContext({}),yf=Wh&&window.__SWR_DEVTOOLS_USE__,xf=yf?window.__SWR_DEVTOOLS_USE__:[],bf=xf.concat((e=>(t,n,r)=>e(t,n&&((...e)=>{const[r]=of(t),[,,,o]=Fh.get(pf),i=o[r];return Ah(i)?n(...e):(delete o[r],i)}),r)));yf&&(window.__SWR_DEVTOOLS_REACT__=s);const wf=s.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),kf={dedupe:!0},Ef=(Cf=(e,t,n)=>{const{cache:r,compare:i,suspense:a,fallbackData:s,revalidateOnMount:l,revalidateIfStale:c,refreshInterval:d,refreshWhenHidden:u,refreshWhenOffline:h,keepPreviousData:f}=n,[p,g,m,v]=Fh.get(r),[y,x]=of(e),b=o.useRef(!1),w=o.useRef(!1),k=o.useRef(y),E=o.useRef(t),C=o.useRef(n),S=()=>C.current,N=()=>S().isVisible()&&S().isOnline(),[j,I,O,M]=Yh(r,y),D=o.useRef({}).current,T=Ah(s)?n.fallback[y]:s,P=(e,t)=>{for(const n in D){const r=n;if("data"===r){if(!i(e[r],t[r])){if(!Ah(e[r]))return!1;if(!i(V,t[r]))return!1}}else if(t[r]!==e[r])return!1}return!0},A=o.useMemo((()=>{const e=!!y&&!!t&&(Ah(l)?!S().isPaused()&&!a&&(!!Ah(c)||c):l),n=t=>{const n=Rh(t);return delete n._k,e?{isValidating:!0,isLoading:!0,...n}:n},r=j(),o=M(),i=n(r),s=r===o?i:n(o);let d=i;return[()=>{const e=n(j());return P(e,d)?(d.data=e.data,d.isLoading=e.isLoading,d.isValidating=e.isValidating,d.error=e.error,d):(d=e,e)},()=>s]}),[r,y]),_=Fr.useSyncExternalStore(o.useCallback((e=>O(y,((t,n)=>{P(n,t)||e()}))),[r,y]),A[0],A[1]),R=!b.current,z=p[y]&&p[y].length>0,L=_.data,B=Ah(L)?T:L,F=_.error,H=o.useRef(B),V=f?Ah(L)?H.current:L:B,$=!(z&&!Ah(F))&&(R&&!Ah(l)?l:!S().isPaused()&&(a?!Ah(B)&&c:Ah(B)||c)),W=!!(y&&t&&R&&$),U=Ah(_.isValidating)?W:_.isValidating,Y=Ah(_.isLoading)?W:_.isLoading,G=o.useCallback((async e=>{const t=E.current;if(!y||!t||w.current||S().isPaused())return!1;let r,o,a=!0;const s=e||{},l=!m[y]||!s.dedupe,c=()=>Jh?!w.current&&y===k.current&&b.current:y===k.current,d={isValidating:!1,isLoading:!1},u=()=>{I(d)},h=()=>{const e=m[y];e&&e[1]===o&&delete m[y]},f={isValidating:!0};Ah(j().data)&&(f.isLoading=!0);try{if(l&&(I(f),n.loadingTimeout&&Ah(j().data)&&setTimeout((()=>{a&&c()&&S().onLoadingSlow(y,n)}),n.loadingTimeout),m[y]=[t(x),sf()]),[r,o]=m[y],r=await r,l&&setTimeout(h,n.dedupingInterval),!m[y]||m[y][1]!==o)return l&&c()&&S().onDiscarded(y),!1;d.error=Th;const e=g[y];if(!Ah(e)&&(o<=e[0]||o<=e[1]||0===e[1]))return u(),l&&c()&&S().onDiscarded(y),!1;const s=j().data;d.data=i(s,r)?s:r,l&&c()&&S().onSuccess(r,y,n)}catch(v){h();const e=S(),{shouldRetryOnError:t}=e;e.isPaused()||(d.error=v,l&&c()&&(e.onError(v,y,e),(!0===t||_h(t)&&t(v))&&N()&&e.onErrorRetry(v,y,e,(e=>{const t=p[y];t&&t[0]&&t[0](lf,e)}),{retryCount:(s.retryCount||0)+1,dedupe:!0})))}return a=!1,u(),!0}),[y,r]),q=o.useCallback(((...e)=>hf(r,k.current,...e)),[]);if(tf((()=>{E.current=t,C.current=n,Ah(L)||(H.current=L)})),tf((()=>{if(!y)return;const e=G.bind(Th,kf);let t=0;const n=((e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const e=r.indexOf(n);e>=0&&(r[e]=r[r.length-1],r.pop())}})(y,p,((n,r={})=>{if(n==cf){const n=Date.now();S().revalidateOnFocus&&n>t&&N()&&(t=n+S().focusThrottleInterval,e())}else if(n==uf)S().revalidateOnReconnect&&N()&&e();else{if(n==df)return G();if(n==lf)return G(r)}}));return w.current=!1,k.current=y,b.current=!0,I({_k:x}),$&&(Ah(B)||Qh?e():ef(e)),()=>{w.current=!0,n()}}),[y]),tf((()=>{let e;function t(){const t=_h(d)?d(j().data):d;t&&-1!==e&&(e=setTimeout(n,t))}function n(){j().error||!u&&!S().isVisible()||!h&&!S().isOnline()?t():G(kf).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[d,u,h,y]),o.useDebugValue(V),a&&Ah(B)&&y){if(!Jh&&Qh)throw new Error("Fallback data is required when using suspense in SSR.");E.current=t,C.current=n,w.current=!1;const e=v[y];if(!Ah(e)){const t=q(e);wf(t)}if(!Ah(F))throw F;{const e=G(kf);Ah(V)||(e.status="fulfilled",e.value=!0),wf(e)}}return{mutate:q,get data(){return D.data=!0,V},get error(){return D.error=!0,F},get isValidating(){return D.isValidating=!0,U},get isLoading(){return D.isLoading=!0,Y}}},function(...e){const t=Rh(mf,o.useContext(vf)),[n,r,i]=(e=>_h(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(e),a=((e,t)=>{const n=Rh(e,t);if(t){const{use:r,fallback:o}=e,{use:i,fallback:a}=t;r&&i&&(n.use=r.concat(i)),o&&a&&(n.fallback=Rh(o,a))}return n})(t,i);let s=Cf;const{use:l}=a,c=(l||[]).concat(bf);for(let o=c.length;o--;)s=c[o](s);return s(n,r||a.fetcher||null,a)});var Cf,Sf={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Nf={code:"1",name:"function_call",parse:e=>{if(null==e||"object"!=typeof e||!("function_call"in e)||"object"!=typeof e.function_call||null==e.function_call||!("name"in e.function_call)||!("arguments"in e.function_call)||"string"!=typeof e.function_call.name||"string"!=typeof e.function_call.arguments)throw new Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:e}}},jf={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},If={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Of={code:"4",name:"assistant_message",parse:e=>{if(!(null!=e&&"object"==typeof e&&"id"in e&&"role"in e&&"content"in e&&"string"==typeof e.id&&"string"==typeof e.role&&"assistant"===e.role&&Array.isArray(e.content)&&e.content.every((e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Mf={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Df={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Tf={code:"7",name:"tool_calls",parse:e=>{if(null==e||"object"!=typeof e||!("tool_calls"in e)||"object"!=typeof e.tool_calls||null==e.tool_calls||!Array.isArray(e.tool_calls)||e.tool_calls.some((e=>!(null!=e&&"object"==typeof e&&"id"in e&&"string"==typeof e.id&&"type"in e&&"string"==typeof e.type&&"function"in e&&null!=e.function&&"object"==typeof e.function&&"arguments"in e.function&&"string"==typeof e.function.name&&"string"==typeof e.function.arguments))))throw new Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:e}}},Pf={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Af=[Sf,Nf,jf,If,Of,Mf,Df,Tf,Pf],_f={[Sf.code]:Sf,[Nf.code]:Nf,[jf.code]:jf,[If.code]:If,[Of.code]:Of,[Mf.code]:Mf,[Df.code]:Df,[Tf.code]:Tf,[Pf.code]:Pf},Rf=Af.map((e=>e.code)),zf=e=>{const t=e.indexOf(":");if(-1===t)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!Rf.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const r=n,o=e.slice(t+1),i=JSON.parse(o);return _f[r].parse(i)},Lf="\n".charCodeAt(0);function Bf(e,t){const n=new Uint8Array(t);let r=0;for(const o of e)n.set(o,r),r+=o.length;return e.length=0,n}async function Ff({api:e,prompt:t,credentials:n,headers:r,body:o,streamMode:i="stream-data",setCompletion:a,setLoading:s,setError:l,setAbortController:c,onResponse:d,onFinish:u,onError:h,onData:f}){try{s(!0),l(void 0);const h=new AbortController;c(h),a("");const g=await fetch(e,{method:"POST",body:JSON.stringify({prompt:t,...o}),credentials:n,headers:{"Content-Type":"application/json",...r},signal:h.signal}).catch((e=>{throw e}));if(d)try{await d(g)}catch(p){throw p}if(!g.ok)throw new Error(await g.text()||"Failed to fetch the chat response.");if(!g.body)throw new Error("The response body is empty.");let m="";const v=g.body.getReader();switch(i){case"text":{const e=function(e){const t=new TextDecoder;return e?function(e){return t.decode(e,{stream:!0}).split("\n").filter((e=>""!==e)).map(zf).filter(Boolean)}:function(e){return e?t.decode(e,{stream:!0}):""}}();for(;;){const{done:t,value:n}=await v.read();if(t)break;if(m+=e(n),a(m),null===h){v.cancel();break}}break}case"stream-data":for await(const{type:e,value:t}of async function*(e,{isAborted:t}={}){const n=new TextDecoder,r=[];let o=0;for(;;){const{value:i}=await e.read();if(i&&(r.push(i),o+=i.length,i[i.length-1]!==Lf))continue;if(0===r.length)break;const a=Bf(r,o);o=0;const s=n.decode(a,{stream:!0}).split("\n").filter((e=>""!==e)).map(zf);for(const e of s)yield e;if(null==t?void 0:t()){e.cancel();break}}}(v,{isAborted:()=>null===h}))switch(e){case"text":m+=t,a(m);break;case"data":null==f||f(t)}break;default:throw new Error(`Unknown stream mode: ${i}`)}return u&&u(t,m),c(null),m}catch(p){if("AbortError"===p.name)return c(null),null;p instanceof Error&&h&&h(p),l(p)}finally{s(!1)}}function Hf({api:e="/api/completion",id:t,initialCompletion:n="",initialInput:r="",credentials:i,headers:a,body:s,streamMode:l,onResponse:c,onFinish:d,onError:u}={}){const h=o.useId(),f=t||h,{data:p,mutate:g}=Ef([e,f],null,{fallbackData:n}),{data:m=!1,mutate:v}=Ef([f,"loading"],null),{data:y,mutate:x}=Ef([f,"streamData"],null),[b,w]=o.useState(void 0),k=p,[E,C]=o.useState(null),S=o.useRef({credentials:i,headers:a,body:s});o.useEffect((()=>{S.current={credentials:i,headers:a,body:s}}),[i,a,s]);const N=o.useCallback((async(t,n)=>Ff({api:e,prompt:t,credentials:S.current.credentials,headers:{...S.current.headers,...null==n?void 0:n.headers},body:{...S.current.body,...null==n?void 0:n.body},streamMode:l,setCompletion:e=>g(e,!1),setLoading:v,setError:w,setAbortController:C,onResponse:c,onFinish:d,onError:u,onData:e=>{x([...y||[],...e||[]],!1)}})),[g,v,e,S,C,c,d,u,w,y,x]),j=o.useCallback((()=>{E&&(E.abort(),C(null))}),[E]),I=o.useCallback((e=>{g(e,!1)}),[g]),O=o.useCallback((async(e,t)=>N(e,t)),[N]),[M,D]=o.useState(r),T=o.useCallback((e=>{if(e.preventDefault(),M)return O(M)}),[M,O]);return{completion:k,complete:O,error:b,setCompletion:I,stop:j,input:M,setInput:D,handleInputChange:e=>{D(e.target.value)},handleSubmit:T,isLoading:m,data:y}}const Vf=Mh.Original,$f=Mh.Modified,Wf=[Hr(),wt.lineWrapping],Uf=({onChange:e,currentCode:t,declineChange:n,acceptChange:r,enabled:i,children:a})=>{const[l,c]=E(Gl),{completion:d,input:u,stop:h,isLoading:f,setCompletion:p,handleInputChange:g,handleSubmit:m}=Hf({api:"/api/ai/completion",headers:Vr.headers(),streamMode:"text",body:{includeOtherCode:l?na(t):"",code:t},onError:e=>{Q({title:"Completion failed",description:$r(e)})}}),v=s.useRef(null);return o.useEffect((()=>{i&&v.current&&(v.current.focus(),v.current.select())}),[i]),x.jsxs("div",{className:"flex flex-col w-full rounded-[inherit] overflow-hidden",children:[x.jsxs("div",{className:Mt("flex items-center gap-2 border-b px-3 transition-[height] rounded-[inherit] rounded-b-none duration-300 overflow-hidden",i&&"h-10 visible",!i&&"h-0 invisible"),children:[x.jsx(Vs,{className:"text-[var(--blue-10)]",size:16}),x.jsx("input",{className:"h-8 outline-none px-2 focus-visible:shadow-none flex-1 rounded-none border-none focus:border-none",value:u,ref:v,onChange:g,placeholder:"Type for completion",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),m(e)),"Escape"===e.key&&(e.preventDefault(),n(),p(""))}}),f&&x.jsxs(P,{"data-testid":"stop-completion-button",variant:"text",size:"xs",className:"mb-0",onClick:h,children:[x.jsx(Wr,{className:"animate-spin mr-1",size:14}),"Stop"]}),!f&&d&&x.jsx(P,{"data-testid":"accept-completion-button",variant:"text",size:"xs",className:"mb-0",disabled:f,onClick:()=>{r(d),p("")},children:x.jsx("span",{className:"text-[var(--grass-11)] opacity-100",children:"Accept"})}),x.jsx("div",{className:"h-full w-px bg-border mx-2"}),x.jsx(b,{content:"Include code from other cells",children:x.jsxs("div",{className:"flex flex-row items-start gap-1",children:[x.jsx(Ur,{"data-testid":"include-other-cells-checkbox",id:"include-other-cells",checked:l,onCheckedChange:e=>c(Boolean(e))}),x.jsx(ae,{htmlFor:"include-other-cells",className:"text-muted-foreground text-xs",children:"Include all code"})]})}),x.jsx(P,{"data-testid":"decline-completion-button",variant:"text",size:"icon",disabled:f,onClick:()=>{h(),n(),p("")},children:x.jsx(jt,{className:"text-[var(--red-10)]",size:16})})]}),d&&i&&x.jsxs(Mh,{className:"cm",children:[x.jsx(Vf,{onChange:e,value:t,extensions:Wf}),x.jsx($f,{value:d,editable:!1,readOnly:!0,extensions:Wf})]}),(!d||!i)&&a]})},Yf=s.forwardRef(((e,t)=>{const{className:n,editorView:r}=e,i=o.useRef(null);return o.useEffect((()=>{null!==r&&null!==i.current&&0===i.current.children.length&&i.current.append(r.dom)}),[r,i]),x.jsx("div",{className:Mt("cm",n),ref:Dd(t,i),"data-testid":"cell-editor"})}));Yf.displayName="CellCodeMirrorEditor";const Gf=o.memo((({theme:e,showPlaceholder:t,allowFocus:n,id:r,code:i,status:a,serializedEditorState:s,runCell:l,updateCellCode:c,createNewCell:f,deleteCell:p,focusCell:g,moveCell:m,moveToNextCell:v,updateCellConfig:y,clearSerializedEditorState:b,userConfig:w,editorViewRef:k,hidden:C})=>{var S;const[N,j]=o.useState((()=>Yr.markdown().isSupported(i))),[I,O]=E(Yl),[M,D]=o.useState(),T=u(Jl),P=o.useRef(null),A="running"===a||"queued"===a,{splitCell:_,sendToTop:R,sendToBottom:z}=X(),L=h((()=>!A&&(p({cellId:r}),!0))),B=o.useCallback((()=>f({cellId:r,before:!1})),[r,f]),F=o.useCallback((()=>f({cellId:r,before:!0})),[r,f]),H=o.useCallback((()=>m({cellId:r,before:!1})),[r,m]),V=o.useCallback((()=>m({cellId:r,before:!0})),[r,m]),$=o.useCallback((()=>g({cellId:r,before:!1})),[r,g]),W=o.useCallback((()=>g({cellId:r,before:!0})),[r,g]),U=h((()=>{const e={hide_code:!C};return xe({configs:{[r]:e}}),y({cellId:r,config:e}),e.hide_code||!1})),Y=d(ie),G=h((()=>{Xl(Y,f)})),q=o.useMemo((()=>{var n;const o=(({cellId:e,showPlaceholder:t,enableAI:n,cellMovementCallbacks:r,cellCodeCallbacks:o,completionConfig:i,keymapConfig:a,theme:s})=>{return[aa(a,r),id(e,r),ad(e,o),Cd(i,s),[kd,(c=(e,t)=>{od(e,t)},St.define((e=>new Ed(e,c)))),wt.baseTheme({".underline":{textDecoration:"underline",cursor:"pointer",color:"hsl(var(--link))"}})],t?hn.highest((l="import marimo as mo",[gn(l),Jt.of([{key:"ArrowRight",preventDefault:!0,run:e=>vd(e,l)},{key:"Tab",preventDefault:!0,run:e=>vd(e,l)}])])):n?yd({beforeText:"Start coding or ",linkText:"generate",afterText:" with AI.",onClick:r.aiCellCompletion}):[]];var l,c})({cellId:r,showPlaceholder:t,enableAI:Boolean(null==(n=w.ai.open_ai)?void 0:n.api_key),cellCodeCallbacks:{updateCellCode:c,afterToggleMarkdown:G},cellMovementCallbacks:{onRun:l,deleteCell:L,createAbove:F,createBelow:B,moveUp:V,moveDown:H,focusUp:W,focusDown:$,sendToTop:R,sendToBottom:z,splitCell:_,moveToNextCell:v,toggleHideCode:U,aiCellCompletion:()=>{let e=!1;return O((t=>t===r?(e=!0,null):r)),e}},completionConfig:w.completion,keymapConfig:w.keymap,theme:e});return o.push(St.define((e=>{const t=e.state.field(Gr);return D(t.type),{update(e){const t=e.state.doc.toString(),n=e.state.field(Gr);"markdown"!==n.type&&j(Yr.markdown().isSupported(t)),D(n.type)}}}))),o}),[r,w.keymap,w.completion,null==(S=w.ai.open_ai)?void 0:S.api_key,e,t,F,B,W,$,V,H,v,R,z,_,U,c,L,l,O,G]);o.useEffect((()=>{let e;null===s?null===k.current?(k.current=new wt({state:Bn.create({doc:i,extensions:q})}),e=!0,Mr(k.current,qr(k.current.state).type)):(k.current.dispatch({effects:[kt.reconfigure.of([q]),Kr(k.current,w.completion)]}),e=!1):(k.current=new wt({state:Bn.fromJSON(s,{doc:i,extensions:q},{history:Xr})}),Mr(k.current,qr(k.current.state).type),e=!0,b({cellId:r})),null!==k.current&&null!==P.current&&P.current.replaceChildren(k.current.dom),e&&n&&requestAnimationFrame((()=>{var e,t;null==(e=k.current)||e.focus(),null==(t=k.current)||t.dom.scrollIntoView({behavior:"smooth",block:"center"})}))}),[k,q,w.completion,b,r,s]),o.useEffect((()=>()=>{var e;null==(e=k.current)||e.destroy()}),[k]);return x.jsx(Uf,{enabled:I===r,currentCode:i,declineChange:()=>{var e;O(null),null==(e=k.current)||e.focus()},onChange:e=>{var t;null==(t=k.current)||t.dispatch({changes:{from:0,to:k.current.state.doc.length,insert:e}})},acceptChange:e=>{var t,n;null==(t=k.current)||t.dispatch({changes:{from:0,to:k.current.state.doc.length,insert:e}}),null==(n=k.current)||n.focus(),O(null)},children:x.jsxs("div",{className:"relative w-full",onFocus:()=>T(r),children:[N&&!C&&x.jsx("div",{className:"absolute top-1 right-1",children:x.jsx(cu,{editorView:k.current,languageAdapter:M,canUseMarkdown:N,onAfterToggleMarkdown:G})}),C&&x.jsx(Zr,{onClick:async()=>{var e;C&&(await xe({configs:{[r]:{hide_code:!1}}}),y({cellId:r,config:{hide_code:!1}}),null==(e=k.current)||e.focus())}}),x.jsx(Yf,{className:Mt(C&&"opacity-20 h-8 overflow-hidden"),editorView:k.current,ref:P})]})})})),qf=o.memo(o.forwardRef((({theme:e,showPlaceholder:t,allowFocus:n,id:r,code:i,output:a,consoleOutputs:s,status:l,runStartTimestamp:c,runElapsedTimeMs:d,edited:b,interrupted:w,errored:k,stopped:E,staleInputs:C,serializedEditorState:S,mode:N,debuggerActive:j,appClosed:I,showDeleteButton:O,updateCellCode:M,prepareForRun:D,createNewCell:T,deleteCell:P,focusCell:A,moveCell:_,setStdinResponse:R,moveToNextCell:z,updateCellConfig:L,clearSerializedEditorState:B,sendToBottom:F,sendToTop:H,userConfig:V,config:$,name:W},U)=>{y.debug("Rendering Cell",r);const Y=o.useRef(null),G=o.useRef(null),X=o.useRef(null),Z=u(Yl),J=$.disabled||"disabled-transitively"===l,Q=b||w||C&&!J,ee="running"===l||"queued"===l,te=Jr({status:l,output:a,runStartTimestamp:c,interrupted:w,staleInputs:C},b),ne=("queued"===l||b||C)&&!w,re="edit"===N,oe=o.useCallback((()=>{const e=q(Wl(X));return ln(Wl(X)),D({cellId:r}),e}),[r,X,D]);o.useImperativeHandle(U,(()=>({get editorView(){return Wl(X)},registerRun:oe})),[X,oe]);const ie=o.useCallback((()=>X.current),[X]),ae=h((async()=>{if(ee)return;const e=oe();await K([r],[e]).catch((e=>{y.error("Error running cell",e)}))})),se=o.useCallback((()=>T({cellId:r,before:!1})),[r,T]),le=o.useCallback((()=>T({cellId:r,before:!0})),[r,T]),ce=o.useCallback((e=>{null===Y.current||Y.current.contains(e.relatedTarget)||null===X.current||ln(X.current)}),[]),de=o.useCallback((e=>{if(Y.current===document.activeElement&&null!==X.current&&"active"===un(X.current.state)){for(const t of Qr)if(e.key===t.key&&t.run){t.run(X.current),e.preventDefault(),e.stopPropagation();break}X.current.focus()}}),[Y,X]),ue=x.jsx(ro,{allowExpand:re,output:a,className:"output-area",cellId:r,stale:te}),he=eo("Cell","hover-actions-parent",{published:!re,interactive:re,"needs-run":Q,"has-error":k,stopped:E,disabled:$.disabled,stale:"disabled-transitively"===l}),fe=on.create(r);var pe,ge;if(pe=re?Y.current:null,ge={"cell.run":ae,"cell.runAndNewBelow":()=>{ae(),z({cellId:r,before:!1})},"cell.runAndNewAbove":()=>{ae(),z({cellId:r,before:!0})},"cell.createAbove":le,"cell.createBelow":se,"cell.moveUp":()=>_({cellId:r,before:!0}),"cell.moveDown":()=>_({cellId:r,before:!1}),"cell.hideCode":()=>{var e,t,n;const o={hide_code:!$.hide_code};xe({configs:{[r]:o}}),L({cellId:r,config:o}),o.hide_code?(null==(e=X.current)||e.contentDOM.blur(),null==(t=Y.current)||t.focus()):null==(n=X.current)||n.focus()},"cell.focusDown":()=>z({cellId:r,before:!1}),"cell.focusUp":()=>z({cellId:r,before:!0}),"cell.sendToBottom":()=>F({cellId:r}),"cell.sendToTop":()=>H({cellId:r}),"cell.aiCompletion":()=>{let e=!1;Z((t=>t===r?(e=!0,null):r)),e&&Wl(X).focus()},"cell.cellActions":()=>{var e;null==(e=G.current)||e.toggle()}},g(pe,"keydown",(e=>{for(const[t,n]of v.entries(ge)){const r=f.getHotkey(t).key;p(r)(e)&&(y.debug("Satisfied",r,e),!1!==n()&&(e.preventDefault(),e.stopPropagation()))}})),function(e,t){g(e,"keydown",(e=>{for(const[n,r]of v.entries(t))p(n)(e)&&(y.debug("Satisfied",n,e),!1!==r()&&(e.preventDefault(),e.stopPropagation()))}))}(re?Y.current:null,{ArrowDown:()=>(z({cellId:r,before:!1,noCreate:!0}),!0),ArrowUp:()=>(z({cellId:r,before:!0,noCreate:!0}),!0),..."vim"===V.keymap.preset&&$.hide_code?{j:()=>(z({cellId:r,before:!1,noCreate:!0}),!0),k:()=>(z({cellId:r,before:!0,noCreate:!0}),!0)}:{}}),!re){return k||w||E?null:x.jsx("div",{tabIndex:-1,id:fe,ref:Y,className:he,children:ue})}const me=!to(a);return x.jsx(lu,{cellId:r,config:$,status:l,getEditorView:ie,hasOutput:me,name:W,children:x.jsxs(_d,{tabIndex:-1,id:fe,ref:Y,className:he,"data-status":l,onBlur:ce,onKeyDown:de,cellId:r,title:$.disabled?"This cell is disabled":"disabled-transitively"===l?"This cell has a disabled ancestor":void 0,children:["above"===V.display.cell_output&&ue,x.jsxs("div",{className:"tray",children:[x.jsxs("div",{className:"absolute flex flex-col gap-[2px] justify-center h-full left-[-34px] z-2 hover-action",children:[x.jsx(Sd,{tooltipContent:jl("cell.createAbove"),appClosed:I,onClick:I?void 0:le}),x.jsx("div",{className:"flex-1"}),x.jsx(Sd,{tooltipContent:jl("cell.createBelow"),appClosed:I,onClick:I?void 0:se})]}),x.jsx(Gf,{theme:e,showPlaceholder:t,allowFocus:n,id:r,code:i,status:l,serializedEditorState:S,runCell:ae,updateCellCode:M,createNewCell:T,deleteCell:P,focusCell:A,moveCell:_,moveToNextCell:z,updateCellConfig:L,clearSerializedEditorState:B,userConfig:V,editorViewRef:X,hidden:$.hide_code}),x.jsxs("div",{className:"shoulder-right",children:[x.jsx(Id,{status:l,staleInputs:C,interrupted:w,editing:re,edited:b,disabled:$.disabled??!1,elapsedTime:d,runStartTimestamp:c}),x.jsxs("div",{className:"flex align-bottom",children:[x.jsx(Nd,{edited:b,onClick:I?m.NOOP:ae,appClosed:I,status:l,config:$,needsRun:Q}),x.jsx(Rd,{ref:G,cellId:r,status:l,getEditorView:ie,name:W,config:$,hasOutput:me,children:x.jsx(Pd,{})})]})]}),x.jsx("div",{className:"shoulder-bottom hover-action",children:O?x.jsx(jd,{appClosed:I,status:l,onClick:()=>{ee||I||P({cellId:r})}}):null})]}),"below"===V.display.cell_output&&ue,x.jsx(wa,{consoleOutputs:s,stale:ne,cellName:W,onSubmitDebugger:(e,t)=>{R({cellId:r,response:e,outputIndex:t}),no({text:e})},cellId:r,debuggerActive:j})]})})}))),Kf=e=>{const{banners:t}=ka(),{removeBanner:n}=Ea();return 0===t.length?null:x.jsx("div",{className:"flex flex-col gap-4 mb-5",children:t.map((e=>x.jsxs(oo,{kind:e.variant||"info",className:"flex flex-col rounded p-3",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsxs("span",{className:"font-bold text-lg flex items-center mb-2",children:[x.jsx(io,{className:"w-5 h-5 inline-block mr-2"}),e.title]}),x.jsx(P,{"data-testid":"remove-banner-button",variant:"text",size:"icon",onClick:()=>n(e.id),children:x.jsx(jt,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"flex justify-between items-end",children:[x.jsx("span",{children:ao({html:e.description})}),"restart"===e.action&&x.jsx(Xf,{})]})]},e.id)))})},Xf=()=>{const e=cc();return x.jsxs(P,{"data-testid":"restart-session-button",variant:"link",size:"sm",onClick:e,children:[x.jsx(Rs,{className:"w-4 h-4 mr-2"}),"Restart"]})},Zf=e=>{const{packageAlert:t}=Ca(),{clearPackageAlert:n}=Sa(),[r]=we();if(null===t)return null;if(Na(t))return x.jsx("div",{className:"flex flex-col gap-4 mb-5 fixed top-5 left-12 w-[400px] z-[200] opacity-95",children:x.jsxs(oo,{kind:"danger",className:"flex flex-col rounded py-3 px-5 animate-in slide-in-from-left",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsxs("span",{className:"font-bold text-lg flex items-center mb-2",children:[x.jsx(Ds,{className:"w-5 h-5 inline-block mr-2"}),"Missing packages"]}),x.jsx(P,{variant:"text","data-testid":"remove-banner-button",size:"icon",onClick:()=>n(t.id),children:x.jsx(jt,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"flex flex-col gap-4 justify-between items-start text-muted-foreground text-base",children:[x.jsxs("div",{children:[x.jsx("p",{children:"The following packages were not found:"}),x.jsx("ul",{className:"list-disc ml-4 mt-1",children:t.packages.map(((e,t)=>x.jsxs("li",{className:"flex items-center gap-1 font-mono text-sm",children:[x.jsx(os,{size:"1rem"}),e]},t)))})]}),x.jsx("div",{className:"ml-auto flex flex-row items-baseline",children:t.isolated?x.jsxs(x.Fragment,{children:[x.jsx(Qf,{manager:r.package_management.manager,clearPackageAlert:()=>n(t.id)}),_()?null:x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"px-2 text-sm",children:"with"})," ",x.jsx(ep,{})]})]}):x.jsxs("p",{children:["If you set up a"," ",x.jsx("a",{href:"https://docs.python.org/3/tutorial/venv.html#creating-virtual-environments",className:"text-accent-foreground hover:underline",target:"_blank",rel:"noreferrer",children:"virtual environment"}),", marimo can install these packages for you."]})})]})]})});if(ja(t)){const{status:e,title:r,titleIcon:o,description:i}=function(e){const t=new Set(Object.values(e)),n=t.has("queued")||t.has("installing")?"installing":t.has("failed")?"failed":"installed";return"installing"===n?{status:"installing",title:"Installing packages",titleIcon:x.jsx(us,{className:"w-5 h-5 inline-block mr-2"}),description:"Installing packages:"}:"installed"===n?{status:"installed",title:"All packages installed!",titleIcon:x.jsx(Ms,{className:"w-5 h-5 inline-block mr-2"}),description:"Installed packages:"}:{status:"failed",title:"Some packages failed to install",titleIcon:x.jsx(Ds,{className:"w-5 h-5 inline-block mr-2"}),description:"See terminal for error logs."}}(t.packages);return"installed"===e&&setTimeout((()=>n(t.id)),1e4),x.jsx("div",{className:"flex flex-col gap-4 mb-5 fixed top-5 left-12 w-[400px] z-[200] opacity-95",children:x.jsxs(oo,{kind:"failed"===e?"danger":"info",className:"flex flex-col rounded pt-3 pb-4 px-5",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsxs("span",{className:"font-bold text-lg flex items-center mb-2",children:[o,r]}),x.jsx(P,{variant:"text","data-testid":"remove-banner-button",size:"icon",onClick:()=>n(t.id),children:x.jsx(jt,{className:"w-5 h-5"})})]}),x.jsx("div",{className:Mt("flex flex-col gap-4 justify-between items-start text-muted-foreground text-base","installed"===e&&"text-accent-foreground"),children:x.jsxs("div",{children:[x.jsx("p",{children:i}),x.jsx("ul",{className:"list-disc ml-4 mt-1",children:Object.entries(t.packages).map((([t,n],r)=>x.jsxs("li",{className:Mt("flex items-center gap-1 font-mono text-sm","installing"===n&&"font-semibold","failed"===n&&"text-destructive","installed"===n&&"text-accent-foreground","installed"===n&&"failed"===e&&"text-muted-foreground"),children:[x.jsx(Jf,{status:n}),t]},r)))})]})})]})})}return so(t),null};const Jf=({status:e})=>{switch(e){case"queued":return x.jsx(os,{size:"1rem"});case"installing":return x.jsx(us,{size:"1rem"});case"installed":return x.jsx(ot,{size:"1rem"});case"failed":return x.jsx(jt,{size:"1rem"});default:return so(e),null}};const Qf=({manager:e,clearPackageAlert:t})=>x.jsxs(P,{variant:"outline","data-testid":"install-packages-button",size:"sm",onClick:()=>async function(e,t){t(),await xo({manager:e}).catch((e=>{y.error(e)}))}(e,t),children:[x.jsx(us,{className:"w-4 h-4 mr-2"}),x.jsx("span",{className:"font-semibold",children:"Install"})]}),ep=()=>{const[e,t]=we(),n=lo({resolver:co(uo),defaultValues:e});return x.jsx(ho,{...n,children:x.jsx("form",{onChange:n.handleSubmit((async e=>{await Ce({config:e}).then((()=>{t(e)}))})),className:"flex flex-col gap-5",children:x.jsx("div",{className:"flex flex-col gap-3",children:x.jsx(fo,{control:n.control,name:"package_management.manager",render:({field:e})=>x.jsxs(po,{children:[x.jsx(go,{children:x.jsx(mo,{"data-testid":"install-package-manager-select",onChange:t=>e.onChange(t.target.value),value:e.value,disabled:e.disabled,className:"inline-flex mr-2",children:vo.map((e=>x.jsx("option",{value:e,children:e},e)))})}),x.jsx(yo,{})]})})})})})},tp=[Hr(),wt.lineWrapping],np=({onClose:e})=>{const{createNewCell:t}=X(),{completion:n,input:r,stop:o,isLoading:i,setCompletion:a,handleInputChange:s,handleSubmit:l}=Hf({api:"/api/ai/completion",headers:Vr.headers(),streamMode:"text",body:{includeOtherCode:na(""),code:""},onError:e=>{Q({title:"Generate with AI failed",description:$r(e)})}}),c=x.jsxs("div",{className:"flex items-center gap-3 px-3 py-2",children:[x.jsx(Vs,{className:"size-4 text-[var(--blue-11)]"}),x.jsx("input",{className:"h-8 outline-none text-base focus-visible:shadow-none flex-1 rounded-none border-none focus:border-none",autoFocus:!0,value:r,onChange:s,onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),l(t)),"Escape"===t.key&&(t.preventDefault(),a(""),e())},placeholder:"Generate with AI"}),i&&x.jsxs(P,{"data-testid":"stop-completion-button",variant:"text",size:"sm",className:"mb-0",onClick:o,children:[x.jsx(Wr,{className:"animate-spin mr-1",size:14}),"Stop"]}),!i&&n&&x.jsx(P,{"data-testid":"accept-completion-button",variant:"text",size:"sm",className:"mb-0",disabled:i,onClick:()=>{t({cellId:"__end__",before:!1,code:n}),a(""),e()},children:x.jsx("span",{className:"text-[var(--grass-11)] opacity-100",children:"Accept"})}),x.jsx(P,{variant:"text",size:"sm",className:"mb-0",onClick:e,children:x.jsx(jt,{className:"size-4"})})]});return x.jsxs("div",{className:Mt("flex flex-col w-full"),children:[c,n&&x.jsx(bo,{value:n,className:"cm border-t",onChange:a,extensions:tp})]})},rp=({notebook:e,mode:t,userConfig:n,appConfig:r,connStatus:i})=>{const{updateCellCode:a,prepareForRun:s,moveCell:l,moveToNextCell:c,updateCellConfig:d,clearSerializedEditorState:u,focusCell:h,createNewCell:f,focusBottomCell:p,focusTopCell:g,scrollToTarget:v,foldAll:y,unfoldAll:b,sendToBottom:w,sendToTop:k,setStdinResponse:E}=X(),{theme:C}=be(),{togglePanel:S}=gc(),{invisible:N}=Ia(e.cellIds.length,t);Nl("global.focusTop",g),Nl("global.focusBottom",p),Nl("global.toggleSidebar",S),Nl("global.foldCode",y),Nl("global.unfoldCode",b),Nl("global.formatAll",(()=>{wo(a)})),Nl("cell.hideCode",m.NOOP),Nl("cell.format",m.NOOP);const j=ql();o.useEffect((()=>{null!==e.scrollKey&&v()}),[e.cellIds,e.scrollKey,v]);const I=ko(e);return x.jsxs(Oa,{className:"pb-[40vh]",invisible:N,appConfig:r,children:[x.jsx(Zf,{}),x.jsx(Kf,{}),I.map((r=>x.jsx(qf,{theme:C,showPlaceholder:1===I.length,allowFocus:!N,id:r.id,code:r.code,output:r.output,consoleOutputs:r.consoleOutputs,status:r.status,updateCellCode:a,prepareForRun:s,edited:r.edited,interrupted:r.interrupted,errored:r.errored,stopped:r.stopped,staleInputs:r.staleInputs,runStartTimestamp:r.runStartTimestamp,runElapsedTimeMs:r.runElapsedTimeMs,serializedEditorState:r.serializedEditorState,showDeleteButton:I.length>1&&!r.config.hide_code,createNewCell:f,deleteCell:j,focusCell:h,moveToNextCell:c,setStdinResponse:E,updateCellConfig:d,clearSerializedEditorState:u,moveCell:l,mode:t,appClosed:i.state!==va.OPEN,ref:e.cellHandles[r.id],sendToBottom:w,sendToTop:k,userConfig:n,debuggerActive:r.debuggerActive,config:r.config,name:r.name},r.id.toString()))),x.jsx(op,{})]})},op=()=>{const{createNewCell:e}=X(),t=d(ie),[n,r]=Eo(!1),o=d(oe),i=Mt("mb-0 rounded-none px-4 sm:px-8 md:px-10 lg:px-16 tracking-wide","hover:bg-accent hover:text-accent-foreground font-semibold uppercase text-xs");return x.jsx("div",{className:"flex justify-center mt-4 pt-6 pb-32 group gap-4 w-full",children:x.jsx("div",{className:Mt("shadow-sm border border-border rounded transition-all duration-200 overflow-hidden divide-x divide-border flex",!n&&"opacity-0 group-hover:opacity-100 w-fit",n&&"opacity-100 w-full max-w-4xl shadow-lg"),children:n?x.jsx(np,{onClose:r.toggle}):x.jsxs(x.Fragment,{children:[x.jsxs(P,{className:i,variant:"text",size:"sm",onClick:()=>e({cellId:"__end__",before:!1}),children:[x.jsx($s,{className:"mr-2 size-4"}),"Code"]}),x.jsxs(P,{className:i,variant:"text",size:"sm",onClick:()=>{Xl(t,e),e({cellId:"__end__",before:!1,code:'mo.md(rf"""\n""")'})},children:[x.jsx(Ys,{className:"mr-2 size-4"}),"Markdown"]}),o&&x.jsxs(P,{className:i,variant:"text",size:"sm",onClick:r.toggle,children:[x.jsx(Vs,{className:"mr-2 size-4"}),"Generate with AI"]})]})})})},ip=({userConfig:e,appConfig:t})=>{const n=Y(),{setCells:r,updateCellCode:i}=X(),[a,s]=E(Co),[l,c]=ic(),[u,f]=o.useState(),p=ua(),{openModal:m,closeModal:v,openAlert:b}=M(),w="edit"===a.mode,k="present"===a.mode,C=d(So);function S(){b("Failed to save notebook: not connected to a kernel.")}o.useEffect((()=>(Ma.INSTANCE.start(No),()=>{Ma.INSTANCE.stop()})),[]);const{connection:N}=Da({autoInstantiate:e.runtime.auto_instantiate,setCells:(e,t)=>{r(e);const n=e.map((e=>e.name)),o=e.map((e=>e.code)),i=e.map((e=>e.config));f({names:n,codes:o,configs:i,layout:t})},sessionId:jo()}),j=h((async e=>N.state!==va.OPEN?(S(),null):(Io((t=>{null===e?t.delete("file"):t.set("file",e)})),Oo(e).then((()=>(c(e),document.title=t.app_title||e||"Untitled Notebook",e))).catch((e=>(b(e.message),null))))));o.useEffect((()=>{document.title=t.app_title||l||"Untitled Notebook"}),[t.app_title,l]);const I=Mo(n),O=I.map((e=>e.id)),D=I.map((e=>e.code)),T=I.map((e=>e.name)),P=I.map((e=>e.config)),A=Do(n,p,u),_=h(((t,n)=>{0!==D.length&&(N.state===va.OPEN?(y.log("saving to ",t),To({cellIds:O,codes:D,names:T,filename:t,configs:P,layout:Ta()}).then((()=>{n&&(Q({title:"Notebook saved"}),e.save.format_on_save&&wo(i)),f({names:T,codes:D,configs:P,layout:p})}))):S())})),R=h(((e=!1)=>{null!==l&&N.state===va.OPEN&&_(l,e)})),z=h((()=>{R(!0),null===l&&N.state!==va.CLOSED&&m(x.jsx(ap,{onClose:v,onSave:L}))}));!function(e){const{codes:t,cellConfigs:n,config:r,connStatus:i,cellNames:a,needsSave:s,onSave:l}=e,c=o.useRef(null);o.useEffect((()=>("after_delay"===r.save.autosave&&(null!==c.current&&clearTimeout(c.current),s&&i.state===va.OPEN&&(c.current=setTimeout(l,r.save.autosave_delay))),()=>{null!==c.current&&clearTimeout(c.current)})),[t,n,a,r.save,i.state,l,s])}({onSave:R,needsSave:A,codes:D,cellConfigs:P,cellNames:T,connStatus:N,config:e}),g(window,"beforeunload",(e=>{if(!Po())return A?(e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to quit?"):void 0}));const L=e=>{j(e).then((e=>{null!==e&&_(e,!0)}))},B=function(){const e=Y(),t=Ul();return h((()=>t(G(e))))}(),F=o.useCallback((()=>{const e=document.getElementsByClassName("output-area"),t=window.innerHeight||document.documentElement.clientHeight;let n=null;for(const r of Array.from(e)){const e=r.getBoundingClientRect();if(e.top>=0&&e.top<=t||e.bottom>=0&&e.bottom<=t){n=on.parse(r.parentNode.id);break}}s((e=>({mode:Ao(e.mode),cellAnchor:n}))),requestAnimationFrame((()=>{var e;null!==n&&(null==(e=document.getElementById(on.create(n)))||e.scrollIntoView())}))}),[s]);Nl("global.runStale",(()=>{B()})),Nl("global.save",z),Nl("global.interrupt",(()=>{Yn()})),Nl("global.hideCode",(()=>{F()}));const H=h((()=>JSON.stringify({filename:l,cells:I.map((e=>({name:e.name,code:e.code})))},null,2))),V=x.jsx(rp,{notebook:n,connStatus:N,mode:a.mode,userConfig:e,appConfig:t});return x.jsxs(x.Fragment,{children:[x.jsxs(Pa,{connectionState:N.state,isRunning:C,width:t.width,children:[x.jsx(Aa,{connection:N,className:Mt("pt-4 sm:pt-12 pb-2 mb-4"),children:w&&x.jsx("div",{className:"flex items-center justify-center container",children:x.jsx(qc,{filename:l,setFilename:j})})}),I.length>0&&x.jsx(_a,{appConfig:t,mode:a.mode,children:x.jsx(Xc,{disabled:!w,children:V})})]}),x.jsx(Vc,{filename:l,needsSave:A,onSaveNotebook:z,getCellsAsJSON:H,presenting:k,onTogglePresenting:F,onInterrupt:Yn,onRun:B,closed:N.state===va.CLOSED,running:C,needsRun:_o(n),undoAvailable:it(n),appWidth:t.width})]})},ap=e=>{const{onClose:t,onSave:n}=e,[r,i]=o.useState();return x.jsxs(j,{children:[x.jsx(O,{children:"Save notebook"}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx(ae,{className:"text-md pt-6 px-1",children:"Save as"}),x.jsx(Gc,{onNameChange:e=>{i(e),e.trim()&&(n(e),t())},placeholderText:"filename",className:"missing-filename"})]}),x.jsxs(T,{children:[x.jsx(P,{"data-testid":"cancel-save-dialog-button","aria-label":"Cancel",variant:"secondary",onClick:t,children:"Cancel"}),x.jsx(P,{"data-testid":"submit-save-dialog-button","aria-label":"Save",variant:"default",disabled:!r,type:"submit",children:"Save"})]})]})},{createElement:sp,createContext:lp,createRef:cp,forwardRef:dp,useCallback:up,useContext:hp,useEffect:fp,useImperativeHandle:pp,useLayoutEffect:gp,useMemo:mp,useRef:vp,useState:yp}=Ro,xp=Ro["useId".toString()],bp=gp,wp=lp(null);wp.displayName="PanelGroupContext";const kp=bp,Ep="function"==typeof xp?xp:()=>null;let Cp=0;function Sp(e=null){const t=Ep(),n=vp(e||t||null);return null===n.current&&(n.current=""+Cp++),null!=e?e:n.current}function Np({children:e,className:t="",collapsedSize:n,collapsible:r,defaultSize:o,forwardedRef:i,id:a,maxSize:s,minSize:l,onCollapse:c,onExpand:d,onResize:u,order:h,style:f,tagName:p="div",...g}){const m=hp(wp);if(null===m)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:v,expandPanel:y,getPanelSize:x,getPanelStyle:b,groupId:w,isPanelCollapsed:k,reevaluatePanelConstraints:E,registerPanel:C,resizePanel:S,unregisterPanel:N}=m,j=Sp(a),I=vp({callbacks:{onCollapse:c,onExpand:d,onResize:u},constraints:{collapsedSize:n,collapsible:r,defaultSize:o,maxSize:s,minSize:l},id:j,idIsFromProps:void 0!==a,order:h});vp({didLogMissingDefaultSizeWarning:!1}),kp((()=>{const{callbacks:e,constraints:t}=I.current,i={...t};I.current.id=j,I.current.idIsFromProps=void 0!==a,I.current.order=h,e.onCollapse=c,e.onExpand=d,e.onResize=u,t.collapsedSize=n,t.collapsible=r,t.defaultSize=o,t.maxSize=s,t.minSize=l,i.collapsedSize===t.collapsedSize&&i.collapsible===t.collapsible&&i.maxSize===t.maxSize&&i.minSize===t.minSize||E(I.current,i)})),kp((()=>{const e=I.current;return C(e),()=>{N(e)}}),[h,j,C,N]),pp(i,(()=>({collapse:()=>{v(I.current)},expand:e=>{y(I.current,e)},getId:()=>j,getSize:()=>x(I.current),isCollapsed:()=>k(I.current),isExpanded:()=>!k(I.current),resize:e=>{S(I.current,e)}})),[v,y,x,k,j,S]);const O=b(I.current,o);return sp(p,{...g,children:e,className:t,id:a,style:{...O,...f},"data-panel":"","data-panel-collapsible":r||void 0,"data-panel-group-id":w,"data-panel-id":j,"data-panel-size":parseFloat(""+O.flexGrow).toFixed(1)})}const jp=dp(((e,t)=>sp(Np,{...e,forwardedRef:t})));Np.displayName="Panel",jp.displayName="forwardRef(Panel)";let Ip=null,Op=null;function Mp(e,t){const n=function(e,t){if(t){const e=!!(t&$p),n=!!(t&Wp);if(t&Hp)return e?"se-resize":n?"ne-resize":"e-resize";if(t&Vp)return e?"sw-resize":n?"nw-resize":"w-resize";if(e)return"s-resize";if(n)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}(e,t);Ip!==n&&(Ip=n,null===Op&&(Op=document.createElement("style"),document.head.appendChild(Op)),Op.innerHTML=`*{cursor: ${n}!important;}`)}function Dp(e){return"keydown"===e.type}function Tp(e){return e.type.startsWith("pointer")}function Pp(e){return e.type.startsWith("mouse")}function Ap(e){if(Tp(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Pp(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}const _p=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Rp(e){const t=getComputedStyle(e);return"fixed"===t.position||(!("auto"===t.zIndex||"static"===t.position&&!function(e){var t;const n=getComputedStyle(null!==(t=Fp(e))&&void 0!==t?t:e).display;return"flex"===n||"inline-flex"===n}(e))||(+t.opacity<1||("transform"in t&&"none"!==t.transform||("webkitTransform"in t&&"none"!==t.webkitTransform||("mixBlendMode"in t&&"normal"!==t.mixBlendMode||("filter"in t&&"none"!==t.filter||("webkitFilter"in t&&"none"!==t.webkitFilter||("isolation"in t&&"isolate"===t.isolation||(!!_p.test(t.willChange)||"touch"===t.webkitOverflowScrolling)))))))))}function zp(e){let t=e.length;for(;t--;){const n=e[t];if(ig(n,"Missing node"),Rp(n))return n}return null}function Lp(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Bp(e){const t=[];for(;e;)t.push(e),e=Fp(e);return t}function Fp(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const Hp=1,Vp=2,$p=4,Wp=8,Up="coarse"===function(){if("function"==typeof matchMedia)return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}();let Yp=[],Gp=!1,qp=new Map,Kp=new Map;const Xp=new Set;function Zp(e){const{target:t}=e,{x:n,y:r}=Ap(e);Gp=!0,eg({target:t,x:n,y:r}),rg(),Yp.length>0&&(og("down",e),e.preventDefault(),e.stopPropagation())}function Jp(e){const{x:t,y:n}=Ap(e);if(!Gp){const{target:r}=e;eg({target:r,x:t,y:n})}og("move",e),ng(),Yp.length>0&&e.preventDefault()}function Qp(e){const{target:t}=e,{x:n,y:r}=Ap(e);Kp.clear(),Gp=!1,Yp.length>0&&e.preventDefault(),og("up",e),eg({target:t,x:n,y:r}),ng(),rg()}function eg({target:e,x:t,y:n}){Yp.splice(0);let r=null;e instanceof HTMLElement&&(r=e),Xp.forEach((e=>{const{element:o,hitAreaMargins:i}=e,a=o.getBoundingClientRect(),{bottom:s,left:l,right:c,top:d}=a,u=Up?i.coarse:i.fine;if(t>=l-u&&t<=c+u&&n>=d-u&&n<=s+u){if(null!==r&&o!==r&&!o.contains(r)&&!r.contains(o)&&function(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:Bp(e),b:Bp(t)};let r;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;ig(r,"Stacking order can only be calculated for elements with a common ancestor");const o=Lp(zp(n.a)),i=Lp(zp(n.b));if(o===i){const e=r.childNodes,t={a:n.a.at(-1),b:n.b.at(-1)};let o=e.length;for(;o--;){const n=e[o];if(n===t.a)return 1;if(n===t.b)return-1}}return Math.sign(o-i)}(r,o)>0){let e=r,t=!1;for(;e&&!e.contains(o);){if(h=e.getBoundingClientRect(),f=a,!0?h.x<f.x+f.width&&h.x+h.width>f.x&&h.y<f.y+f.height&&h.y+h.height>f.y:h.x<=f.x+f.width&&h.x+h.width>=f.x&&h.y<=f.y+f.height&&h.y+h.height>=f.y){t=!0;break}e=e.parentElement}if(t)return}Yp.push(e)}var h,f}))}function tg(e,t){Kp.set(e,t)}function ng(){let e=!1,t=!1;Yp.forEach((n=>{const{direction:r}=n;"horizontal"===r?e=!0:t=!0}));let n=0;Kp.forEach((e=>{n|=e})),e&&t?Mp("intersection",n):e?Mp("horizontal",n):t?Mp("vertical",n):null!==Op&&(document.head.removeChild(Op),Ip=null,Op=null)}function rg(){qp.forEach(((e,t)=>{const{body:n}=t;n.removeEventListener("contextmenu",Qp),n.removeEventListener("pointerdown",Zp),n.removeEventListener("pointerleave",Jp),n.removeEventListener("pointermove",Jp)})),window.removeEventListener("pointerup",Qp),window.removeEventListener("pointercancel",Qp),Xp.size>0&&(Gp?(Yp.length>0&&qp.forEach(((e,t)=>{const{body:n}=t;e>0&&(n.addEventListener("contextmenu",Qp),n.addEventListener("pointerleave",Jp),n.addEventListener("pointermove",Jp))})),window.addEventListener("pointerup",Qp),window.addEventListener("pointercancel",Qp)):qp.forEach(((e,t)=>{const{body:n}=t;e>0&&(n.addEventListener("pointerdown",Zp,{capture:!0}),n.addEventListener("pointermove",Jp))})))}function og(e,t){Xp.forEach((n=>{const{setResizeHandlerState:r}=n,o=Yp.includes(n);r(e,o,t)}))}function ig(e,t){if(!e)throw console.error(t),Error(t)}const ag=10;function sg(e,t,n=ag){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function lg(e,t,n=ag){return 0===sg(e,t,n)}function cg(e,t,n){return 0===sg(e,t,n)}function dg({panelConstraints:e,panelIndex:t,size:n}){const r=e[t];ig(null!=r,`Panel constraints not found for index ${t}`);let{collapsedSize:o=0,collapsible:i,maxSize:a=100,minSize:s=0}=r;if(sg(n,s)<0)if(i){n=sg(n,(o+s)/2)<0?o:s}else n=s;return n=Math.min(a,n),n=parseFloat(n.toFixed(ag))}function ug({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:r,prevLayout:o,trigger:i}){if(cg(e,0))return t;const a=[...t],[s,l]=r;ig(null!=s,"Invalid first pivot index"),ig(null!=l,"Invalid second pivot index");let c=0;if("keyboard"===i){{const r=e<0?l:s,o=n[r];ig(o,`Panel constraints not found for index ${r}`);const{collapsedSize:i=0,collapsible:a,minSize:c=0}=o;if(a){const n=t[r];if(ig(null!=n,`Previous layout not found for panel index ${r}`),cg(n,i)){const t=c-n;sg(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{const r=e<0?s:l,o=n[r];ig(o,`No panel constraints found for index ${r}`);const{collapsedSize:i=0,collapsible:a,minSize:c=0}=o;if(a){const n=t[r];if(ig(null!=n,`Previous layout not found for panel index ${r}`),cg(n,c)){const t=n-i;sg(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{const r=e<0?1:-1;let o=e<0?l:s,i=0;for(;;){const e=t[o];ig(null!=e,`Previous layout not found for panel index ${o}`);if(i+=dg({panelConstraints:n,panelIndex:o,size:100})-e,o+=r,o<0||o>=n.length)break}const a=Math.min(Math.abs(e),Math.abs(i));e=e<0?0-a:a}{let r=e<0?s:l;for(;r>=0&&r<n.length;){const o=Math.abs(e)-Math.abs(c),i=t[r];ig(null!=i,`Previous layout not found for panel index ${r}`);const s=dg({panelConstraints:n,panelIndex:r,size:i-o});if(!cg(i,s)&&(c+=i-s,a[r]=s,c.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?r--:r++}}if(function(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!cg(e[r],t[r],n))return!1;return!0}(o,a))return o;{const r=e<0?l:s,o=t[r];ig(null!=o,`Previous layout not found for panel index ${r}`);const i=o+c,d=dg({panelConstraints:n,panelIndex:r,size:i});if(a[r]=d,!cg(d,i)){let t=i-d;let r=e<0?l:s;for(;r>=0&&r<n.length;){const o=a[r];ig(null!=o,`Previous layout not found for panel index ${r}`);const i=dg({panelConstraints:n,panelIndex:r,size:o+t});if(cg(o,i)||(t-=i-o,a[r]=i),cg(t,0))break;e>0?r--:r++}}}return cg(a.reduce(((e,t)=>t+e),0),100)?a:o}function hg({layout:e,panelsArray:t,pivotIndices:n}){let r=0,o=100,i=0,a=0;const s=n[0];ig(null!=s,"No pivot index found"),t.forEach(((e,t)=>{const{constraints:n}=e,{maxSize:l=100,minSize:c=0}=n;t===s?(r=c,o=l):(i+=c,a+=l)}));return{valueMax:Math.min(o,100-i),valueMin:Math.max(r,100-a),valueNow:e[s]}}function fg(e,t=document){return Array.from(t.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${e}"]`))}function pg(e,t,n=document){const r=fg(e,n).findIndex((e=>e.getAttribute("data-panel-resize-handle-id")===t));return null!=r?r:null}function gg(e,t,n){const r=pg(e,t,n);return null!=r?[r,r+1]:[-1,-1]}function mg(e,t=document){var n;if(t instanceof HTMLElement&&(null==t||null===(n=t.dataset)||void 0===n?void 0:n.panelGroupId)==e)return t;const r=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function vg(e,t=document){const n=t.querySelector(`[data-panel-resize-handle-id="${e}"]`);return n||null}function yg({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:r,panelDataArray:o,panelGroupElement:i,setLayout:a}){vp({didWarnAboutMissingResizeHandle:!1}),kp((()=>{if(!i)return;const e=fg(n,i);for(let t=0;t<o.length-1;t++){const{valueMax:n,valueMin:i,valueNow:a}=hg({layout:r,panelsArray:o,pivotIndices:[t,t+1]}),s=e[t];if(null==s);else{const e=o[t];ig(e,`No panel data found for index "${t}"`),s.setAttribute("aria-controls",e.id),s.setAttribute("aria-valuemax",""+Math.round(n)),s.setAttribute("aria-valuemin",""+Math.round(i)),s.setAttribute("aria-valuenow",null!=a?""+Math.round(a):"")}}return()=>{e.forEach(((e,t)=>{e.removeAttribute("aria-controls"),e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin"),e.removeAttribute("aria-valuenow")}))}}),[n,r,o,i]),fp((()=>{if(!i)return;const e=t.current;ig(e,"Eager values not found");const{panelDataArray:o}=e;ig(null!=mg(n,i),`No group found for id "${n}"`);const s=fg(n,i);ig(s,`No resize handles found for group id "${n}"`);const l=s.map((e=>{const t=e.getAttribute("data-panel-resize-handle-id");ig(t,"Resize handle element has no handle id attribute");const[s,l]=function(e,t,n,r=document){var o,i,a,s;const l=vg(t,r),c=fg(e,r),d=l?c.indexOf(l):-1;return[null!==(o=null===(i=n[d])||void 0===i?void 0:i.id)&&void 0!==o?o:null,null!==(a=null===(s=n[d+1])||void 0===s?void 0:s.id)&&void 0!==a?a:null]}(n,t,o,i);if(null==s||null==l)return()=>{};const c=e=>{if(!e.defaultPrevented)switch(e.key){case"Enter":{e.preventDefault();const l=o.findIndex((e=>e.id===s));if(l>=0){const e=o[l];ig(e,`No panel data found for index ${l}`);const s=r[l],{collapsedSize:c=0,collapsible:d,minSize:u=0}=e.constraints;if(null!=s&&d){const e=ug({delta:cg(s,c)?u-c:c-s,initialLayout:r,panelConstraints:o.map((e=>e.constraints)),pivotIndices:gg(n,t,i),prevLayout:r,trigger:"keyboard"});r!==e&&a(e)}}break}}};return e.addEventListener("keydown",c),()=>{e.removeEventListener("keydown",c)}}));return()=>{l.forEach((e=>e()))}}),[i,e,t,n,r,o,a])}function xg(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function bg(e,t){const n="horizontal"===e,{x:r,y:o}=Ap(t);return n?r:o}function wg(e,t,n,r,o,i){if(Dp(e)){const t="horizontal"===n;let r=0;r=e.shiftKey?100:null!=o?o:10;let i=0;switch(e.key){case"ArrowDown":i=t?0:r;break;case"ArrowLeft":i=t?-r:0;break;case"ArrowRight":i=t?r:0;break;case"ArrowUp":i=t?0:-r;break;case"End":i=100;break;case"Home":i=-100}return i}return null==r?0:function(e,t,n,r,o){const i="horizontal"===n,a=vg(t,o);ig(a,`No resize handle element found for id "${t}"`);const s=a.getAttribute("data-panel-group-id");ig(s,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=r;const c=bg(n,e),d=mg(s,o);ig(d,`No group element found for id "${s}"`);const u=d.getBoundingClientRect();return(c-l)/(i?u.width:u.height)*100}(e,t,n,r,i)}function kg(e,t,n){t.forEach(((t,r)=>{const o=e[r];ig(o,`Panel data not found for index ${r}`);const{callbacks:i,constraints:a,id:s}=o,{collapsedSize:l=0,collapsible:c}=a,d=n[s];if(null==d||t!==d){n[s]=t;const{onCollapse:e,onExpand:r,onResize:o}=i;o&&o(t,d),c&&(e||r)&&(!r||null!=d&&!lg(d,l)||lg(t,l)||r(),!e||null!=d&&lg(d,l)||!lg(t,l)||e())}}))}function Eg(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function Cg(e){try{if("undefined"==typeof localStorage)throw new Error("localStorage not supported in this environment");e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)}}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function Sg(e){return`react-resizable-panels:${e}`}function Ng(e){return e.map((e=>{const{constraints:t,id:n,idIsFromProps:r,order:o}=e;return r?n:o?`${o}:${JSON.stringify(t)}`:JSON.stringify(t)})).sort(((e,t)=>e.localeCompare(t))).join(",")}function jg(e,t){try{const n=Sg(e),r=t.getItem(n);if(r){const e=JSON.parse(r);if("object"==typeof e&&null!=e)return e}}catch(n){}return null}function Ig(e,t,n,r,o){var i;const a=Sg(e),s=Ng(t),l=null!==(i=jg(e,o))&&void 0!==i?i:{};l[s]={expandToSizes:Object.fromEntries(n.entries()),layout:r};try{o.setItem(a,JSON.stringify(l))}catch(c){console.error(c)}}function Og({layout:e,panelConstraints:t}){const n=[...e],r=n.reduce(((e,t)=>e+t),0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map((e=>`${e}%`)).join(", ")}`);if(!cg(r,100))for(let i=0;i<t.length;i++){const e=n[i];ig(null!=e,`No layout data found for index ${i}`);const t=100/r*e;n[i]=t}let o=0;for(let i=0;i<t.length;i++){const e=n[i];ig(null!=e,`No layout data found for index ${i}`);const r=dg({panelConstraints:t,panelIndex:i,size:e});e!=r&&(o+=e-r,n[i]=r)}if(!cg(o,0))for(let i=0;i<t.length;i++){const e=n[i];ig(null!=e,`No layout data found for index ${i}`);const r=dg({panelConstraints:t,panelIndex:i,size:e+o});if(e!==r&&(o-=r-e,n[i]=r,cg(o,0)))break}return n}const Mg={getItem:e=>(Cg(Mg),Mg.getItem(e)),setItem:(e,t)=>{Cg(Mg),Mg.setItem(e,t)}},Dg={};function Tg({autoSaveId:e=null,children:t,className:n="",direction:r,forwardedRef:o,id:i=null,onLayout:a=null,keyboardResizeBy:s=null,storage:l=Mg,style:c,tagName:d="div",...u}){const h=Sp(i),f=vp(null),[p,g]=yp(null),[m,v]=yp([]),y=vp({}),x=vp(new Map),b=vp(0),w=vp({autoSaveId:e,direction:r,dragState:p,id:h,keyboardResizeBy:s,onLayout:a,storage:l}),k=vp({layout:m,panelDataArray:[],panelDataArrayChanged:!1});vp({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),pp(o,(()=>({getId:()=>w.current.id,getLayout:()=>{const{layout:e}=k.current;return e},setLayout:e=>{const{onLayout:t}=w.current,{layout:n,panelDataArray:r}=k.current,o=Og({layout:e,panelConstraints:r.map((e=>e.constraints))});xg(n,o)||(v(o),k.current.layout=o,t&&t(o),kg(r,o,y.current))}})),[]),kp((()=>{w.current.autoSaveId=e,w.current.direction=r,w.current.dragState=p,w.current.id=h,w.current.onLayout=a,w.current.storage=l})),yg({committedValuesRef:w,eagerValuesRef:k,groupId:h,layout:m,panelDataArray:k.current.panelDataArray,setLayout:v,panelGroupElement:f.current}),fp((()=>{const{panelDataArray:t}=k.current;if(e){if(0===m.length||m.length!==t.length)return;let n=Dg[e];null==n&&(n=function(e,t=10){let n=null;return(...r)=>{null!==n&&clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}}(Ig,100),Dg[e]=n);const r=[...t],o=new Map(x.current);n(e,r,o,m,l)}}),[e,m,l]),fp((()=>{}));const E=up((e=>{const{onLayout:t}=w.current,{layout:n,panelDataArray:r}=k.current;if(e.constraints.collapsible){const o=r.map((e=>e.constraints)),{collapsedSize:i=0,panelSize:a,pivotIndices:s}=_g(r,e,n);if(ig(null!=a,`Panel size not found for panel "${e.id}"`),!lg(a,i)){x.current.set(e.id,a);const l=ug({delta:Ag(r,e)===r.length-1?a-i:i-a,initialLayout:n,panelConstraints:o,pivotIndices:s,prevLayout:n,trigger:"imperative-api"});Eg(n,l)||(v(l),k.current.layout=l,t&&t(l),kg(r,l,y.current))}}}),[]),C=up(((e,t)=>{const{onLayout:n}=w.current,{layout:r,panelDataArray:o}=k.current;if(e.constraints.collapsible){const i=o.map((e=>e.constraints)),{collapsedSize:a=0,panelSize:s=0,minSize:l=0,pivotIndices:c}=_g(o,e,r),d=null!=t?t:l;if(lg(s,a)){const t=x.current.get(e.id),a=null!=t&&t>=d?t:d,l=ug({delta:Ag(o,e)===o.length-1?s-a:a-s,initialLayout:r,panelConstraints:i,pivotIndices:c,prevLayout:r,trigger:"imperative-api"});Eg(r,l)||(v(l),k.current.layout=l,n&&n(l),kg(o,l,y.current))}}}),[]),S=up((e=>{const{layout:t,panelDataArray:n}=k.current,{panelSize:r}=_g(n,e,t);return ig(null!=r,`Panel size not found for panel "${e.id}"`),r}),[]),N=up(((e,t)=>{const{panelDataArray:n}=k.current,r=Ag(n,e);return function({defaultSize:e,dragState:t,layout:n,panelData:r,panelIndex:o,precision:i=3}){const a=n[o];let s;return s=null==a?null!=e?e.toPrecision(i):"1":1===r.length?"1":a.toPrecision(i),{flexBasis:0,flexGrow:s,flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}({defaultSize:t,dragState:p,layout:m,panelData:n,panelIndex:r})}),[p,m]),j=up((e=>{const{layout:t,panelDataArray:n}=k.current,{collapsedSize:r=0,collapsible:o,panelSize:i}=_g(n,e,t);return ig(null!=i,`Panel size not found for panel "${e.id}"`),!0===o&&lg(i,r)}),[]),I=up((e=>{const{layout:t,panelDataArray:n}=k.current,{collapsedSize:r=0,collapsible:o,panelSize:i}=_g(n,e,t);return ig(null!=i,`Panel size not found for panel "${e.id}"`),!o||sg(i,r)>0}),[]),O=up((e=>{const{panelDataArray:t}=k.current;t.push(e),t.sort(((e,t)=>{const n=e.order,r=t.order;return null==n&&null==r?0:null==n?-1:null==r?1:n-r})),k.current.panelDataArrayChanged=!0}),[]);kp((()=>{if(k.current.panelDataArrayChanged){k.current.panelDataArrayChanged=!1;const{autoSaveId:e,onLayout:t,storage:n}=w.current,{layout:r,panelDataArray:o}=k.current;let i=null;if(e){const t=function(e,t,n){var r,o;return null!==(o=(null!==(r=jg(e,n))&&void 0!==r?r:{})[Ng(t)])&&void 0!==o?o:null}(e,o,n);t&&(x.current=new Map(Object.entries(t.expandToSizes)),i=t.layout)}null==i&&(i=function({panelDataArray:e}){const t=Array(e.length),n=e.map((e=>e.constraints));let r=0,o=100;for(let i=0;i<e.length;i++){const e=n[i];ig(e,`Panel constraints not found for index ${i}`);const{defaultSize:a}=e;null!=a&&(r++,t[i]=a,o-=a)}for(let i=0;i<e.length;i++){const a=n[i];ig(a,`Panel constraints not found for index ${i}`);const{defaultSize:s}=a;if(null!=s)continue;const l=o/(e.length-r);r++,t[i]=l,o-=l}return t}({panelDataArray:o}));const a=Og({layout:i,panelConstraints:o.map((e=>e.constraints))});xg(r,a)||(v(a),k.current.layout=a,t&&t(a),kg(o,a,y.current))}})),kp((()=>{const e=k.current;return()=>{e.layout=[]}}),[]);const M=up((e=>function(t){t.preventDefault();const n=f.current;if(!n)return()=>null;const{direction:r,dragState:o,id:i,keyboardResizeBy:a,onLayout:s}=w.current,{layout:l,panelDataArray:c}=k.current,{initialLayout:d}=null!=o?o:{},u=gg(i,e,n);let h=wg(t,e,r,o,a,n);if(0===h)return;const p="horizontal"===r;"rtl"===document.dir&&p&&(h=-h);const g=ug({delta:h,initialLayout:null!=d?d:l,panelConstraints:c.map((e=>e.constraints)),pivotIndices:u,prevLayout:l,trigger:Dp(t)?"keyboard":"mouse-or-touch"}),m=!Eg(l,g);(Tp(t)||Pp(t))&&b.current!=h&&(b.current=h,tg(e,m?0:p?h<0?Hp:Vp:h<0?$p:Wp)),m&&(v(g),k.current.layout=g,s&&s(g),kg(c,g,y.current))}),[]),D=up(((e,t)=>{const{onLayout:n}=w.current,{layout:r,panelDataArray:o}=k.current,i=o.map((e=>e.constraints)),{panelSize:a,pivotIndices:s}=_g(o,e,r);ig(null!=a,`Panel size not found for panel "${e.id}"`);const l=ug({delta:Ag(o,e)===o.length-1?a-t:t-a,initialLayout:r,panelConstraints:i,pivotIndices:s,prevLayout:r,trigger:"imperative-api"});Eg(r,l)||(v(l),k.current.layout=l,n&&n(l),kg(o,l,y.current))}),[]),T=up(((e,t)=>{const{layout:n,panelDataArray:r}=k.current,{collapsedSize:o=0,collapsible:i}=t,{collapsedSize:a=0,collapsible:s,maxSize:l=100,minSize:c=0}=e.constraints,{panelSize:d}=_g(r,e,n);null!=d&&(i&&s&&lg(d,o)?lg(o,a)||D(e,a):d<c?D(e,c):d>l&&D(e,l))}),[D]),P=up(((e,t)=>{const{direction:n}=w.current,{layout:r}=k.current;if(!f.current)return;const o=vg(e,f.current);ig(o,`Drag handle element not found for id "${e}"`);const i=bg(n,t);g({dragHandleId:e,dragHandleRect:o.getBoundingClientRect(),initialCursorPosition:i,initialLayout:r})}),[]),A=up((()=>{g(null)}),[]),_=up((e=>{const{panelDataArray:t}=k.current,n=Ag(t,e);n>=0&&(t.splice(n,1),delete y.current[e.id],k.current.panelDataArrayChanged=!0)}),[]),R=mp((()=>({collapsePanel:E,direction:r,dragState:p,expandPanel:C,getPanelSize:S,getPanelStyle:N,groupId:h,isPanelCollapsed:j,isPanelExpanded:I,reevaluatePanelConstraints:T,registerPanel:O,registerResizeHandle:M,resizePanel:D,startDragging:P,stopDragging:A,unregisterPanel:_,panelGroupElement:f.current})),[E,p,r,C,S,N,h,j,I,T,O,M,D,P,A,_]),z={display:"flex",flexDirection:"horizontal"===r?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return sp(wp.Provider,{value:R},sp(d,{...u,children:t,className:n,id:i,ref:f,style:{...z,...c},"data-panel-group":"","data-panel-group-direction":r,"data-panel-group-id":h}))}const Pg=dp(((e,t)=>sp(Tg,{...e,forwardedRef:t})));function Ag(e,t){return e.findIndex((e=>e===t||e.id===t.id))}function _g(e,t,n){const r=Ag(e,t),o=r===e.length-1?[r-1,r]:[r,r+1],i=n[r];return{...t.constraints,panelSize:i,pivotIndices:o}}function Rg({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:r,id:o,onDragging:i,style:a={},tabIndex:s=0,tagName:l="div",...c}){var d,u;const h=vp(null),f=vp({onDragging:i});fp((()=>{f.current.onDragging=i}));const p=hp(wp);if(null===p)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:g,groupId:m,registerResizeHandle:v,startDragging:y,stopDragging:x,panelGroupElement:b}=p,w=Sp(o),[k,E]=yp("inactive"),[C,S]=yp(!1),[N,j]=yp(null),I=vp({state:k});kp((()=>{I.current.state=k})),fp((()=>{if(n)j(null);else{const e=v(w);j((()=>e))}}),[n,w,v]);const O=null!==(d=null==r?void 0:r.coarse)&&void 0!==d?d:15,M=null!==(u=null==r?void 0:r.fine)&&void 0!==u?u:5;fp((()=>{if(n||null==N)return;const e=h.current;ig(e,"Element ref not attached");return function(e,t,n,r,o){var i;const{ownerDocument:a}=t,s={direction:n,element:t,hitAreaMargins:r,setResizeHandlerState:o},l=null!==(i=qp.get(a))&&void 0!==i?i:0;return qp.set(a,l+1),Xp.add(s),rg(),function(){var t;Kp.delete(e),Xp.delete(s);const n=null!==(t=qp.get(a))&&void 0!==t?t:1;qp.set(a,n-1),rg(),1===n&&qp.delete(a)}}(w,e,g,{coarse:O,fine:M},((e,t,n)=>{if(t)switch(e){case"down":{E("drag"),y(w,n);const{onDragging:e}=f.current;e&&e(!0);break}case"move":{const{state:e}=I.current;"drag"!==e&&E("hover"),N(n);break}case"up":{E("hover"),x();const{onDragging:e}=f.current;e&&e(!1);break}}else E("inactive")}))}),[O,g,n,M,v,w,N,y,x]),function({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:r}){fp((()=>{if(e||null==n||null==r)return;const o=vg(t,r);if(null==o)return;const i=e=>{if(!e.defaultPrevented)switch(e.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":e.preventDefault(),n(e);break;case"F6":{e.preventDefault();const n=o.getAttribute("data-panel-group-id");ig(n,`No group element found for id "${n}"`);const i=fg(n,r),a=pg(n,t,r);ig(null!==a,`No resize element found for id "${t}"`),i[e.shiftKey?a>0?a-1:i.length-1:a+1<i.length?a+1:0].focus();break}}};return o.addEventListener("keydown",i),()=>{o.removeEventListener("keydown",i)}}),[r,e,t,n])}({disabled:n,handleId:w,resizeHandler:N,panelGroupElement:b});return sp(l,{...c,children:e,className:t,id:o,onBlur:()=>S(!1),onFocus:()=>S(!0),ref:h,role:"separator",style:{touchAction:"none",userSelect:"none",...a},tabIndex:s,"data-panel-group-direction":g,"data-panel-group-id":m,"data-resize-handle":"","data-resize-handle-active":"drag"===k?"pointer":C?"keyboard":void 0,"data-resize-handle-state":k,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":w})}Tg.displayName="PanelGroup",Pg.displayName="forwardRef(PanelGroup)",Rg.displayName="PanelResizeHandle";const zg=e=>{const[t,n]=o.useState(0),r=d(ma);sa((()=>n((e=>e+1))),{delayMs:1e4,whenVisible:!0});const{data:i}=_t((async()=>_()||r.state!==va.OPEN?null:zo()),[t,r.state]);return x.jsxs("div",{className:"flex gap-3",children:[i&&x.jsx(Bg,{memory:i.memory}),i&&x.jsx(Fg,{cpu:i.cpu}),x.jsx(Lg,{connection:r.state})]})},Lg=({connection:e})=>x.jsx(b,{delayDuration:200,content:rt(e.toLowerCase()),children:x.jsxs("div",{children:[e===va.OPEN&&x.jsx(ss,{className:"w-4 h-4"}),e===va.CLOSED&&x.jsx(la,{className:"w-4 h-4"}),e===va.CONNECTING&&x.jsx(ca,{size:"small"}),e===va.CLOSING&&x.jsx(ca,{className:"text-destructive",size:"small"})]})}),Bg=({memory:e})=>{const{percent:t,total:n,used:r}=e,o=Math.round(t);return x.jsx(b,{delayDuration:200,content:x.jsxs("span",{children:[x.jsx("b",{children:"Memory:"})," ",Vg(r)," / ",Vg(n)," GB (",o,"%)"]}),children:x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx(js,{className:"w-4 h-4"}),x.jsx(Hg,{percent:o})]})})},Fg=({cpu:e})=>{const{percent:t}=e,n=Math.round(t);return x.jsx(b,{delayDuration:200,content:x.jsxs("span",{children:[x.jsx("b",{children:"CPU:"})," ",n,"%"]}),children:x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx(ps,{className:"w-4 h-4"}),x.jsx(Hg,{percent:n})]})})},Hg=({percent:e})=>x.jsx("div",{className:"h-3 w-20 bg-[var(--slate-4)] rounded-lg overflow-hidden border",children:x.jsx("div",{className:"h-full bg-primary",style:{width:`${e}%`}})});function Vg(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(e/1073741824)}const $g=()=>{const{selectedPanel:e}=pc(),{openApplication:t}=gc(),n=d(Lo);return x.jsxs("footer",{className:"h-10 py-2 bg-background flex items-center text-muted-foreground text-md pl-1 pr-4 border-t border-border select-none no-print text-sm shadow-[0_0_4px_1px_rgba(0,0,0,0.1)] z-50",children:[x.jsxs(Wg,{tooltip:"View errors",selected:"errors"===e,onClick:()=>t("errors"),children:[((e,t)=>{const n=mc[e];return x.jsx(n,{className:Mt("h-5 w-5",t)})})("errors",n>0?"text-destructive":""),x.jsx("span",{className:"ml-1 font-mono mt-[0.125rem]",children:n})]}),x.jsx("div",{className:"mx-auto"}),x.jsx(zg,{})]})},Wg=({children:e,tooltip:t,selected:n,className:r,...o})=>x.jsx(b,{content:t,side:"top",delayDuration:200,children:x.jsx("div",{className:Mt("h-full flex items-center p-2 text-sm mx-[1px] shadow-inset font-mono cursor-pointer rounded",!n&&"hover:bg-[var(--sage-3)]",n&&"bg-[var(--sage-4)]",r),...o,children:e})}),Ug=({children:e})=>{const{openModal:t,closeModal:n}=M();return x.jsx(Bo,{onClick:()=>t(x.jsx(Gg,{onClose:n})),children:e})},Yg={"😡":1,"🙁":2,"😐":3,"🙂":4,"😍":5},Gg=({onClose:e})=>x.jsx(j,{className:"w-fit",children:x.jsxs("form",{onSubmit:async t=>{t.preventDefault();const n=new FormData(t.target),r=n.get("rating"),o=n.get("message");fetch("https://marimo.io/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:r,message:o})}),e(),Q({title:"Feedback sent!",description:"Thank you for your feedback!"})},children:[x.jsxs(I,{children:[x.jsx(O,{children:"Send Feedback"}),x.jsxs(D,{children:["Let us know what you think about marimo! If you have a bug that you would like to report, please use the"," ",x.jsx("a",{href:ze.issuesPage,target:"_blank",rel:"noreferrer",className:"underline",children:"GitHub issue tracker"}),"."]}),x.jsx(D,{children:"Your feedback is anonymous and will help us improve marimo. Thank you!"})]}),x.jsxs("div",{className:"flex flex-col gap-6 py-4",children:[x.jsx("div",{className:"flex gap-5 justify-center",children:Object.entries(Yg).map((([e,t])=>x.jsxs("label",{className:"flex flex-col items-center select-none",children:[x.jsx("input",{type:"radio",className:"peer hidden",name:"rating",value:t,"aria-label":e},e),x.jsx("span",{className:"text-4xl peer-checked:opacity-100 opacity-40 cursor-pointer",children:e})]},e)))}),x.jsx(Fo,{id:"message",name:"message",autoFocus:!0,placeholder:"Your feedback",rows:5,required:!0,autoComplete:"off"})]}),x.jsxs(T,{children:[x.jsx(P,{"data-testid":"feedback-cancel-button",variant:"secondary",onClick:e,children:"Cancel"}),x.jsx(P,{"data-testid":"feedback-send-button","aria-label":"Save",variant:"default",type:"submit",children:"Send"})]})]})}),qg=()=>{const{selectedPanel:e}=pc(),{openApplication:t}=gc(),n=(e,t)=>{const n=mc[e];return x.jsx(n,{className:Mt("h-5 w-5",t)})};return x.jsxs("div",{className:"h-full py-4 px-1 flex flex-col items-start text-muted-foreground text-md select-none no-print text-sm z-50",children:[x.jsx(Kg,{tooltip:"View files",selected:"files"===e,onClick:()=>t("files"),children:n("files")}),x.jsx(Kg,{tooltip:"Explore variables",selected:"variables"===e,onClick:()=>t("variables"),children:n("variables")}),x.jsx(Kg,{tooltip:"Explore data sources",selected:"datasources"===e,onClick:()=>t("datasources"),children:n("datasources")}),x.jsx(Kg,{tooltip:"Explore dependencies",selected:"dependencies"===e,onClick:()=>t("dependencies"),children:n("dependencies")}),x.jsx(Kg,{tooltip:"View outline",selected:"outline"===e,onClick:()=>t("outline"),children:n("outline")}),x.jsx(Kg,{tooltip:"View live docs",selected:"documentation"===e,onClick:()=>t("documentation"),children:n("documentation")}),x.jsx(Kg,{tooltip:"Notebook logs",selected:"logs"===e,onClick:()=>t("logs"),children:n("logs")}),x.jsx(Kg,{tooltip:"Snippets",selected:"snippets"===e,onClick:()=>t("snippets"),children:n("snippets")}),x.jsx(Ug,{children:x.jsx(Kg,{tooltip:"Send feedback!",selected:!1,children:x.jsx(Is,{className:"h-5 w-5"})})})]})},Kg=({children:e,tooltip:t,selected:n,className:r,...o})=>x.jsx(b,{content:t,side:"right",delayDuration:200,children:x.jsx("div",{className:Mt("flex items-center p-2 text-sm mx-[1px] shadow-inset font-mono cursor-pointer rounded",!n&&"hover:bg-[var(--sage-3)]",n&&"bg-[var(--sage-4)]",r),...o,children:e})}),Xg=Ho.record(Ho.tuple([Ho.number(),Ho.number()]));let Zg=null;const Jg=({title:e,description:t,color:n,icon:r})=>x.jsxs("div",{className:"mx-6 my-6 flex flex-col gap-2",children:[x.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[r&&s.cloneElement(r,{className:"text-accent-foreground"}),x.jsx("span",{className:"mt-1 text-accent-foreground",children:e})]}),x.jsx("span",{className:"text-muted-foreground text-sm",children:t})]}),Qg=()=>{const e=Vo();return 0===e.length?x.jsx(Jg,{title:"No errors!",icon:x.jsx(Ps,{})}):x.jsx("div",{className:"flex flex-col overflow-auto",children:e.map((e=>x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-mono font-semibold bg-muted border-y px-2 py-1",children:x.jsx($o,{cellId:e.cellId})}),x.jsx("div",{className:"px-2",children:x.jsx(Wo,{errors:e.output.data},e.cellId)},e.cellId)]},e.cellId)))})},em=()=>{const e=d(Uo);if(0===e.items.length)return x.jsx(Jg,{title:"No outline",description:"Add markdown headings to your notebook to create an outline.",icon:x.jsx(Fs,{})});const t=new Map;return x.jsx("div",{className:"flex flex-col overflow-auto py-4 pl-2",children:e.items.map((e=>{const n=t.get(e.id)??0;return t.set(e.id,n+1),x.jsx("div",{className:Mt("px-2 py-1 cursor-pointer hover:bg-accent/50 hover:text-accent-foreground rounded-l",1===e.level&&"font-semibold",2===e.level&&"ml-3",3===e.level&&"ml-6",4===e.level&&"ml-9"),onClick:()=>((e,t)=>{const n=document.querySelectorAll(`[id="${CSS.escape(e)}"]`)[t];n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),n.classList.add("outline-item-highlight"),setTimeout((()=>{n.classList.remove("outline-item-highlight")}),3e3))})(e.id,n),children:e.name},e.id)}))})};function tm(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,r=0;r<e.length;r++)""!==(n=tm(e[r]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const{useDebugValue:nm}=s,{useSyncExternalStoreWithSelector:rm}=Yo,om=e=>e;function im(e,t=om,n){const r=rm(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return nm(r),r}const am=(e,t)=>{const n=Go(e),r=(e,r=t)=>im(n,e,r);return Object.assign(r,n),r};function sm(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}function lm(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const cm={passive:!1},dm={capture:!0,passive:!1};function um(e){e.stopImmediatePropagation()}function hm(e){e.preventDefault(),e.stopImmediatePropagation()}function fm(e){var t=e.document.documentElement,n=Fa(e).on("dragstart.drag",hm,dm);"onselectstart"in t?n.on("selectstart.drag",hm,dm):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function pm(e,t){var n=e.document.documentElement,r=Fa(e).on("dragstart.drag",null);t&&(r.on("click.drag",hm,dm),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const gm=e=>()=>e;function mm(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:a,y:s,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}function vm(e){return!e.ctrlKey&&!e.button}function ym(){return this.parentNode}function xm(e,t){return null==t?{x:e.x,y:e.y}:t}function bm(){return navigator.maxTouchPoints||"ontouchstart"in this}mm.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};const wm=e=>()=>e;function km(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Em(e){e.stopImmediatePropagation()}function Cm(e){e.preventDefault(),e.stopImmediatePropagation()}function Sm(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function Nm(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function jm(){return this.__zoom||Ha}function Im(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Om(){return navigator.maxTouchPoints||"ontouchstart"in this}function Mm(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}const Dm=o.createContext(null),Tm=Dm.Provider,Pm={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Am=Pm.error001();function _m(e,t){const n=o.useContext(Dm);if(null===n)throw new Error(Am);return im(n,e,t)}const Rm=()=>{const e=o.useContext(Dm);if(null===e)throw new Error(Am);return o.useMemo((()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy})),[e])},zm=e=>e.userSelectionActive?"none":"all";function Lm({position:e,children:t,className:n,style:r,...o}){const i=_m(zm),a=`${e}`.split("-");return s.createElement("div",{className:tm(["react-flow__panel",n,...a]),style:{...r,pointerEvents:i},...o},t)}function Bm({proOptions:e,position:t="bottom-right"}){return(null==e?void 0:e.hideAttribution)?null:s.createElement(Lm,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},s.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var Fm=o.memo((({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:a={},labelBgPadding:l=[2,4],labelBgBorderRadius:c=2,children:d,className:u,...h})=>{const f=o.useRef(null),[p,g]=o.useState({x:0,y:0,width:0,height:0}),m=tm(["react-flow__edge-textwrapper",u]);return o.useEffect((()=>{if(f.current){const e=f.current.getBBox();g({x:e.x,y:e.y,width:e.width,height:e.height})}}),[n]),void 0!==n&&n?s.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:m,visibility:p.width?"visible":"hidden",...h},i&&s.createElement("rect",{width:p.width+2*l[0],x:-l[0],y:-l[1],height:p.height+2*l[1],className:"react-flow__edge-textbg",style:a,rx:c,ry:c}),s.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:r},n),d):null}));const Hm=e=>({width:e.offsetWidth,height:e.offsetHeight}),Vm=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),$m=(e={x:0,y:0},t)=>({x:Vm(e.x,t[0][0],t[1][0]),y:Vm(e.y,t[0][1],t[1][1])}),Wm=(e,t,n)=>e<t?Vm(Math.abs(e-t),1,50)/50:e>n?-Vm(Math.abs(e-n),1,50)/50:0,Um=(e,t)=>[20*Wm(e.x,35,t.width-35),20*Wm(e.y,35,t.height-35)],Ym=e=>{var t;return(null==(t=e.getRootNode)?void 0:t.call(e))||(null==window?void 0:window.document)},Gm=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),qm=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Km=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Xm=e=>Zm(e.width)&&Zm(e.height)&&Zm(e.x)&&Zm(e.y),Zm=e=>!isNaN(e)&&isFinite(e),Jm=Symbol.for("internals"),Qm=["Enter"," ","Escape"];function ev(e){var t,n;const r=(e=>"nativeEvent"in e)(e)?e.nativeEvent:e,o=(null==(n=null==(t=r.composedPath)?void 0:t.call(r))?void 0:n[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(null==o?void 0:o.nodeName)||(null==o?void 0:o.hasAttribute("contenteditable"))||!!(null==o?void 0:o.closest(".nokey"))}const tv=e=>"clientX"in e,nv=(e,t)=>{var n,r;const o=tv(e),i=o?e.clientX:null==(n=e.touches)?void 0:n[0].clientX,a=o?e.clientY:null==(r=e.touches)?void 0:r[0].clientY;return{x:i-((null==t?void 0:t.left)??0),y:a-((null==t?void 0:t.top)??0)}},rv=()=>{var e;return"undefined"!=typeof navigator&&(null==(e=null==navigator?void 0:navigator.userAgent)?void 0:e.indexOf("Mac"))>=0},ov=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:f,interactionWidth:p=20})=>s.createElement(s.Fragment,null,s.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:f}),p&&s.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),o&&Zm(n)&&Zm(r)?s.createElement(Fm,{x:n,y:r,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);function iv(e,t,n){return void 0===n?n:r=>{const o=t().edges.find((t=>t.id===e));o&&n(r,{...o})}}function av({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,a=Math.abs(r-t)/2;return[i,r<t?r+a:r-a,o,a]}function sv({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:a,targetControlY:s}){const l=.125*e+.375*o+.375*a+.125*n,c=.125*t+.375*i+.375*s+.125*r;return[l,c,Math.abs(l-e),Math.abs(c-t)]}var lv,cv,dv,uv,hv,fv,pv,gv,mv,vv,yv,xv;function bv({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===yv.Left||e===yv.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function wv({sourceX:e,sourceY:t,sourcePosition:n=yv.Bottom,targetX:r,targetY:o,targetPosition:i=yv.Top}){const[a,s]=bv({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=bv({pos:i,x1:r,y1:o,x2:e,y2:t}),[d,u,h,f]=sv({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:s,targetControlX:l,targetControlY:c});return[`M${e},${t} C${a},${s} ${l},${c} ${r},${o}`,d,u,h,f]}ov.displayName="BaseEdge",(cv=lv||(lv={})).Strict="strict",cv.Loose="loose",(uv=dv||(dv={})).Free="free",uv.Vertical="vertical",uv.Horizontal="horizontal",(fv=hv||(hv={})).Partial="partial",fv.Full="full",(gv=pv||(pv={})).Bezier="default",gv.Straight="straight",gv.Step="step",gv.SmoothStep="smoothstep",gv.SimpleBezier="simplebezier",(vv=mv||(mv={})).Arrow="arrow",vv.ArrowClosed="arrowclosed",(xv=yv||(yv={})).Left="left",xv.Top="top",xv.Right="right",xv.Bottom="bottom";const kv=o.memo((({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=yv.Bottom,targetPosition:i=yv.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:p,markerStart:g,interactionWidth:m})=>{const[v,y,x]=wv({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return s.createElement(ov,{path:v,labelX:y,labelY:x,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:p,markerStart:g,interactionWidth:m})}));kv.displayName="SimpleBezierEdge";const Ev={[yv.Left]:{x:-1,y:0},[yv.Right]:{x:1,y:0},[yv.Top]:{x:0,y:-1},[yv.Bottom]:{x:0,y:1}},Cv=({source:e,sourcePosition:t=yv.Bottom,target:n})=>t===yv.Left||t===yv.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Sv=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Nv({sourceX:e,sourceY:t,sourcePosition:n=yv.Bottom,targetX:r,targetY:o,targetPosition:i=yv.Top,borderRadius:a=5,centerX:s,centerY:l,offset:c=20}){const[d,u,h,f,p]=function({source:e,sourcePosition:t=yv.Bottom,target:n,targetPosition:r=yv.Top,center:o,offset:i}){const a=Ev[t],s=Ev[r],l={x:e.x+a.x*i,y:e.y+a.y*i},c={x:n.x+s.x*i,y:n.y+s.y*i},d=Cv({source:l,sourcePosition:t,target:c}),u=0!==d.x?"x":"y",h=d[u];let f,p,g=[];const m={x:0,y:0},v={x:0,y:0},[y,x,b,w]=av({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[u]*s[u]==-1){f=o.x??y,p=o.y??x;const e=[{x:f,y:l.y},{x:f,y:c.y}],t=[{x:l.x,y:p},{x:c.x,y:p}];g=a[u]===h?"x"===u?e:t:"x"===u?t:e}else{const o=[{x:l.x,y:c.y}],d=[{x:c.x,y:l.y}];if(g="x"===u?a.x===h?d:o:a.y===h?o:d,t===r){const t=Math.abs(e[u]-n[u]);if(t<=i){const r=Math.min(i-1,i-t);a[u]===h?m[u]=(l[u]>e[u]?-1:1)*r:v[u]=(c[u]>n[u]?-1:1)*r}}if(t!==r){const e="x"===u?"y":"x",t=a[u]===s[e],n=l[e]>c[e],r=l[e]<c[e];(1===a[u]&&(!t&&n||t&&r)||1!==a[u]&&(!t&&r||t&&n))&&(g="x"===u?o:d)}const y={x:l.x+m.x,y:l.y+m.y},x={x:c.x+v.x,y:c.y+v.y};Math.max(Math.abs(y.x-g[0].x),Math.abs(x.x-g[0].x))>=Math.max(Math.abs(y.y-g[0].y),Math.abs(x.y-g[0].y))?(f=(y.x+x.x)/2,p=g[0].y):(f=g[0].x,p=(y.y+x.y)/2)}return[[e,{x:l.x+m.x,y:l.y+m.y},...g,{x:c.x+v.x,y:c.y+v.y},n],f,p,b,w]}({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:s,y:l},offset:c});return[d.reduce(((e,t,n)=>{let r="";return r=n>0&&n<d.length-1?function(e,t,n,r){const o=Math.min(Sv(e,t)/2,Sv(t,n)/2,r),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a)return`L ${i+o*(e.x<n.x?-1:1)},${a}Q ${i},${a} ${i},${a+o*(e.y<n.y?1:-1)}`;const s=e.x<n.x?1:-1;return`L ${i},${a+o*(e.y<n.y?-1:1)}Q ${i},${a} ${i+o*s},${a}`}(d[n-1],t,d[n+1],a):`${0===n?"M":"L"}${t.x} ${t.y}`,e+=r}),""),u,h,f,p]}const jv=o.memo((({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:h=yv.Bottom,targetPosition:f=yv.Top,markerEnd:p,markerStart:g,pathOptions:m,interactionWidth:v})=>{const[y,x,b]=Nv({sourceX:e,sourceY:t,sourcePosition:h,targetX:n,targetY:r,targetPosition:f,borderRadius:null==m?void 0:m.borderRadius,offset:null==m?void 0:m.offset});return s.createElement(ov,{path:y,labelX:x,labelY:b,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:p,markerStart:g,interactionWidth:v})}));jv.displayName="SmoothStepEdge";const Iv=o.memo((e=>{var t;return s.createElement(jv,{...e,pathOptions:o.useMemo((()=>{var t;return{borderRadius:0,offset:null==(t=e.pathOptions)?void 0:t.offset}}),[null==(t=e.pathOptions)?void 0:t.offset])})}));Iv.displayName="StepEdge";const Ov=o.memo((({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:f,interactionWidth:p})=>{const[g,m,v]=function({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,a,s]=av({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,a,s]}({sourceX:e,sourceY:t,targetX:n,targetY:r});return s.createElement(ov,{path:g,labelX:m,labelY:v,label:o,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:f,interactionWidth:p})}));function Mv(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function Dv({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case yv.Left:return[t-Mv(t-r,i),n];case yv.Right:return[t+Mv(r-t,i),n];case yv.Top:return[t,n-Mv(n-o,i)];case yv.Bottom:return[t,n+Mv(o-n,i)]}}function Tv({sourceX:e,sourceY:t,sourcePosition:n=yv.Bottom,targetX:r,targetY:o,targetPosition:i=yv.Top,curvature:a=.25}){const[s,l]=Dv({pos:n,x1:e,y1:t,x2:r,y2:o,c:a}),[c,d]=Dv({pos:i,x1:r,y1:o,x2:e,y2:t,c:a}),[u,h,f,p]=sv({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${s},${l} ${c},${d} ${r},${o}`,u,h,f,p]}Ov.displayName="StraightEdge";const Pv=o.memo((({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=yv.Bottom,targetPosition:i=yv.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:p,markerStart:g,pathOptions:m,interactionWidth:v})=>{const[y,x,b]=Tv({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:null==m?void 0:m.curvature});return s.createElement(ov,{path:y,labelX:x,labelY:b,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:p,markerStart:g,interactionWidth:v})}));Pv.displayName="BezierEdge";const Av=o.createContext(null),_v=Av.Provider;Av.Consumer;const Rv=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,zv=(e,t)=>{if(void 0===e)return"";if("string"==typeof e)return e;return`${t?`${t}__`:""}${Object.keys(e).sort().map((t=>`${t}=${e[t]}`)).join("&")}`},Lv=({x:e,y:t},[n,r,o],i,[a,s])=>{const l={x:(e-n)/o,y:(t-r)/o};return i?{x:a*Math.round(l.x/a),y:s*Math.round(l.y/s)}:l},Bv=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Fv=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},Hv=(e,t=[0,0])=>{if(0===e.length)return{x:0,y:0,width:0,height:0};return(({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}))(e.reduce(((e,n)=>{const{x:r,y:o}=Fv(n,t).positionAbsolute;return i=e,a=Gm({x:r,y:o,width:n.width||0,height:n.height||0}),{x:Math.min(i.x,a.x),y:Math.min(i.y,a.y),x2:Math.max(i.x2,a.x2),y2:Math.max(i.y2,a.y2)};var i,a}),{x:1/0,y:1/0,x2:-1/0,y2:-1/0}))},Vv=(e,t,[n,r,o]=[0,0,1],i=!1,a=!1,s=[0,0])=>{const l={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},c=[];return e.forEach((e=>{const{width:t,height:n,selectable:r=!0,hidden:o=!1}=e;if(a&&!r||o)return!1;const{positionAbsolute:d}=Fv(e,s),u={x:d.x,y:d.y,width:t||0,height:n||0},h=Km(l,u);(void 0===t||void 0===n||null===t||null===n||i&&h>0||h>=(t||0)*(n||0)||e.dragging)&&c.push(e)})),c},$v=(e,t)=>{const n=e.map((e=>e.id));return t.filter((e=>n.includes(e.source)||n.includes(e.target)))},Wv=(e,t,n,r,o,i=.1)=>{const a=t/(e.width*(1+i)),s=n/(e.height*(1+i)),l=Math.min(a,s),c=Vm(l,r,o);return{x:t/2-(e.x+e.width/2)*c,y:n/2-(e.y+e.height/2)*c,zoom:c}},Uv=(e,t=0)=>e.transition().duration(t);function Yv(e,t,n,r){return(t[n]||[]).reduce(((t,o)=>{var i,a;return`${e.id}-${o.id}-${n}`!==r&&t.push({id:o.id||null,type:n,nodeId:e.id,x:((null==(i=e.positionAbsolute)?void 0:i.x)??0)+o.x+o.width/2,y:((null==(a=e.positionAbsolute)?void 0:a.y)??0)+o.y+o.height/2}),t}),[])}const Gv={source:null,target:null,sourceHandle:null,targetHandle:null},qv=()=>({handleDomNode:null,isValid:!1,connection:Gv,endHandle:null});function Kv(e,t,n,r,o,i,a){const s="target"===o,l=a.querySelector(`.react-flow__handle[data-id="${null==e?void 0:e.nodeId}-${null==e?void 0:e.id}-${null==e?void 0:e.type}"]`),c={...qv(),handleDomNode:l};if(l){const e=Xv(void 0,l),o=l.getAttribute("data-nodeid"),a=l.getAttribute("data-handleid"),d=l.classList.contains("connectable"),u=l.classList.contains("connectableend"),h={source:s?o:n,sourceHandle:s?a:r,target:s?n:o,targetHandle:s?r:a};c.connection=h;d&&u&&(t===lv.Strict?s&&"source"===e||!s&&"target"===e:o!==n||a!==r)&&(c.endHandle={nodeId:o,handleId:a,type:e},c.isValid=i(h))}return c}function Xv(e,t){return e||((null==t?void 0:t.classList.contains("target"))?"target":(null==t?void 0:t.classList.contains("source"))?"source":null)}function Zv(e){null==e||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Jv(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Qv({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:a,isValidConnection:s,edgeUpdaterType:l,onEdgeUpdateEnd:c}){const d=Ym(e.target),{connectionMode:u,domNode:h,autoPanOnConnect:f,connectionRadius:p,onConnectStart:g,panBy:m,getNodes:v,cancelConnection:y}=i();let x,b=0;const{x:w,y:k}=nv(e),E=null==d?void 0:d.elementFromPoint(w,k),C=Xv(l,E),S=null==h?void 0:h.getBoundingClientRect();if(!S||!C)return;let N,j=nv(e,S),I=!1,O=null,M=!1,D=null;const T=function({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce(((e,o)=>{if(o[Jm]){const{handleBounds:i}=o[Jm];let a=[],s=[];i&&(a=Yv(o,i,"source",`${t}-${n}-${r}`),s=Yv(o,i,"target",`${t}-${n}-${r}`)),e.push(...a,...s)}return e}),[])}({nodes:v(),nodeId:n,handleId:t,handleType:C}),P=()=>{if(!f)return;const[e,t]=Um(j,S);m({x:e,y:t}),b=requestAnimationFrame(P)};function A(e){const{transform:r}=i();j=nv(e,S);const{handle:l,validHandleResult:c}=function(e,t,n,r,o,i){const{x:a,y:s}=nv(e),l=t.elementsFromPoint(a,s).find((e=>e.classList.contains("react-flow__handle")));if(l){const e=l.getAttribute("data-nodeid");if(e){const t=Xv(void 0,l),r=l.getAttribute("data-handleid"),a=i({nodeId:e,id:r,type:t});if(a){const i=o.find((n=>n.nodeId===e&&n.type===t&&n.id===r));return{handle:{id:r,type:t,nodeId:e,x:(null==i?void 0:i.x)||n.x,y:(null==i?void 0:i.y)||n.y},validHandleResult:a}}}}let c=[],d=1/0;if(o.forEach((e=>{const t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=r){const n=i(e);t<=d&&(t<d?c=[{handle:e,validHandleResult:n}]:t===d&&c.push({handle:e,validHandleResult:n}),d=t)}})),!c.length)return{handle:null,validHandleResult:qv()};if(1===c.length)return c[0];const u=c.some((({validHandleResult:e})=>e.isValid)),h=c.some((({handle:e})=>"target"===e.type));return c.find((({handle:e,validHandleResult:t})=>h?"target"===e.type:!u||t.isValid))||c[0]}(e,d,Lv(j,r,!1,[1,1]),p,T,(e=>Kv(e,u,n,t,o?"target":"source",s,d)));if(x=l,I||(P(),I=!0),D=c.handleDomNode,O=c.connection,M=c.isValid,a({connectionPosition:x&&M?Bv({x:x.x,y:x.y},r):j,connectionStatus:Jv(!!x,M),connectionEndHandle:c.endHandle}),!x&&!M&&!D)return Zv(N);O.source!==O.target&&D&&(Zv(N),N=D,D.classList.add("connecting","react-flow__handle-connecting"),D.classList.toggle("valid",M),D.classList.toggle("react-flow__handle-valid",M))}function _(e){var t,n;(x||D)&&O&&M&&(null==r||r(O)),null==(n=(t=i()).onConnectEnd)||n.call(t,e),l&&(null==c||c(e)),Zv(N),y(),cancelAnimationFrame(b),I=!1,M=!1,O=null,D=null,d.removeEventListener("mousemove",A),d.removeEventListener("mouseup",_),d.removeEventListener("touchmove",A),d.removeEventListener("touchend",_)}a({connectionPosition:j,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:C,connectionStartHandle:{nodeId:n,handleId:t,type:C},connectionEndHandle:null}),null==g||g(e,{nodeId:n,handleId:t,handleType:C}),d.addEventListener("mousemove",A),d.addEventListener("mouseup",_),d.addEventListener("touchmove",A),d.addEventListener("touchend",_)}const ey=()=>!0,ty=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),ny=o.forwardRef((({type:e="source",position:t=yv.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:a=!0,id:l,onConnect:c,children:d,className:u,onMouseDown:h,onTouchStart:f,...p},g)=>{var m,v;const y=l||null,x="target"===e,b=Rm(),w=o.useContext(Av),{connectOnClick:k,noPanClassName:E}=_m(ty,sm),{connecting:C,clickConnecting:S}=_m(((e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:a}=r;return{connecting:(null==o?void 0:o.nodeId)===e&&(null==o?void 0:o.handleId)===t&&(null==o?void 0:o.type)===n||(null==i?void 0:i.nodeId)===e&&(null==i?void 0:i.handleId)===t&&(null==i?void 0:i.type)===n,clickConnecting:(null==a?void 0:a.nodeId)===e&&(null==a?void 0:a.handleId)===t&&(null==a?void 0:a.type)===n}})(w,y,e),sm);w||null==(v=(m=b.getState()).onError)||v.call(m,"010",Pm.error010());const N=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=b.getState(),o={...t,...e};if(r){const{edges:e,setEdges:t}=b.getState();t(((e,t)=>{if(!e.source||!e.target)return t;let n;var r;return n="id"in(r=e)&&"source"in r&&"target"in r?{...e}:{...e,id:Rv(e)},((e,t)=>t.some((t=>!(t.source!==e.source||t.target!==e.target||t.sourceHandle!==e.sourceHandle&&(t.sourceHandle||e.sourceHandle)||t.targetHandle!==e.targetHandle&&(t.targetHandle||e.targetHandle)))))(n,t)?t:t.concat(n)})(o,e))}null==n||n(o),null==c||c(o)},j=e=>{if(!w)return;const t=tv(e);i&&(t&&0===e.button||!t)&&Qv({event:e,handleId:y,nodeId:w,onConnect:N,isTarget:x,getState:b.getState,setState:b.setState,isValidConnection:n||b.getState().isValidConnection||ey}),t?null==h||h(e):null==f||f(e)};return s.createElement("div",{"data-handleid":y,"data-nodeid":w,"data-handlepos":t,"data-id":`${w}-${y}-${e}`,className:tm(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",E,u,{source:!x,target:x,connectable:r,connectablestart:i,connectableend:a,connecting:S,connectionindicator:r&&(i&&!C||a&&C)}]),onMouseDown:j,onTouchStart:j,onClick:k?t=>{const{onClickConnectStart:r,onClickConnectEnd:o,connectionClickStartHandle:a,connectionMode:s,isValidConnection:l}=b.getState();if(!w||!a&&!i)return;if(!a)return null==r||r(t,{nodeId:w,handleId:y,handleType:e}),void b.setState({connectionClickStartHandle:{nodeId:w,type:e,handleId:y}});const c=Ym(t.target),d=n||l||ey,{connection:u,isValid:h}=Kv({nodeId:w,id:y,type:e},s,a.nodeId,a.handleId||null,a.type,d,c);h&&N(u),null==o||o(t),b.setState({connectionClickStartHandle:null})}:void 0,ref:g,...p},d)}));ny.displayName="Handle";var ry=o.memo(ny);const oy=({data:e,isConnectable:t,targetPosition:n=yv.Top,sourcePosition:r=yv.Bottom})=>s.createElement(s.Fragment,null,s.createElement(ry,{type:"target",position:n,isConnectable:t}),null==e?void 0:e.label,s.createElement(ry,{type:"source",position:r,isConnectable:t}));oy.displayName="DefaultNode";var iy=o.memo(oy);const ay=({data:e,isConnectable:t,sourcePosition:n=yv.Bottom})=>s.createElement(s.Fragment,null,null==e?void 0:e.label,s.createElement(ry,{type:"source",position:n,isConnectable:t}));ay.displayName="InputNode";var sy=o.memo(ay);const ly=({data:e,isConnectable:t,targetPosition:n=yv.Top})=>s.createElement(s.Fragment,null,s.createElement(ry,{type:"target",position:n,isConnectable:t}),null==e?void 0:e.label);ly.displayName="OutputNode";var cy=o.memo(ly);const dy=()=>null;dy.displayName="GroupNode";const uy=e=>({selectedNodes:e.getNodes().filter((e=>e.selected)),selectedEdges:e.edges.filter((e=>e.selected)).map((e=>({...e})))}),hy=e=>e.id;function fy(e,t){return sm(e.selectedNodes.map(hy),t.selectedNodes.map(hy))&&sm(e.selectedEdges.map(hy),t.selectedEdges.map(hy))}const py=o.memo((({onSelectionChange:e})=>{const t=Rm(),{selectedNodes:n,selectedEdges:r}=_m(uy,fy);return o.useEffect((()=>{const o={nodes:n,edges:r};null==e||e(o),t.getState().onSelectionChange.forEach((e=>e(o)))}),[n,r,e]),null}));py.displayName="SelectionListener";const gy=e=>!!e.onSelectionChange;function my({onSelectionChange:e}){const t=_m(gy);return e||t?s.createElement(py,{onSelectionChange:e}):null}const vy=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function yy(e,t){o.useEffect((()=>{void 0!==e&&t(e)}),[e])}function xy(e,t,n){o.useEffect((()=>{void 0!==t&&n({[e]:t})}),[t])}const by=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:a,onConnectEnd:s,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:h,edgesFocusable:f,edgesUpdatable:p,elevateNodesOnSelect:g,minZoom:m,maxZoom:v,nodeExtent:y,onNodesChange:x,onEdgesChange:b,elementsSelectable:w,connectionMode:k,snapGrid:E,snapToGrid:C,translateExtent:S,connectOnClick:N,defaultEdgeOptions:j,fitView:I,fitViewOptions:O,onNodesDelete:M,onEdgesDelete:D,onNodeDrag:T,onNodeDragStart:P,onNodeDragStop:A,onSelectionDrag:_,onSelectionDragStart:R,onSelectionDragStop:z,noPanClassName:L,nodeOrigin:B,rfId:F,autoPanOnConnect:H,autoPanOnNodeDrag:V,onError:$,connectionRadius:W,isValidConnection:U,nodeDragThreshold:Y})=>{const{setNodes:G,setEdges:q,setDefaultNodesAndEdges:K,setMinZoom:X,setMaxZoom:Z,setTranslateExtent:J,setNodeExtent:Q,reset:ee}=_m(vy,sm),te=Rm();return o.useEffect((()=>{const e=null==r?void 0:r.map((e=>({...e,...j})));return K(n,e),()=>{ee()}}),[]),xy("defaultEdgeOptions",j,te.setState),xy("connectionMode",k,te.setState),xy("onConnect",i,te.setState),xy("onConnectStart",a,te.setState),xy("onConnectEnd",s,te.setState),xy("onClickConnectStart",l,te.setState),xy("onClickConnectEnd",c,te.setState),xy("nodesDraggable",d,te.setState),xy("nodesConnectable",u,te.setState),xy("nodesFocusable",h,te.setState),xy("edgesFocusable",f,te.setState),xy("edgesUpdatable",p,te.setState),xy("elementsSelectable",w,te.setState),xy("elevateNodesOnSelect",g,te.setState),xy("snapToGrid",C,te.setState),xy("snapGrid",E,te.setState),xy("onNodesChange",x,te.setState),xy("onEdgesChange",b,te.setState),xy("connectOnClick",N,te.setState),xy("fitViewOnInit",I,te.setState),xy("fitViewOnInitOptions",O,te.setState),xy("onNodesDelete",M,te.setState),xy("onEdgesDelete",D,te.setState),xy("onNodeDrag",T,te.setState),xy("onNodeDragStart",P,te.setState),xy("onNodeDragStop",A,te.setState),xy("onSelectionDrag",_,te.setState),xy("onSelectionDragStart",R,te.setState),xy("onSelectionDragStop",z,te.setState),xy("noPanClassName",L,te.setState),xy("nodeOrigin",B,te.setState),xy("rfId",F,te.setState),xy("autoPanOnConnect",H,te.setState),xy("autoPanOnNodeDrag",V,te.setState),xy("onError",$,te.setState),xy("connectionRadius",W,te.setState),xy("isValidConnection",U,te.setState),xy("nodeDragThreshold",Y,te.setState),yy(e,G),yy(t,q),yy(m,X),yy(v,Z),yy(S,J),yy(y,Q),null},wy={display:"none"},ky={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ey="react-flow__node-desc",Cy="react-flow__edge-desc",Sy="react-flow__aria-live",Ny=e=>e.ariaLiveMessage;function jy({rfId:e}){const t=_m(Ny);return s.createElement("div",{id:`${Sy}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ky},t)}function Iy({rfId:e,disableKeyboardA11y:t}){return s.createElement(s.Fragment,null,s.createElement("div",{id:`${Ey}-${e}`,style:wy},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),s.createElement("div",{id:`${Cy}-${e}`,style:wy},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&s.createElement(jy,{rfId:e}))}var Oy=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=o.useState(!1),i=o.useRef(!1),a=o.useRef(new Set([])),[s,l]=o.useMemo((()=>{if(null!==e){const t=(Array.isArray(e)?e:[e]).filter((e=>"string"==typeof e)).map((e=>e.split("+"))),n=t.reduce(((e,t)=>e.concat(...t)),[]);return[t,n]}return[[],[]]}),[e]);return o.useEffect((()=>{const n="undefined"!=typeof document?document:null,o=(null==t?void 0:t.target)||n;if(null!==e){const e=e=>{i.current=e.ctrlKey||e.metaKey||e.shiftKey;if((!i.current||i.current&&!t.actInsideInputWithModifier)&&ev(e))return!1;const n=Dy(e.code,l);a.current.add(e[n]),My(s,a.current,!1)&&(e.preventDefault(),r(!0))},n=e=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&ev(e))return!1;const n=Dy(e.code,l);My(s,a.current,!0)?(r(!1),a.current.clear()):a.current.delete(e[n]),"Meta"===e.key&&a.current.clear(),i.current=!1},c=()=>{a.current.clear(),r(!1)};return null==o||o.addEventListener("keydown",e),null==o||o.addEventListener("keyup",n),window.addEventListener("blur",c),()=>{null==o||o.removeEventListener("keydown",e),null==o||o.removeEventListener("keyup",n),window.removeEventListener("blur",c)}}}),[e,r]),n};function My(e,t,n){return e.filter((e=>n||e.length===t.size)).some((e=>e.every((e=>t.has(e)))))}function Dy(e,t){return t.includes(e)?"code":"key"}function Ty(e,t,n,r){var o,i;const a=e.parentNode||e.parentId;if(!a)return n;const s=t.get(a),l=Fv(s,r);return Ty(s,t,{x:(n.x??0)+l.x,y:(n.y??0)+l.y,z:((null==(o=s[Jm])?void 0:o.z)??0)>(n.z??0)?(null==(i=s[Jm])?void 0:i.z)??0:n.z??0},r)}function Py(e,t,n){e.forEach((r=>{var o;const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||(null==n?void 0:n[r.id])){const{x:i,y:a,z:s}=Ty(r,e,{...r.position,z:(null==(o=r[Jm])?void 0:o.z)??0},t);r.positionAbsolute={x:i,y:a},r[Jm].z=s,(null==n?void 0:n[r.id])&&(r[Jm].isParent=!0)}}))}function Ay(e,t,n,r){const o=new Map,i={},a=r?1e3:0;return e.forEach((e=>{var n;const r=(Zm(e.zIndex)?e.zIndex:0)+(e.selected?a:0),s=t.get(e.id),l={...e,positionAbsolute:{x:e.position.x,y:e.position.y}},c=e.parentNode||e.parentId;c&&(i[c]=!0);const d=(null==s?void 0:s.type)&&(null==s?void 0:s.type)!==e.type;Object.defineProperty(l,Jm,{enumerable:!1,value:{handleBounds:d||null==(n=null==s?void 0:s[Jm])?void 0:n.handleBounds,z:r}}),o.set(e.id,l)})),Py(o,n,i),o}function _y(e,t={}){const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:a,d3Zoom:s,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:u}=e(),h=t.initial&&!c&&d;if(s&&l&&(h||!t.initial)){const e=n().filter((e=>{var n;const r=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return(null==(n=t.nodes)?void 0:n.length)?r&&t.nodes.some((t=>t.id===e.id)):r})),c=e.every((e=>e.width&&e.height));if(e.length>0&&c){const n=Hv(e,u),{x:c,y:d,zoom:h}=Wv(n,r,o,t.minZoom??i,t.maxZoom??a,t.padding??.1),f=Ha.translate(c,d).scale(h);return"number"==typeof t.duration&&t.duration>0?s.transform(Uv(l,t.duration),f):s.transform(l,f),!0}}return!1}function Ry(e,t){return e.forEach((e=>{const n=t.get(e.id);n&&t.set(n.id,{...n,[Jm]:n[Jm],selected:e.selected})})),new Map(t)}function zy(e,t){return t.map((t=>{const n=e.find((e=>e.id===t.id));return n&&(t.selected=n.selected),t}))}function Ly({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:a,onEdgesChange:s,hasDefaultNodes:l,hasDefaultEdges:c}=n();(null==e?void 0:e.length)&&(l&&r({nodeInternals:Ry(e,o)}),null==a||a(e)),(null==t?void 0:t.length)&&(c&&r({edges:zy(t,i)}),null==s||s(t))}const By=()=>{},Fy={zoomIn:By,zoomOut:By,zoomTo:By,getZoom:()=>1,setViewport:By,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:By,fitBounds:By,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Hy=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Vy=()=>{const e=Rm(),{d3Zoom:t,d3Selection:n}=_m(Hy,sm);return o.useMemo((()=>n&&t?{zoomIn:e=>t.scaleBy(Uv(n,null==e?void 0:e.duration),1.2),zoomOut:e=>t.scaleBy(Uv(n,null==e?void 0:e.duration),1/1.2),zoomTo:(e,r)=>t.scaleTo(Uv(n,null==r?void 0:r.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(r,o)=>{const[i,a,s]=e.getState().transform,l=Ha.translate(r.x??i,r.y??a).scale(r.zoom??s);t.transform(Uv(n,null==o?void 0:o.duration),l)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>_y(e.getState,t),setCenter:(r,o,i)=>{const{width:a,height:s,maxZoom:l}=e.getState(),c=void 0!==(null==i?void 0:i.zoom)?i.zoom:l,d=a/2-r*c,u=s/2-o*c,h=Ha.translate(d,u).scale(c);t.transform(Uv(n,null==i?void 0:i.duration),h)},fitBounds:(r,o)=>{const{width:i,height:a,minZoom:s,maxZoom:l}=e.getState(),{x:c,y:d,zoom:u}=Wv(r,i,a,s,l,(null==o?void 0:o.padding)??.1),h=Ha.translate(c,d).scale(u);t.transform(Uv(n,null==o?void 0:o.duration),h)},project:t=>{const{transform:n,snapToGrid:r,snapGrid:o}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Lv(t,n,r,o)},screenToFlowPosition:t=>{const{transform:n,snapToGrid:r,snapGrid:o,domNode:i}=e.getState();if(!i)return t;const{x:a,y:s}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-s};return Lv(l,n,r,o)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:i}=r.getBoundingClientRect(),a=Bv(t,n);return{x:a.x+o,y:a.y+i}},viewportInitialized:!0}:Fy),[t,n])};function $y(){const e=Vy(),t=Rm(),n=o.useCallback((()=>t.getState().getNodes().map((e=>({...e})))),[]),r=o.useCallback((e=>t.getState().nodeInternals.get(e)),[]),i=o.useCallback((()=>{const{edges:e=[]}=t.getState();return e.map((e=>({...e})))}),[]),a=o.useCallback((e=>{const{edges:n=[]}=t.getState();return n.find((t=>t.id===e))}),[]),s=o.useCallback((e=>{const{getNodes:n,setNodes:r,hasDefaultNodes:o,onNodesChange:i}=t.getState(),a=n(),s="function"==typeof e?e(a):e;if(o)r(s);else if(i){i(0===s.length?a.map((e=>({type:"remove",id:e.id}))):s.map((e=>({item:e,type:"reset"}))))}}),[]),l=o.useCallback((e=>{const{edges:n=[],setEdges:r,hasDefaultEdges:o,onEdgesChange:i}=t.getState(),a="function"==typeof e?e(n):e;if(o)r(a);else if(i){i(0===a.length?n.map((e=>({type:"remove",id:e.id}))):a.map((e=>({item:e,type:"reset"}))))}}),[]),c=o.useCallback((e=>{const n=Array.isArray(e)?e:[e],{getNodes:r,setNodes:o,hasDefaultNodes:i,onNodesChange:a}=t.getState();if(i){o([...r(),...n])}else if(a){a(n.map((e=>({item:e,type:"add"}))))}}),[]),d=o.useCallback((e=>{const n=Array.isArray(e)?e:[e],{edges:r=[],setEdges:o,hasDefaultEdges:i,onEdgesChange:a}=t.getState();if(i)o([...r,...n]);else if(a){a(n.map((e=>({item:e,type:"add"}))))}}),[]),u=o.useCallback((()=>{const{getNodes:e,edges:n=[],transform:r}=t.getState(),[o,i,a]=r;return{nodes:e().map((e=>({...e}))),edges:n.map((e=>({...e}))),viewport:{x:o,y:i,zoom:a}}}),[]),h=o.useCallback((({nodes:e,edges:n})=>{const{nodeInternals:r,getNodes:o,edges:i,hasDefaultNodes:a,hasDefaultEdges:s,onNodesDelete:l,onEdgesDelete:c,onNodesChange:d,onEdgesChange:u}=t.getState(),h=(e||[]).map((e=>e.id)),f=(n||[]).map((e=>e.id)),p=o().reduce(((e,t)=>{const n=t.parentNode||t.parentId,r=!h.includes(t.id)&&n&&e.find((e=>e.id===n));return("boolean"!=typeof t.deletable||t.deletable)&&(h.includes(t.id)||r)&&e.push(t),e}),[]),g=i.filter((e=>"boolean"!=typeof e.deletable||e.deletable)),m=g.filter((e=>f.includes(e.id)));if(p||m){const e=$v(p,g),n=[...m,...e],o=n.reduce(((e,t)=>(e.includes(t.id)||e.push(t.id),e)),[]);if((s||a)&&(s&&t.setState({edges:i.filter((e=>!o.includes(e.id)))}),a&&(p.forEach((e=>{r.delete(e.id)})),t.setState({nodeInternals:new Map(r)}))),o.length>0&&(null==c||c(n),u&&u(o.map((e=>({id:e,type:"remove"}))))),p.length>0&&(null==l||l(p),d)){d(p.map((e=>({id:e.id,type:"remove"}))))}}}),[]),f=o.useCallback((e=>{const n=Xm(e),r=n?null:t.getState().nodeInternals.get(e.id);if(!n&&!r)return[null,null,n];return[n?e:qm(r),r,n]}),[]),p=o.useCallback(((e,n=!0,r)=>{const[o,i,a]=f(e);return o?(r||t.getState().getNodes()).filter((e=>{if(!(a||e.id!==i.id&&e.positionAbsolute))return!1;const t=qm(e),r=Km(t,o);return n&&r>0||r>=o.width*o.height})):[]}),[]),g=o.useCallback(((e,t,n=!0)=>{const[r]=f(e);if(!r)return!1;const o=Km(r,t);return n&&o>0||o>=r.width*r.height}),[]);return o.useMemo((()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:a,setNodes:s,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:h,getIntersectingNodes:p,isNodeIntersecting:g})),[e,n,r,i,a,s,l,c,d,u,h,p,g])}const Wy={actInsideInputWithModifier:!1};const Uy={position:"absolute",width:"100%",height:"100%",top:0,left:0},Yy=e=>({x:e.x,y:e.y,zoom:e.k}),Gy=(e,t)=>e.target.closest(`.${t}`),qy=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),Ky=e=>{const t=e.ctrlKey&&rv()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},Xy=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Zy=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:a=!0,panOnScroll:l=!1,panOnScrollSpeed:c=.5,panOnScrollMode:d=dv.Free,zoomOnDoubleClick:u=!0,elementsSelectable:h,panOnDrag:f=!0,defaultViewport:p,translateExtent:g,minZoom:m,maxZoom:v,zoomActivationKeyCode:y,preventScrolling:x=!0,children:b,noWheelClassName:w,noPanClassName:k})=>{const E=o.useRef(),C=Rm(),S=o.useRef(!1),N=o.useRef(!1),j=o.useRef(null),I=o.useRef({x:0,y:0,zoom:0}),{d3Zoom:O,d3Selection:M,d3ZoomHandler:D,userSelectionActive:T}=_m(Xy,sm),P=Oy(y),A=o.useRef(0),_=o.useRef(!1),R=o.useRef();return function(e){const t=Rm();o.useEffect((()=>{let n;const r=()=>{var n,r;if(!e.current)return;const o=Hm(e.current);0!==o.height&&0!==o.width||null==(r=(n=t.getState()).onError)||r.call(n,"004",Pm.error004()),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver((()=>r())),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}),[])}(j),o.useEffect((()=>{if(j.current){const e=j.current.getBoundingClientRect(),t=function(){var e,t,n,r=Sm,o=Nm,i=Mm,a=Im,s=Om,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,u=Ua,h=Wa("start","zoom","end"),f=500,p=150,g=0,m=10;function v(e){e.property("__zoom",jm).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",N).filter(s).on("touchstart.zoom",j).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new Va(t,e.x,e.y)}function x(e,t,n){var r=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return r===e.x&&o===e.y?e:new Va(e.k,r,o)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function w(e,t,n,r){e.on("start.zoom",(function(){k(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){k(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,i=arguments,a=k(e,i).event(r),s=o.apply(e,i),l=null==n?b(s):"function"==typeof n?n.apply(e,i):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,h="function"==typeof t?t.apply(e,i):t,f=u(d.invert(l).concat(c/d.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new Va(n,l[0]-t[0]*n,l[1]-t[1]*n)}a.zoom(null,e)}}))}function k(e,t,n){return!n&&e.__zooming||new E(e,t)}function E(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function C(e,...t){if(r.apply(this,arguments)){var n=k(this,t).event(e),o=this.__zoom,s=Math.max(l[0],Math.min(l[1],o.k*Math.pow(2,a.apply(this,arguments)))),d=lm(e);if(n.wheel)n.mouse[0][0]===d[0]&&n.mouse[0][1]===d[1]||(n.mouse[1]=o.invert(n.mouse[0]=d)),clearTimeout(n.wheel);else{if(o.k===s)return;n.mouse=[d,o.invert(d)],$a(this),n.start()}Cm(e),n.wheel=setTimeout((function(){n.wheel=null,n.end()}),p),n.zoom("mouse",i(x(y(o,s),n.mouse[0],n.mouse[1]),n.extent,c))}}function S(e,...t){if(!n&&r.apply(this,arguments)){var o=e.currentTarget,a=k(this,t,!0).event(e),s=Fa(e.view).on("mousemove.zoom",(function(e){if(Cm(e),!a.moved){var t=e.clientX-d,n=e.clientY-u;a.moved=t*t+n*n>g}a.event(e).zoom("mouse",i(x(a.that.__zoom,a.mouse[0]=lm(e,o),a.mouse[1]),a.extent,c))}),!0).on("mouseup.zoom",(function(e){s.on("mousemove.zoom mouseup.zoom",null),pm(e.view,a.moved),Cm(e),a.event(e).end()}),!0),l=lm(e,o),d=e.clientX,u=e.clientY;fm(e.view),Em(e),a.mouse=[l,this.__zoom.invert(l)],$a(this),a.start()}}function N(e,...t){if(r.apply(this,arguments)){var n=this.__zoom,a=lm(e.changedTouches?e.changedTouches[0]:e,this),s=n.invert(a),l=n.k*(e.shiftKey?.5:2),u=i(x(y(n,l),a,s),o.apply(this,t),c);Cm(e),d>0?Fa(this).transition().duration(d).call(w,u,a,e):Fa(this).call(v.transform,u,a,e)}}function j(n,...o){if(r.apply(this,arguments)){var i,a,s,l,c=n.touches,d=c.length,u=k(this,o,n.changedTouches.length===d).event(n);for(Em(n),a=0;a<d;++a)l=[l=lm(s=c[a],this),this.__zoom.invert(l),s.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,i=!0,u.taps=1+!!e);e&&(e=clearTimeout(e)),i&&(u.taps<2&&(t=l[0],e=setTimeout((function(){e=null}),f)),$a(this),u.start())}}function I(e,...t){if(this.__zooming){var n,r,o,a,s=k(this,t).event(e),l=e.changedTouches,d=l.length;for(Cm(e),n=0;n<d;++n)o=lm(r=l[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=o:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=o);if(r=s.that.__zoom,s.touch1){var u=s.touch0[0],h=s.touch0[1],f=s.touch1[0],p=s.touch1[1],g=(g=f[0]-u[0])*g+(g=f[1]-u[1])*g,m=(m=p[0]-h[0])*m+(m=p[1]-h[1])*m;r=y(r,Math.sqrt(g/m)),o=[(u[0]+f[0])/2,(u[1]+f[1])/2],a=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!s.touch0)return;o=s.touch0[0],a=s.touch0[1]}s.zoom("touch",i(x(r,o,a),s.extent,c))}}function O(e,...r){if(this.__zooming){var o,i,a=k(this,r).event(e),s=e.changedTouches,l=s.length;for(Em(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),f),o=0;o<l;++o)i=s[o],a.touch0&&a.touch0[2]===i.identifier?delete a.touch0:a.touch1&&a.touch1[2]===i.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(i=lm(i,this),Math.hypot(t[0]-i[0],t[1]-i[1])<m)){var c=Fa(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return v.transform=function(e,t,n,r){var o=e.selection?e.selection():e;o.property("__zoom",jm),e!==o?w(e,t,n,r):o.interrupt().each((function(){k(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},v.scaleBy=function(e,t,n,r){v.scaleTo(e,(function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)}),n,r)},v.scaleTo=function(e,t,n,r){v.transform(e,(function(){var e=o.apply(this,arguments),r=this.__zoom,a=null==n?b(e):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(a),l="function"==typeof t?t.apply(this,arguments):t;return i(x(y(r,l),a,s),e,c)}),n,r)},v.translateBy=function(e,t,n,r){v.transform(e,(function(){return i(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)}),null,r)},v.translateTo=function(e,t,n,r,a){v.transform(e,(function(){var e=o.apply(this,arguments),a=this.__zoom,s=null==r?b(e):"function"==typeof r?r.apply(this,arguments):r;return i(Ha.translate(s[0],s[1]).scale(a.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)}),r,a)},E.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Fa(this.that).datum();h.call(e,this.that,new km(e,{sourceEvent:this.sourceEvent,target:v,type:e,transform:this.that.__zoom,dispatch:h}),t)}},v.wheelDelta=function(e){return arguments.length?(a="function"==typeof e?e:wm(+e),v):a},v.filter=function(e){return arguments.length?(r="function"==typeof e?e:wm(!!e),v):r},v.touchable=function(e){return arguments.length?(s="function"==typeof e?e:wm(!!e),v):s},v.extent=function(e){return arguments.length?(o="function"==typeof e?e:wm([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),v):o},v.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],v):[l[0],l[1]]},v.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],v):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},v.constrain=function(e){return arguments.length?(i=e,v):i},v.duration=function(e){return arguments.length?(d=+e,v):d},v.interpolate=function(e){return arguments.length?(u=e,v):u},v.on=function(){var e=h.on.apply(h,arguments);return e===h?v:e},v.clickDistance=function(e){return arguments.length?(g=(e=+e)*e,v):Math.sqrt(g)},v.tapDistance=function(e){return arguments.length?(m=+e,v):m},v}().scaleExtent([m,v]).translateExtent(g),n=Fa(j.current).call(t),r=Ha.translate(p.x,p.y).scale(Vm(p.zoom,m,v)),o=[[0,0],[e.width,e.height]],i=t.constrain()(r,o,g);t.transform(n,i),t.wheelDelta(Ky),C.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[i.x,i.y,i.k],domNode:j.current.closest(".react-flow")})}}),[]),o.useEffect((()=>{M&&O&&(!l||P||T?void 0!==D&&M.on("wheel.zoom",(function(e,t){if(!x&&"wheel"===e.type&&!e.ctrlKey||Gy(e,w))return null;e.preventDefault(),D.call(this,e,t)}),{passive:!1}):M.on("wheel.zoom",(r=>{if(Gy(r,w))return!1;r.preventDefault(),r.stopImmediatePropagation();const o=M.property("__zoom").k||1;if(r.ctrlKey&&a){const e=lm(r),t=Ky(r),n=o*Math.pow(2,t);return void O.scaleTo(M,n,e,r)}const i=1===r.deltaMode?20:1;let s=d===dv.Vertical?0:r.deltaX*i,l=d===dv.Horizontal?0:r.deltaY*i;!rv()&&r.shiftKey&&d!==dv.Vertical&&(s=r.deltaY*i,l=0),O.translateBy(M,-s/o*c,-l/o*c,{internal:!0});const u=Yy(M.property("__zoom")),{onViewportChangeStart:h,onViewportChange:f,onViewportChangeEnd:p}=C.getState();clearTimeout(R.current),_.current||(_.current=!0,null==t||t(r,u),null==h||h(u)),_.current&&(null==e||e(r,u),null==f||f(u),R.current=setTimeout((()=>{null==n||n(r,u),null==p||p(u),_.current=!1}),150))}),{passive:!1}))}),[T,l,d,M,O,D,P,a,x,w,t,e,n]),o.useEffect((()=>{O&&O.on("start",(e=>{var n,r;if(!e.sourceEvent||e.sourceEvent.internal)return null;A.current=null==(n=e.sourceEvent)?void 0:n.button;const{onViewportChangeStart:o}=C.getState(),i=Yy(e.transform);S.current=!0,I.current=i,"mousedown"===(null==(r=e.sourceEvent)?void 0:r.type)&&C.setState({paneDragging:!0}),null==o||o(i),null==t||t(e.sourceEvent,i)}))}),[O,t]),o.useEffect((()=>{O&&(T&&!S.current?O.on("zoom",null):T||O.on("zoom",(t=>{var n;const{onViewportChange:o}=C.getState();if(C.setState({transform:[t.transform.x,t.transform.y,t.transform.k]}),N.current=!(!r||!qy(f,A.current??0)),(e||o)&&!(null==(n=t.sourceEvent)?void 0:n.internal)){const n=Yy(t.transform);null==o||o(n),null==e||e(t.sourceEvent,n)}})))}),[T,O,e,f,r]),o.useEffect((()=>{O&&O.on("end",(e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;const{onViewportChangeEnd:t}=C.getState();if(S.current=!1,C.setState({paneDragging:!1}),r&&qy(f,A.current??0)&&!N.current&&r(e.sourceEvent),N.current=!1,(n||t)&&(o=I.current,i=e.transform,o.x!==i.x||o.y!==i.y||o.zoom!==i.k)){const r=Yy(e.transform);I.current=r,clearTimeout(E.current),E.current=setTimeout((()=>{null==t||t(r),null==n||n(e.sourceEvent,r)}),l?150:0)}var o,i}))}),[O,l,f,n,r]),o.useEffect((()=>{O&&O.filter((e=>{const t=P||i,n=a&&e.ctrlKey;if((!0===f||Array.isArray(f)&&f.includes(1))&&1===e.button&&"mousedown"===e.type&&(Gy(e,"react-flow__node")||Gy(e,"react-flow__edge")))return!0;if(!(f||t||l||u||a))return!1;if(T)return!1;if(!u&&"dblclick"===e.type)return!1;if(Gy(e,w)&&"wheel"===e.type)return!1;if(Gy(e,k)&&("wheel"!==e.type||l&&"wheel"===e.type&&!P))return!1;if(!a&&e.ctrlKey&&"wheel"===e.type)return!1;if(!t&&!l&&!n&&"wheel"===e.type)return!1;if(!f&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(f)&&!f.includes(e.button)&&"mousedown"===e.type)return!1;const r=Array.isArray(f)&&f.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&r}))}),[T,O,i,a,l,u,f,h,P]),s.createElement("div",{className:"react-flow__renderer",ref:j,style:Uy},b)},Jy=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Qy(){const{userSelectionActive:e,userSelectionRect:t}=_m(Jy,sm);return e&&t?s.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function ex(e,t){const n=t.parentNode||t.parentId,r=e.find((e=>e.id===n));if(r){const e=t.position.x+t.width-r.width,n=t.position.y+t.height-r.height;if(e>0||n>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,e>0&&(r.style.width+=e),n>0&&(r.style.height+=n),t.position.x<0){const e=Math.abs(t.position.x);r.position.x=r.position.x-e,r.style.width+=e,t.position.x=0}if(t.position.y<0){const e=Math.abs(t.position.y);r.position.y=r.position.y-e,r.style.height+=e,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function tx(e,t){if(e.some((e=>"reset"===e.type)))return e.filter((e=>"reset"===e.type)).map((e=>e.item));const n=e.filter((e=>"add"===e.type)).map((e=>e.item));return t.reduce(((t,n)=>{const r=e.filter((e=>e.id===n.id));if(0===r.length)return t.push(n),t;const o={...n};for(const e of r)if(e)switch(e.type){case"select":o.selected=e.selected;break;case"position":void 0!==e.position&&(o.position=e.position),void 0!==e.positionAbsolute&&(o.positionAbsolute=e.positionAbsolute),void 0!==e.dragging&&(o.dragging=e.dragging),o.expandParent&&ex(t,o);break;case"dimensions":void 0!==e.dimensions&&(o.width=e.dimensions.width,o.height=e.dimensions.height),void 0!==e.updateStyle&&(o.style={...o.style||{},...e.dimensions}),"boolean"==typeof e.resizing&&(o.resizing=e.resizing),o.expandParent&&ex(t,o);break;case"remove":return t}return t.push(o),t}),n)}function nx(e,t){return tx(e,t)}const rx=(e,t)=>({id:e,type:"select",selected:t});function ox(e,t){return e.reduce(((e,n)=>{const r=t.includes(n.id);return!n.selected&&r?(n.selected=!0,e.push(rx(n.id,!0))):n.selected&&!r&&(n.selected=!1,e.push(rx(n.id,!1))),e}),[])}const ix=(e,t)=>n=>{n.target===t.current&&(null==e||e(n))},ax=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),sx=o.memo((({isSelecting:e,selectionMode:t=hv.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:u,onPaneMouseLeave:h,children:f})=>{const p=o.useRef(null),g=Rm(),m=o.useRef(0),v=o.useRef(0),y=o.useRef(),{userSelectionActive:x,elementsSelectable:b,dragging:w}=_m(ax,sm),k=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),m.current=0,v.current=0},E=e=>{null==a||a(e),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},C=c?e=>c(e):void 0,S=b&&(e||x);return s.createElement("div",{className:tm(["react-flow__pane",{dragging:w,selection:e}]),onClick:S?void 0:ix(E,p),onContextMenu:ix((e=>{Array.isArray(n)&&(null==n?void 0:n.includes(2))?e.preventDefault():null==l||l(e)}),p),onWheel:ix(C,p),onMouseEnter:S?void 0:d,onMouseDown:S?t=>{const{resetSelectedElements:n,domNode:o}=g.getState();if(y.current=null==o?void 0:o.getBoundingClientRect(),!b||!e||0!==t.button||t.target!==p.current||!y.current)return;const{x:i,y:a}=nv(t,y.current);n(),g.setState({userSelectionRect:{width:0,height:0,startX:i,startY:a,x:i,y:a}}),null==r||r(t)}:void 0,onMouseMove:S?n=>{const{userSelectionRect:r,nodeInternals:o,edges:i,transform:a,onNodesChange:s,onEdgesChange:l,nodeOrigin:c,getNodes:d}=g.getState();if(!e||!y.current||!r)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const u=nv(n,y.current),h=r.startX??0,f=r.startY??0,p={...r,x:u.x<h?u.x:h,y:u.y<f?u.y:f,width:Math.abs(u.x-h),height:Math.abs(u.y-f)},x=d(),b=Vv(o,p,a,t===hv.Partial,!0,c),w=$v(b,i).map((e=>e.id)),k=b.map((e=>e.id));if(m.current!==k.length){m.current=k.length;const e=ox(x,k);e.length&&(null==s||s(e))}if(v.current!==w.length){v.current=w.length;const e=ox(i,w);e.length&&(null==l||l(e))}g.setState({userSelectionRect:p})}:u,onMouseUp:S?e=>{if(0!==e.button)return;const{userSelectionRect:t}=g.getState();!x&&t&&e.target===p.current&&(null==E||E(e)),g.setState({nodesSelectionActive:m.current>0}),k(),null==i||i(e)}:void 0,onMouseLeave:S?e=>{x&&(g.setState({nodesSelectionActive:m.current>0}),null==i||i(e)),k()}:h,ref:p,style:Uy},f,s.createElement(Qy,null))}));function lx(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return!!r&&(!!r.selected||lx(r,t))}function cx(e,t,n){let r=e;do{if(null==r?void 0:r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function dx(e,t,n,r){return Array.from(e.values()).filter((n=>(n.selected||n.id===r)&&(!n.parentNode||n.parentId||!lx(n,e))&&(n.draggable||t&&void 0===n.draggable))).map((e=>{var t,r;return{id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-((null==(t=e.positionAbsolute)?void 0:t.x)??0),y:n.y-((null==(r=e.positionAbsolute)?void 0:r.y)??0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}}))}function ux(e,t,n,r,o=[0,0],i){const a=function(e,t){return t&&"parent"!==t?[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]:t}(e,e.extent||r);let s=a;const l=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&l&&"parent"!==e.extent){const t=n.get(l),{x:r,y:i}=Fv(t,o).positionAbsolute;s=[[e.extent[0][0]+r,e.extent[0][1]+i],[e.extent[1][0]+r,e.extent[1][1]+i]]}}else if(l&&e.width&&e.height){const t=n.get(l),{x:r,y:i}=Fv(t,o).positionAbsolute;s=t&&Zm(r)&&Zm(i)&&Zm(t.width)&&Zm(t.height)?[[r+e.width*o[0],i+e.height*o[1]],[r+t.width-e.width+e.width*o[0],i+t.height-e.height+e.height*o[1]]]:s}else null==i||i("005",Pm.error005()),s=a;let c={x:0,y:0};if(l){const e=n.get(l);c=Fv(e,o).positionAbsolute}const d=s&&"parent"!==s?$m(t,s):t;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function hx({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map((e=>({...n.get(e.id),position:e.position,positionAbsolute:e.positionAbsolute})));return[e?r.find((t=>t.id===e)):r[0],r]}sx.displayName="Pane";const fx=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),a=t.getBoundingClientRect(),s=a.width*r[0],l=a.height*r[1];return i.map((e=>{const t=e.getBoundingClientRect();return{id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-a.left-s)/n,y:(t.top-a.top-l)/n,...Hm(e)}}))};function px(e,t,n){return void 0===n?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function gx({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:a,nodeInternals:s,onError:l}=t.getState(),c=s.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&a)&&(i({nodes:[c],edges:[]}),requestAnimationFrame((()=>{var e;return null==(e=null==r?void 0:r.current)?void 0:e.blur()}))):o([e])):null==l||l("012",Pm.error012(e))}function mx(e){return(t,n,r)=>null==e?void 0:e(t,r)}function vx({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:a,selectNodesOnDrag:s}){const l=Rm(),[c,d]=o.useState(!1),u=o.useRef([]),h=o.useRef({x:null,y:null}),f=o.useRef(0),p=o.useRef(null),g=o.useRef({x:0,y:0}),m=o.useRef(null),v=o.useRef(!1),y=o.useRef(!1),x=function(){const e=Rm();return o.useCallback((({sourceEvent:t})=>{const{transform:n,snapGrid:r,snapToGrid:o}=e.getState(),i=t.touches?t.touches[0].clientX:t.clientX,a=t.touches?t.touches[0].clientY:t.clientY,s={x:(i-n[0])/n[2],y:(a-n[1])/n[2]};return{xSnapped:o?r[0]*Math.round(s.x/r[0]):s.x,ySnapped:o?r[1]*Math.round(s.y/r[1]):s.y,...s}}),[])}();return o.useEffect((()=>{if(null==e?void 0:e.current){const o=Fa(e.current),c=({x:e,y:t})=>{const{nodeInternals:n,onNodeDrag:r,onSelectionDrag:o,updateNodePositions:a,nodeExtent:s,snapGrid:c,snapToGrid:f,nodeOrigin:p,onError:g}=l.getState();h.current={x:e,y:t};let v=!1,y={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&s){const e=Hv(u.current,p);y=Gm(e)}if(u.current=u.current.map((r=>{const o={x:e-r.distance.x,y:t-r.distance.y};f&&(o.x=c[0]*Math.round(o.x/c[0]),o.y=c[1]*Math.round(o.y/c[1]));const i=[[s[0][0],s[0][1]],[s[1][0],s[1][1]]];u.current.length>1&&s&&!r.extent&&(i[0][0]=r.positionAbsolute.x-y.x+s[0][0],i[1][0]=r.positionAbsolute.x+(r.width??0)-y.x2+s[1][0],i[0][1]=r.positionAbsolute.y-y.y+s[0][1],i[1][1]=r.positionAbsolute.y+(r.height??0)-y.y2+s[1][1]);const a=ux(r,o,n,i,p,g);return v=v||r.position.x!==a.position.x||r.position.y!==a.position.y,r.position=a.position,r.positionAbsolute=a.positionAbsolute,r})),!v)return;a(u.current,!0,!0),d(!0);const x=i?r:mx(o);if(x&&m.current){const[e,t]=hx({nodeId:i,dragItems:u.current,nodeInternals:n});x(m.current,e,t)}},b=()=>{if(!p.current)return;const[e,t]=Um(g.current,p.current);if(0!==e||0!==t){const{transform:n,panBy:r}=l.getState();h.current.x=(h.current.x??0)-e/n[2],h.current.y=(h.current.y??0)-t/n[2],r({x:e,y:t})&&c(h.current)}f.current=requestAnimationFrame(b)},w=t=>{var n;const{nodeInternals:r,multiSelectionActive:o,nodesDraggable:c,unselectNodesAndEdges:d,onNodeDragStart:f,onSelectionDragStart:p}=l.getState();y.current=!0;const g=i?f:mx(p);s&&a||o||!i||(null==(n=r.get(i))?void 0:n.selected)||d(),i&&a&&s&&gx({id:i,store:l,nodeRef:e});const m=x(t);if(h.current=m,u.current=dx(r,c,m,i),g&&u.current){const[e,n]=hx({nodeId:i,dragItems:u.current,nodeInternals:r});g(t.sourceEvent,e,n)}};if(!t){const t=function(){var e,t,n,r,o=vm,i=ym,a=xm,s=bm,l={},c=Wa("start","drag","end"),d=0,u=0;function h(e){e.on("mousedown.drag",f).filter(s).on("touchstart.drag",m).on("touchmove.drag",v,cm).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(a,s){if(!r&&o.call(this,a,s)){var l=x(this,i.call(this,a,s),a,s,"mouse");l&&(Fa(a.view).on("mousemove.drag",p,dm).on("mouseup.drag",g,dm),fm(a.view),um(a),n=!1,e=a.clientX,t=a.clientY,l("start",a))}}function p(r){if(hm(r),!n){var o=r.clientX-e,i=r.clientY-t;n=o*o+i*i>u}l.mouse("drag",r)}function g(e){Fa(e.view).on("mousemove.drag mouseup.drag",null),pm(e.view,n),hm(e),l.mouse("end",e)}function m(e,t){if(o.call(this,e,t)){var n,r,a=e.changedTouches,s=i.call(this,e,t),l=a.length;for(n=0;n<l;++n)(r=x(this,s,e,t,a[n].identifier,a[n]))&&(um(e),r("start",e,a[n]))}}function v(e){var t,n,r=e.changedTouches,o=r.length;for(t=0;t<o;++t)(n=l[r[t].identifier])&&(hm(e),n("drag",e,r[t]))}function y(e){var t,n,o=e.changedTouches,i=o.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(n=l[o[t].identifier])&&(um(e),n("end",e,o[t]))}function x(e,t,n,r,o,i){var s,u,f,p=c.copy(),g=lm(i||n,t);if(null!=(f=a.call(e,new mm("beforestart",{sourceEvent:n,target:h,identifier:o,active:d,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),r)))return s=f.x-g[0]||0,u=f.y-g[1]||0,function n(i,a,c){var m,v=g;switch(i){case"start":l[o]=n,m=d++;break;case"end":delete l[o],--d;case"drag":g=lm(c||a,t),m=d}p.call(i,e,new mm(i,{sourceEvent:a,subject:f,target:h,identifier:o,active:m,x:g[0]+s,y:g[1]+u,dx:g[0]-v[0],dy:g[1]-v[1],dispatch:p}),r)}}return h.filter=function(e){return arguments.length?(o="function"==typeof e?e:gm(!!e),h):o},h.container=function(e){return arguments.length?(i="function"==typeof e?e:gm(e),h):i},h.subject=function(e){return arguments.length?(a="function"==typeof e?e:gm(e),h):a},h.touchable=function(e){return arguments.length?(s="function"==typeof e?e:gm(!!e),h):s},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,h):Math.sqrt(u)},h}().on("start",(e=>{const{domNode:t,nodeDragThreshold:n}=l.getState();0===n&&w(e);const r=x(e);h.current=r,p.current=(null==t?void 0:t.getBoundingClientRect())||null,g.current=nv(e.sourceEvent,p.current)})).on("drag",(e=>{var t,n;const r=x(e),{autoPanOnNodeDrag:o,nodeDragThreshold:i}=l.getState();if(!v.current&&y.current&&o&&(v.current=!0,b()),!y.current){const o=r.xSnapped-((null==(t=null==h?void 0:h.current)?void 0:t.x)??0),a=r.ySnapped-((null==(n=null==h?void 0:h.current)?void 0:n.y)??0);Math.sqrt(o*o+a*a)>i&&w(e)}(h.current.x!==r.xSnapped||h.current.y!==r.ySnapped)&&u.current&&y.current&&(m.current=e.sourceEvent,g.current=nv(e.sourceEvent,p.current),c(r))})).on("end",(e=>{if(y.current&&(d(!1),v.current=!1,y.current=!1,cancelAnimationFrame(f.current),u.current)){const{updateNodePositions:t,nodeInternals:n,onNodeDragStop:r,onSelectionDragStop:o}=l.getState(),a=i?r:mx(o);if(t(u.current,!1,!1),a){const[t,r]=hx({nodeId:i,dragItems:u.current,nodeInternals:n});a(e.sourceEvent,t,r)}}})).filter((t=>{const o=t.target;return!t.button&&(!n||!cx(o,`.${n}`,e))&&(!r||cx(o,r,e))}));return o.call(t),()=>{o.on(".drag",null)}}o.on(".drag",null)}}),[e,t,n,r,a,l,i,s,x]),c}function yx(){const e=Rm();return o.useCallback((t=>{const{nodeInternals:n,nodeExtent:r,updateNodePositions:o,getNodes:i,snapToGrid:a,snapGrid:s,onError:l,nodesDraggable:c}=e.getState(),d=i().filter((e=>e.selected&&(e.draggable||c&&void 0===e.draggable))),u=a?s[0]:5,h=a?s[1]:5,f=t.isShiftPressed?4:1,p=t.x*u*f,g=t.y*h*f;o(d.map((e=>{if(e.positionAbsolute){const t={x:e.positionAbsolute.x+p,y:e.positionAbsolute.y+g};a&&(t.x=s[0]*Math.round(t.x/s[0]),t.y=s[1]*Math.round(t.y/s[1]));const{positionAbsolute:o,position:i}=ux(e,t,n,r,void 0,l);e.position=i,e.positionAbsolute=o}return e})),!0,!1)}),[])}const xx={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var bx=e=>{const t=({id:t,type:n,data:r,xPos:i,yPos:a,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:h,onMouseMove:f,onMouseLeave:p,onContextMenu:g,onDoubleClick:m,style:v,className:y,isDraggable:x,isSelectable:b,isConnectable:w,isFocusable:k,selectNodesOnDrag:E,sourcePosition:C,targetPosition:S,hidden:N,resizeObserver:j,dragHandle:I,zIndex:O,isParent:M,noDragClassName:D,noPanClassName:T,initialized:P,disableKeyboardA11y:A,ariaLabel:_,rfId:R,hasHandleBounds:z})=>{const L=Rm(),B=o.useRef(null),F=o.useRef(null),H=o.useRef(C),V=o.useRef(S),$=o.useRef(n),W=b||x||u||h||f||p,U=yx(),Y=px(t,L.getState,h),G=px(t,L.getState,f),q=px(t,L.getState,p),K=px(t,L.getState,g),X=px(t,L.getState,m);o.useEffect((()=>()=>{F.current&&(null==j||j.unobserve(F.current),F.current=null)}),[]),o.useEffect((()=>{if(B.current&&!N){const e=B.current;P&&z&&F.current===e||(F.current&&(null==j||j.unobserve(F.current)),null==j||j.observe(e),F.current=e)}}),[N,P,z]),o.useEffect((()=>{const e=$.current!==n,r=H.current!==C,o=V.current!==S;B.current&&(e||r||o)&&(e&&($.current=n),r&&(H.current=C),o&&(V.current=S),L.getState().updateNodeDimensions([{id:t,nodeElement:B.current,forceUpdate:!0}]))}),[t,n,C,S]);const Z=vx({nodeRef:B,disabled:N||!x,noDragClassName:D,handleSelector:I,nodeId:t,isSelectable:b,selectNodesOnDrag:E});return N?null:s.createElement("div",{className:tm(["react-flow__node",`react-flow__node-${n}`,{[T]:x},y,{selected:d,selectable:b,parent:M,dragging:Z}]),ref:B,style:{zIndex:O,transform:`translate(${l}px,${c}px)`,pointerEvents:W?"all":"none",visibility:P?"visible":"hidden",...v},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:Y,onMouseMove:G,onMouseLeave:q,onContextMenu:K,onClick:e=>{const{nodeDragThreshold:n}=L.getState();if(b&&(!E||!x||n>0)&&gx({id:t,store:L,nodeRef:B}),u){const n=L.getState().nodeInternals.get(t);n&&u(e,{...n})}},onDoubleClick:X,onKeyDown:k?e=>{if(!ev(e)&&!A)if(Qm.includes(e.key)&&b){const n="Escape"===e.key;gx({id:t,store:L,unselect:n,nodeRef:B})}else x&&d&&Object.prototype.hasOwnProperty.call(xx,e.key)&&(L.setState({ariaLiveMessage:`Moved selected node ${e.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~a}`}),U({x:xx[e.key].x,y:xx[e.key].y,isShiftPressed:e.shiftKey}))}:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":A?void 0:`${Ey}-${R}`,"aria-label":_},s.createElement(_v,{value:t},s.createElement(e,{id:t,data:r,type:n,xPos:i,yPos:a,selected:d,isConnectable:w,sourcePosition:C,targetPosition:S,dragging:Z,dragHandle:I,zIndex:O})))};return t.displayName="NodeWrapper",o.memo(t)};const wx=e=>{const t=e.getNodes().filter((e=>e.selected));return{...Hv(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};var kx=o.memo((function({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Rm(),{width:i,height:a,x:l,y:c,transformString:d,userSelectionActive:u}=_m(wx,sm),h=yx(),f=o.useRef(null);if(o.useEffect((()=>{var e;n||null==(e=f.current)||e.focus({preventScroll:!0})}),[n]),vx({nodeRef:f}),u||!i||!a)return null;const p=e?t=>{const n=r.getState().getNodes().filter((e=>e.selected));e(t,n)}:void 0;return s.createElement("div",{className:tm(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d}},s.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(xx,e.key)&&h({x:xx[e.key].x,y:xx[e.key].y,isShiftPressed:e.shiftKey})},style:{width:i,height:a,top:c,left:l}}))}));const Ex=e=>e.nodesSelectionActive,Cx=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:l,deleteKeyCode:c,onMove:d,onMoveStart:u,onMoveEnd:h,selectionKeyCode:f,selectionOnDrag:p,selectionMode:g,onSelectionStart:m,onSelectionEnd:v,multiSelectionKeyCode:y,panActivationKeyCode:x,zoomActivationKeyCode:b,elementsSelectable:w,zoomOnScroll:k,zoomOnPinch:E,panOnScroll:C,panOnScrollSpeed:S,panOnScrollMode:N,zoomOnDoubleClick:j,panOnDrag:I,defaultViewport:O,translateExtent:M,minZoom:D,maxZoom:T,preventScrolling:P,onSelectionContextMenu:A,noWheelClassName:_,noPanClassName:R,disableKeyboardA11y:z})=>{const L=_m(Ex),B=Oy(f),F=Oy(x),H=F||I,V=F||C,$=B||p&&!0!==H;return(({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=Rm(),{deleteElements:r}=$y(),i=Oy(e,Wy),a=Oy(t);o.useEffect((()=>{if(i){const{edges:e,getNodes:t}=n.getState(),o=t().filter((e=>e.selected)),i=e.filter((e=>e.selected));r({nodes:o,edges:i}),n.setState({nodesSelectionActive:!1})}}),[i]),o.useEffect((()=>{n.setState({multiSelectionActive:a})}),[a])})({deleteKeyCode:c,multiSelectionKeyCode:y}),s.createElement(Zy,{onMove:d,onMoveStart:u,onMoveEnd:h,onPaneContextMenu:a,elementsSelectable:w,zoomOnScroll:k,zoomOnPinch:E,panOnScroll:V,panOnScrollSpeed:S,panOnScrollMode:N,zoomOnDoubleClick:j,panOnDrag:!B&&H,defaultViewport:O,translateExtent:M,minZoom:D,maxZoom:T,zoomActivationKeyCode:b,preventScrolling:P,noWheelClassName:_,noPanClassName:R},s.createElement(sx,{onSelectionStart:m,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:l,panOnDrag:H,isSelecting:!!$,selectionMode:g},e,L&&s.createElement(kx,{onSelectionContextMenu:A,noPanClassName:R,disableKeyboardA11y:z})))};Cx.displayName="FlowRenderer";var Sx=o.memo(Cx);function Nx(e){return{...{input:bx(e.input||sy),default:bx(e.default||iy),output:bx(e.output||cy),group:bx(e.group||dy)},...Object.keys(e).filter((e=>!["input","default","output","group"].includes(e))).reduce(((t,n)=>(t[n]=bx(e[n]||iy),t)),{})}}const jx=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Ix=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:a,onError:l}=_m(jx,sm),c=(d=e.onlyRenderVisibleElements,_m(o.useCallback((e=>d?Vv(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes()),[d])));var d;const u=o.useRef(),h=o.useMemo((()=>{if("undefined"==typeof ResizeObserver)return null;const e=new ResizeObserver((e=>{const t=e.map((e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0})));a(t)}));return u.current=e,e}),[]);return o.useEffect((()=>()=>{var e;null==(e=null==u?void 0:u.current)||e.disconnect()}),[]),s.createElement("div",{className:"react-flow__nodes",style:Uy},c.map((o=>{var a,c,d;let u=o.type||"default";e.nodeTypes[u]||(null==l||l("003",Pm.error003(u)),u="default");const f=e.nodeTypes[u]||e.nodeTypes.default,p=!!(o.draggable||t&&void 0===o.draggable),g=!!(o.selectable||i&&void 0===o.selectable),m=!!(o.connectable||n&&void 0===o.connectable),v=!!(o.focusable||r&&void 0===o.focusable),y=e.nodeExtent?$m(o.positionAbsolute,e.nodeExtent):o.positionAbsolute,x=(null==y?void 0:y.x)??0,b=(null==y?void 0:y.y)??0,w=(({x:e,y:t,width:n,height:r,origin:o})=>n&&r?o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]}:{x:e,y:t})({x:x,y:b,width:o.width??0,height:o.height??0,origin:e.nodeOrigin});return s.createElement(f,{key:o.id,id:o.id,className:o.className,style:o.style,type:u,data:o.data,sourcePosition:o.sourcePosition||yv.Bottom,targetPosition:o.targetPosition||yv.Top,hidden:o.hidden,xPos:x,yPos:b,xPosOrigin:w.x,yPosOrigin:w.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!o.selected,isDraggable:p,isSelectable:g,isConnectable:m,isFocusable:v,resizeObserver:h,dragHandle:o.dragHandle,zIndex:(null==(a=o[Jm])?void 0:a.z)??0,isParent:!!(null==(c=o[Jm])?void 0:c.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!o.width&&!!o.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:o.ariaLabel,hasHandleBounds:!!(null==(d=o[Jm])?void 0:d.handleBounds)})})))};Ix.displayName="NodeRenderer";var Ox=o.memo(Ix);const Mx=(e,t,n)=>n===yv.Left?e-t:n===yv.Right?e+t:e,Dx=(e,t,n)=>n===yv.Top?e-t:n===yv.Bottom?e+t:e,Tx="react-flow__edgeupdater",Px=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:a,type:l})=>s.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:a,className:tm([Tx,`${Tx}-${l}`]),cx:Mx(t,r,e),cy:Dx(n,r,e),r:r,stroke:"transparent",fill:"transparent"}),Ax=()=>!0;var _x=e=>{const t=({id:t,className:n,type:r,data:i,onClick:a,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:h,labelShowBg:f,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:m,style:v,source:y,target:x,sourceX:b,sourceY:w,targetX:k,targetY:E,sourcePosition:C,targetPosition:S,elementsSelectable:N,hidden:j,sourceHandleId:I,targetHandleId:O,onContextMenu:M,onMouseEnter:D,onMouseMove:T,onMouseLeave:P,edgeUpdaterRadius:A,onEdgeUpdate:_,onEdgeUpdateStart:R,onEdgeUpdateEnd:z,markerEnd:L,markerStart:B,rfId:F,ariaLabel:H,isFocusable:V,isUpdatable:$,pathOptions:W,interactionWidth:U,disableKeyboardA11y:Y})=>{const G=o.useRef(null),[q,K]=o.useState(!1),[X,Z]=o.useState(!1),J=Rm(),Q=o.useMemo((()=>`url('#${zv(B,F)}')`),[B,F]),ee=o.useMemo((()=>`url('#${zv(L,F)}')`),[L,F]);if(j)return null;const te=iv(t,J.getState,l),ne=iv(t,J.getState,M),re=iv(t,J.getState,D),oe=iv(t,J.getState,T),ie=iv(t,J.getState,P),ae=(e,n)=>{if(0!==e.button)return;const{edges:r,isValidConnection:o}=J.getState(),i=n?x:y,a=(n?O:I)||null,s=n?"target":"source",l=o||Ax,c=n,d=r.find((e=>e.id===t));Z(!0),null==R||R(e,d,s);Qv({event:e,handleId:a,nodeId:i,onConnect:e=>null==_?void 0:_(d,e),isTarget:c,getState:J.getState,setState:J.setState,isValidConnection:l,edgeUpdaterType:s,onEdgeUpdateEnd:e=>{Z(!1),null==z||z(e,d,s)}})},se=()=>K(!0),le=()=>K(!1),ce=!N&&!a;return s.createElement("g",{className:tm(["react-flow__edge",`react-flow__edge-${r}`,n,{selected:c,animated:d,inactive:ce,updating:q}]),onClick:e=>{var n;const{edges:r,addSelectedEdges:o,unselectNodesAndEdges:i,multiSelectionActive:s}=J.getState(),l=r.find((e=>e.id===t));l&&(N&&(J.setState({nodesSelectionActive:!1}),l.selected&&s?(i({nodes:[],edges:[l]}),null==(n=G.current)||n.blur()):o([t])),a&&a(e,l))},onDoubleClick:te,onContextMenu:ne,onMouseEnter:re,onMouseMove:oe,onMouseLeave:ie,onKeyDown:V?e=>{var n;if(!Y&&Qm.includes(e.key)&&N){const{unselectNodesAndEdges:r,addSelectedEdges:o,edges:i}=J.getState();"Escape"===e.key?(null==(n=G.current)||n.blur(),r({edges:[i.find((e=>e.id===t))]})):o([t])}}:void 0,tabIndex:V?0:void 0,role:V?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":null===H?void 0:H||`Edge from ${y} to ${x}`,"aria-describedby":V?`${Cy}-${F}`:void 0,ref:G},!X&&s.createElement(e,{id:t,source:y,target:x,selected:c,animated:d,label:u,labelStyle:h,labelShowBg:f,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:m,data:i,style:v,sourceX:b,sourceY:w,targetX:k,targetY:E,sourcePosition:C,targetPosition:S,sourceHandleId:I,targetHandleId:O,markerStart:Q,markerEnd:ee,pathOptions:W,interactionWidth:U}),$&&s.createElement(s.Fragment,null,("source"===$||!0===$)&&s.createElement(Px,{position:C,centerX:b,centerY:w,radius:A,onMouseDown:e=>ae(e,!0),onMouseEnter:se,onMouseOut:le,type:"source"}),("target"===$||!0===$)&&s.createElement(Px,{position:S,centerX:k,centerY:E,radius:A,onMouseDown:e=>ae(e,!1),onMouseEnter:se,onMouseOut:le,type:"target"})))};return t.displayName="EdgeWrapper",o.memo(t)};function Rx(e){return{...{default:_x(e.default||Pv),straight:_x(e.bezier||Ov),step:_x(e.step||Iv),smoothstep:_x(e.step||jv),simplebezier:_x(e.simplebezier||kv)},...Object.keys(e).filter((e=>!["default","bezier"].includes(e))).reduce(((t,n)=>(t[n]=_x(e[n]||Pv),t)),{})}}function zx(e,t,n=null){const r=((null==n?void 0:n.x)||0)+t.x,o=((null==n?void 0:n.y)||0)+t.y,i=(null==n?void 0:n.width)||t.width,a=(null==n?void 0:n.height)||t.height;switch(e){case yv.Top:return{x:r+i/2,y:o};case yv.Right:return{x:r+i,y:o+a/2};case yv.Bottom:return{x:r+i/2,y:o+a};case yv.Left:return{x:r,y:o+a/2}}}function Lx(e,t){return e?1!==e.length&&t?t&&e.find((e=>e.id===t))||null:e[0]:null}function Bx(e){var t,n,r,o,i;const a=(null==(t=null==e?void 0:e[Jm])?void 0:t.handleBounds)||null,s=a&&(null==e?void 0:e.width)&&(null==e?void 0:e.height)&&void 0!==(null==(n=null==e?void 0:e.positionAbsolute)?void 0:n.x)&&void 0!==(null==(r=null==e?void 0:e.positionAbsolute)?void 0:r.y);return[{x:(null==(o=null==e?void 0:e.positionAbsolute)?void 0:o.x)||0,y:(null==(i=null==e?void 0:e.positionAbsolute)?void 0:i.y)||0,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0},a,!!s]}const Fx=[{level:0,isMaxLevel:!0,edges:[]}];function Hx(e,t,n){return function(e,t,n=!1){let r=-1;const o=e.reduce(((e,o)=>{var i,a;const s=Zm(o.zIndex);let l=s?o.zIndex:0;if(n){const e=t.get(o.target),n=t.get(o.source),r=o.selected||(null==e?void 0:e.selected)||(null==n?void 0:n.selected),c=Math.max((null==(i=null==n?void 0:n[Jm])?void 0:i.z)||0,(null==(a=null==e?void 0:e[Jm])?void 0:a.z)||0,1e3);l=(s?o.zIndex:0)+(r?c:0)}return e[l]?e[l].push(o):e[l]=[o],r=l>r?l:r,e}),{}),i=Object.entries(o).map((([e,t])=>{const n=+e;return{edges:t,level:n,isMaxLevel:n===r}}));return 0===i.length?Fx:i}(_m(o.useCallback((n=>e?n.edges.filter((e=>{const r=t.get(e.source),o=t.get(e.target);return(null==r?void 0:r.width)&&(null==r?void 0:r.height)&&(null==o?void 0:o.width)&&(null==o?void 0:o.height)&&function({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:a,height:s,transform:l}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=Gm({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:a/l[2],height:s/l[2]}),u=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),h=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(u*h)>0}({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:o.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:o.width,targetHeight:o.height,width:n.width,height:n.height,transform:n.transform})})):n.edges),[e,t])),t,n)}const Vx={[mv.Arrow]:({color:e="none",strokeWidth:t=1})=>s.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),[mv.ArrowClosed]:({color:e="none",strokeWidth:t=1})=>s.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})};const $x=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:a="strokeWidth",strokeWidth:l,orient:c="auto-start-reverse"})=>{const d=function(e){const t=Rm();return o.useMemo((()=>{var n,r;return Object.prototype.hasOwnProperty.call(Vx,e)?Vx[e]:(null==(r=(n=t.getState()).onError)||r.call(n,"009",Pm.error009(e)),null)}),[e])}(t);return d?s.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:a,orient:c,refX:"0",refY:"0"},s.createElement(d,{color:n,strokeWidth:l})):null},Wx=({defaultColor:e,rfId:t})=>{const n=_m(o.useCallback((({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce(((n,o)=>([o.markerStart,o.markerEnd].forEach((o=>{if(o&&"object"==typeof o){const i=zv(o,t);r.includes(i)||(n.push({id:i,color:o.color||e,...o}),r.push(i))}})),n)),[]).sort(((e,t)=>e.id.localeCompare(t.id)))})({defaultColor:e,rfId:t}),[e,t]),((e,t)=>!(e.length!==t.length||e.some(((e,n)=>e.id!==t[n].id)))));return s.createElement("defs",null,n.map((e=>s.createElement($x,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient}))))};Wx.displayName="MarkerDefinitions";var Ux=o.memo(Wx);const Yx=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Gx=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:i,onEdgeUpdate:a,onEdgeContextMenu:l,onEdgeMouseEnter:c,onEdgeMouseMove:d,onEdgeMouseLeave:u,onEdgeClick:h,edgeUpdaterRadius:f,onEdgeDoubleClick:p,onEdgeUpdateStart:g,onEdgeUpdateEnd:m,children:v,disableKeyboardA11y:y})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:w,width:k,height:E,connectionMode:C,nodeInternals:S,onError:N}=_m(Yx,sm),j=Hx(t,S,n);return k?s.createElement(s.Fragment,null,j.map((({level:t,edges:n,isMaxLevel:v})=>s.createElement("svg",{key:t,style:{zIndex:t},width:k,height:E,className:"react-flow__edges react-flow__container"},v&&s.createElement(Ux,{defaultColor:e,rfId:r}),s.createElement("g",null,n.map((e=>{const[t,n,v]=Bx(S.get(e.source)),[k,E,j]=Bx(S.get(e.target));if(!v||!j)return null;let I=e.type||"default";o[I]||(null==N||N("011",Pm.error011(I)),I="default");const O=o[I]||o.default,M=C===lv.Strict?E.target:(E.target??[]).concat(E.source??[]),D=Lx(n.source,e.sourceHandle),T=Lx(M,e.targetHandle),P=(null==D?void 0:D.position)||yv.Bottom,A=(null==T?void 0:T.position)||yv.Top,_=!!(e.focusable||x&&void 0===e.focusable),R=void 0!==a&&(e.updatable||b&&void 0===e.updatable);if(!D||!T)return null==N||N("008",Pm.error008(D,e)),null;const{sourceX:z,sourceY:L,targetX:B,targetY:F}=((e,t,n,r,o,i)=>{const a=zx(n,e,t),s=zx(i,r,o);return{sourceX:a.x,sourceY:a.y,targetX:s.x,targetY:s.y}})(t,D,P,k,T,A);return s.createElement(O,{key:e.id,id:e.id,className:tm([e.className,i]),type:I,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:z,sourceY:L,targetX:B,targetY:F,sourcePosition:P,targetPosition:A,elementsSelectable:w,onEdgeUpdate:a,onContextMenu:l,onMouseEnter:c,onMouseMove:d,onMouseLeave:u,onClick:h,edgeUpdaterRadius:f,onEdgeDoubleClick:p,onEdgeUpdateStart:g,onEdgeUpdateEnd:m,rfId:r,ariaLabel:e.ariaLabel,isFocusable:_,isUpdatable:R,pathOptions:"pathOptions"in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:y})})))))),v):null};Gx.displayName="EdgeRenderer";var qx=o.memo(Gx);const Kx=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Xx({children:e}){const t=_m(Kx);return s.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}const Zx={[yv.Left]:yv.Right,[yv.Right]:yv.Left,[yv.Top]:yv.Bottom,[yv.Bottom]:yv.Top},Jx=({nodeId:e,handleType:t,style:n,type:r=pv.Bezier,CustomComponent:i,connectionStatus:a})=>{var l,c,d;const{fromNode:u,handleId:h,toX:f,toY:p,connectionMode:g}=_m(o.useCallback((t=>({fromNode:t.nodeInternals.get(e),handleId:t.connectionHandleId,toX:(t.connectionPosition.x-t.transform[0])/t.transform[2],toY:(t.connectionPosition.y-t.transform[1])/t.transform[2],connectionMode:t.connectionMode})),[e]),sm),m=null==(l=null==u?void 0:u[Jm])?void 0:l.handleBounds;let v=null==m?void 0:m[t];if(g===lv.Loose&&(v=v||(null==m?void 0:m["source"===t?"target":"source"])),!u||!v)return null;const y=h?v.find((e=>e.id===h)):v[0],x=y?y.x+y.width/2:(u.width??0)/2,b=y?y.y+y.height/2:u.height??0,w=((null==(c=u.positionAbsolute)?void 0:c.x)??0)+x,k=((null==(d=u.positionAbsolute)?void 0:d.y)??0)+b,E=null==y?void 0:y.position,C=E?Zx[E]:null;if(!E||!C)return null;if(i)return s.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:u,fromHandle:y,fromX:w,fromY:k,toX:f,toY:p,fromPosition:E,toPosition:C,connectionStatus:a});let S="";const N={sourceX:w,sourceY:k,sourcePosition:E,targetX:f,targetY:p,targetPosition:C};return r===pv.Bezier?[S]=Tv(N):r===pv.Step?[S]=Nv({...N,borderRadius:0}):r===pv.SmoothStep?[S]=Nv(N):r===pv.SimpleBezier?[S]=wv(N):S=`M${w},${k} ${f},${p}`,s.createElement("path",{d:S,fill:"none",className:"react-flow__connection-path",style:n})};Jx.displayName="ConnectionLine";const Qx=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function eb({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:a,width:l,height:c,connectionStatus:d}=_m(Qx,sm);return!!(o&&i&&l&&a)?s.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},s.createElement("g",{className:tm(["react-flow__connection",d])},s.createElement(Jx,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:d}))):null}function tb(e,t){o.useRef(null),Rm();return o.useMemo((()=>t(e)),[e])}const nb=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:a,onNodeClick:l,onEdgeClick:c,onNodeDoubleClick:d,onEdgeDoubleClick:u,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:g,onSelectionContextMenu:m,onSelectionStart:v,onSelectionEnd:y,connectionLineType:x,connectionLineStyle:b,connectionLineComponent:w,connectionLineContainerStyle:k,selectionKeyCode:E,selectionOnDrag:C,selectionMode:S,multiSelectionKeyCode:N,panActivationKeyCode:j,zoomActivationKeyCode:I,deleteKeyCode:O,onlyRenderVisibleElements:M,elementsSelectable:D,selectNodesOnDrag:T,defaultViewport:P,translateExtent:A,minZoom:_,maxZoom:R,preventScrolling:z,defaultMarkerColor:L,zoomOnScroll:B,zoomOnPinch:F,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:$,zoomOnDoubleClick:W,panOnDrag:U,onPaneClick:Y,onPaneMouseEnter:G,onPaneMouseMove:q,onPaneMouseLeave:K,onPaneScroll:X,onPaneContextMenu:Z,onEdgeUpdate:J,onEdgeContextMenu:Q,onEdgeMouseEnter:ee,onEdgeMouseMove:te,onEdgeMouseLeave:ne,edgeUpdaterRadius:re,onEdgeUpdateStart:oe,onEdgeUpdateEnd:ie,noDragClassName:ae,noWheelClassName:se,noPanClassName:le,elevateEdgesOnSelect:ce,disableKeyboardA11y:de,nodeOrigin:ue,nodeExtent:he,rfId:fe})=>{const pe=tb(e,Nx),ge=tb(t,Rx);return function(e){const t=$y(),n=o.useRef(!1);o.useEffect((()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout((()=>e(t)),1),n.current=!0)}),[e,t.viewportInitialized])}(a),s.createElement(Sx,{onPaneClick:Y,onPaneMouseEnter:G,onPaneMouseMove:q,onPaneMouseLeave:K,onPaneContextMenu:Z,onPaneScroll:X,deleteKeyCode:O,selectionKeyCode:E,selectionOnDrag:C,selectionMode:S,onSelectionStart:v,onSelectionEnd:y,multiSelectionKeyCode:N,panActivationKeyCode:j,zoomActivationKeyCode:I,elementsSelectable:D,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:B,zoomOnPinch:F,zoomOnDoubleClick:W,panOnScroll:H,panOnScrollSpeed:V,panOnScrollMode:$,panOnDrag:U,defaultViewport:P,translateExtent:A,minZoom:_,maxZoom:R,onSelectionContextMenu:m,preventScrolling:z,noDragClassName:ae,noWheelClassName:se,noPanClassName:le,disableKeyboardA11y:de},s.createElement(Xx,null,s.createElement(qx,{edgeTypes:ge,onEdgeClick:c,onEdgeDoubleClick:u,onEdgeUpdate:J,onlyRenderVisibleElements:M,onEdgeContextMenu:Q,onEdgeMouseEnter:ee,onEdgeMouseMove:te,onEdgeMouseLeave:ne,onEdgeUpdateStart:oe,onEdgeUpdateEnd:ie,edgeUpdaterRadius:re,defaultMarkerColor:L,noPanClassName:le,elevateEdgesOnSelect:!!ce,disableKeyboardA11y:de,rfId:fe},s.createElement(eb,{style:b,type:x,component:w,containerStyle:k})),s.createElement("div",{className:"react-flow__edgelabel-renderer"}),s.createElement(Ox,{nodeTypes:pe,onNodeClick:l,onNodeDoubleClick:d,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:g,selectNodesOnDrag:T,onlyRenderVisibleElements:M,noPanClassName:le,noDragClassName:ae,disableKeyboardA11y:de,nodeOrigin:ue,nodeExtent:he,rfId:fe})))};nb.displayName="GraphView";var rb=o.memo(nb);const ob=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ib={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:ob,nodeExtent:ob,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:lv.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:(e,t)=>{},isValidConnection:void 0},ab=()=>{return e=(e,t)=>({...ib,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:Ay(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map((e=>({...r,...e})))})},setDefaultNodesAndEdges:(n,r)=>{const o=void 0!==n,i=void 0!==r,a=o?Ay(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:a,fitViewOnInitOptions:s,domNode:l,nodeOrigin:c}=t(),d=null==l?void 0:l.querySelector(".react-flow__viewport");if(!d)return;const u=window.getComputedStyle(d),{m22:h}=new window.DOMMatrixReadOnly(u.transform),f=n.reduce(((e,t)=>{const n=o.get(t.id);if(null==n?void 0:n.hidden)o.set(n.id,{...n,[Jm]:{...n[Jm],handleBounds:void 0}});else if(n){const r=Hm(t.nodeElement);r.width&&r.height&&(n.width!==r.width||n.height!==r.height||t.forceUpdate)&&(o.set(n.id,{...n,[Jm]:{...n[Jm],handleBounds:{source:fx(".source",t.nodeElement,h,c),target:fx(".target",t.nodeElement,h,c)}},...r}),e.push({id:n.id,type:"dimensions",dimensions:r}))}return e}),[]);Py(o,c);const p=a||i&&!a&&_y(t,{initial:!0,...s});e({nodeInternals:new Map(o),fitViewOnInitDone:p}),(null==f?void 0:f.length)>0&&(null==r||r(f))},updateNodePositions:(e,n=!0,r=!1)=>{const{triggerNodeChanges:o}=t();o(e.map((e=>{const t={id:e.id,type:"position",dragging:r};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t})))},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:a,getNodes:s,elevateNodesOnSelect:l}=t();if(null==n?void 0:n.length){if(i){const t=Ay(nx(n,s()),o,a,l);e({nodeInternals:t})}null==r||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let a,s=null;r?a=n.map((e=>rx(e,!0))):(a=ox(i(),n),s=ox(o,[])),Ly({changedNodes:a,changedEdges:s,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let a,s=null;r?a=n.map((e=>rx(e,!0))):(a=ox(o,n),s=ox(i(),[])),Ly({changedNodes:s,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:i}=t(),a=r||o;Ly({changedNodes:(n||i()).map((e=>(e.selected=!1,rx(e.id,!1)))),changedEdges:a.map((e=>rx(e.id,!1))),get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();null==r||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();null==r||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;null==(r=t().d3Zoom)||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t();Ly({changedNodes:r().filter((e=>e.selected)).map((e=>rx(e.id,!1))),changedEdges:n.filter((e=>e.selected)).map((e=>rx(e.id,!1))),get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach((e=>{e.positionAbsolute=$m(e.position,n)})),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:e=>{const{transform:n,width:r,height:o,d3Zoom:i,d3Selection:a,translateExtent:s}=t();if(!i||!a||!e.x&&!e.y)return!1;const l=Ha.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=[[0,0],[r,o]],d=null==i?void 0:i.constrain()(l,c,s);return i.transform(a,d),n[0]!==d.x||n[1]!==d.y||n[2]!==d.k},cancelConnection:()=>e({connectionNodeId:ib.connectionNodeId,connectionHandleId:ib.connectionHandleId,connectionHandleType:ib.connectionHandleType,connectionStatus:ib.connectionStatus,connectionStartHandle:ib.connectionStartHandle,connectionEndHandle:ib.connectionEndHandle}),reset:()=>e({...ib})}),t=Object.is,e?am(e,t):am;var e,t},sb=({children:e})=>{const t=o.useRef(null);return t.current||(t.current=ab()),s.createElement(Tm,{value:t.current},e)};sb.displayName="ReactFlowProvider";const lb=({children:e})=>o.useContext(Dm)?s.createElement(s.Fragment,null,e):s.createElement(sb,null,e);lb.displayName="ReactFlowWrapper";const cb={input:sy,default:iy,output:cy,group:dy},db={default:Pv,straight:Ov,step:Iv,smoothstep:jv,simplebezier:kv},ub=[0,0],hb=[15,15],fb={x:0,y:0,zoom:1},pb={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},gb=o.forwardRef((({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=cb,edgeTypes:a=db,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:h,onMoveEnd:f,onConnect:p,onConnectStart:g,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:y,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:E,onNodeDragStart:C,onNodeDrag:S,onNodeDragStop:N,onNodesDelete:j,onEdgesDelete:I,onSelectionChange:O,onSelectionDragStart:M,onSelectionDrag:D,onSelectionDragStop:T,onSelectionContextMenu:P,onSelectionStart:A,onSelectionEnd:_,connectionMode:R=lv.Strict,connectionLineType:z=pv.Bezier,connectionLineStyle:L,connectionLineComponent:B,connectionLineContainerStyle:F,deleteKeyCode:H="Backspace",selectionKeyCode:V="Shift",selectionOnDrag:$=!1,selectionMode:W=hv.Full,panActivationKeyCode:U="Space",multiSelectionKeyCode:Y=(rv()?"Meta":"Control"),zoomActivationKeyCode:G=(rv()?"Meta":"Control"),snapToGrid:q=!1,snapGrid:K=hb,onlyRenderVisibleElements:X=!1,selectNodesOnDrag:Z=!0,nodesDraggable:J,nodesConnectable:Q,nodesFocusable:ee,nodeOrigin:te=ub,edgesFocusable:ne,edgesUpdatable:re,elementsSelectable:oe,defaultViewport:ie=fb,minZoom:ae=.5,maxZoom:se=2,translateExtent:le=ob,preventScrolling:ce=!0,nodeExtent:de,defaultMarkerColor:ue="#b1b1b7",zoomOnScroll:he=!0,zoomOnPinch:fe=!0,panOnScroll:pe=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:me=dv.Free,zoomOnDoubleClick:ve=!0,panOnDrag:ye=!0,onPaneClick:xe,onPaneMouseEnter:be,onPaneMouseMove:we,onPaneMouseLeave:ke,onPaneScroll:Ee,onPaneContextMenu:Ce,children:Se,onEdgeUpdate:Ne,onEdgeContextMenu:je,onEdgeDoubleClick:Ie,onEdgeMouseEnter:Oe,onEdgeMouseMove:Me,onEdgeMouseLeave:De,onEdgeUpdateStart:Te,onEdgeUpdateEnd:Pe,edgeUpdaterRadius:Ae=10,onNodesChange:_e,onEdgesChange:Re,noDragClassName:ze="nodrag",noWheelClassName:Le="nowheel",noPanClassName:Be="nopan",fitView:Fe=!1,fitViewOptions:He,connectOnClick:Ve=!0,attributionPosition:$e,proOptions:We,defaultEdgeOptions:Ue,elevateNodesOnSelect:Ye=!0,elevateEdgesOnSelect:Ge=!1,disableKeyboardA11y:qe=!1,autoPanOnConnect:Ke=!0,autoPanOnNodeDrag:Xe=!0,connectionRadius:Ze=20,isValidConnection:Je,onError:Qe,style:et,id:tt,nodeDragThreshold:nt,...rt},ot)=>{const it=tt||"1";return s.createElement("div",{...rt,style:{...et,...pb},ref:ot,className:tm(["react-flow",o]),"data-testid":"rf__wrapper",id:tt},s.createElement(lb,null,s.createElement(rb,{onInit:d,onMove:u,onMoveStart:h,onMoveEnd:f,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:k,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:a,connectionLineType:z,connectionLineStyle:L,connectionLineComponent:B,connectionLineContainerStyle:F,selectionKeyCode:V,selectionOnDrag:$,selectionMode:W,deleteKeyCode:H,multiSelectionKeyCode:Y,panActivationKeyCode:U,zoomActivationKeyCode:G,onlyRenderVisibleElements:X,selectNodesOnDrag:Z,defaultViewport:ie,translateExtent:le,minZoom:ae,maxZoom:se,preventScrolling:ce,zoomOnScroll:he,zoomOnPinch:fe,zoomOnDoubleClick:ve,panOnScroll:pe,panOnScrollSpeed:ge,panOnScrollMode:me,panOnDrag:ye,onPaneClick:xe,onPaneMouseEnter:be,onPaneMouseMove:we,onPaneMouseLeave:ke,onPaneScroll:Ee,onPaneContextMenu:Ce,onSelectionContextMenu:P,onSelectionStart:A,onSelectionEnd:_,onEdgeUpdate:Ne,onEdgeContextMenu:je,onEdgeDoubleClick:Ie,onEdgeMouseEnter:Oe,onEdgeMouseMove:Me,onEdgeMouseLeave:De,onEdgeUpdateStart:Te,onEdgeUpdateEnd:Pe,edgeUpdaterRadius:Ae,defaultMarkerColor:ue,noDragClassName:ze,noWheelClassName:Le,noPanClassName:Be,elevateEdgesOnSelect:Ge,rfId:it,disableKeyboardA11y:qe,nodeOrigin:te,nodeExtent:de}),s.createElement(by,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:g,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:y,nodesDraggable:J,nodesConnectable:Q,nodesFocusable:ee,edgesFocusable:ne,edgesUpdatable:re,elementsSelectable:oe,elevateNodesOnSelect:Ye,minZoom:ae,maxZoom:se,nodeExtent:de,onNodesChange:_e,onEdgesChange:Re,snapToGrid:q,snapGrid:K,connectionMode:R,translateExtent:le,connectOnClick:Ve,defaultEdgeOptions:Ue,fitView:Fe,fitViewOptions:He,onNodesDelete:j,onEdgesDelete:I,onNodeDragStart:C,onNodeDrag:S,onNodeDragStop:N,onSelectionDrag:D,onSelectionDragStart:M,onSelectionDragStop:T,noPanClassName:Be,nodeOrigin:te,rfId:it,autoPanOnConnect:Ke,autoPanOnNodeDrag:Xe,onError:Qe,connectionRadius:Ze,isValidConnection:Je,nodeDragThreshold:nt}),s.createElement(my,{onSelectionChange:O}),Se,s.createElement(Bm,{proOptions:We,position:$e}),s.createElement(Iy,{rfId:it,disableKeyboardA11y:qe})))}));function mb(e){return t=>{const[n,r]=o.useState(t),i=o.useCallback((t=>r((n=>e(t,n)))),[]);return[n,r,i]}}gb.displayName="ReactFlow";const vb=mb(nx),yb=mb((function(e,t){return tx(e,t)}));function xb(){return s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},s.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function bb(){return s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},s.createElement("path",{d:"M0 0h32v4.2H0z"}))}function wb(){return s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},s.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function kb(){return s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},s.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Eb(){return s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},s.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Cb=({children:e,className:t,...n})=>s.createElement("button",{type:"button",className:tm(["react-flow__controls-button",t]),...n},e);Cb.displayName="ControlButton";const Sb=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Nb=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:a,onZoomOut:l,onFitView:c,onInteractiveChange:d,className:u,children:h,position:f="bottom-left"})=>{const p=Rm(),[g,m]=o.useState(!1),{isInteractive:v,minZoomReached:y,maxZoomReached:x}=_m(Sb,sm),{zoomIn:b,zoomOut:w,fitView:k}=$y();if(o.useEffect((()=>{m(!0)}),[]),!g)return null;return s.createElement(Lm,{className:tm(["react-flow__controls",u]),position:f,style:e,"data-testid":"rf__controls"},t&&s.createElement(s.Fragment,null,s.createElement(Cb,{onClick:()=>{b(),null==a||a()},className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x},s.createElement(xb,null)),s.createElement(Cb,{onClick:()=>{w(),null==l||l()},className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},s.createElement(bb,null))),n&&s.createElement(Cb,{className:"react-flow__controls-fitview",onClick:()=>{k(i),null==c||c()},title:"fit view","aria-label":"fit view"},s.createElement(wb,null)),r&&s.createElement(Cb,{className:"react-flow__controls-interactive",onClick:()=>{p.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),null==d||d(!v)},title:"toggle interactivity","aria-label":"toggle interactivity"},v?s.createElement(Eb,null):s.createElement(kb,null)),h)};Nb.displayName="Controls";var jb,Ib,Ob=o.memo(Nb);function Mb({color:e,dimensions:t,lineWidth:n}){return s.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Db({color:e,radius:t}){return s.createElement("circle",{cx:t,cy:t,r:t,fill:e})}(Ib=jb||(jb={})).Lines="lines",Ib.Dots="dots",Ib.Cross="cross";const Tb={[jb.Dots]:"#91919a",[jb.Lines]:"#eee",[jb.Cross]:"#e2e2e2"},Pb={[jb.Dots]:1,[jb.Lines]:1,[jb.Cross]:6},Ab=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function _b({id:e,variant:t=jb.Dots,gap:n=20,size:r,lineWidth:i=1,offset:a=2,color:l,style:c,className:d}){const u=o.useRef(null),{transform:h,patternId:f}=_m(Ab,sm),p=l||Tb[t],g=r||Pb[t],m=t===jb.Dots,v=t===jb.Cross,y=Array.isArray(n)?n:[n,n],x=[y[0]*h[2]||1,y[1]*h[2]||1],b=g*h[2],w=v?[b,b]:x,k=m?[b/a,b/a]:[w[0]/a,w[1]/a];return s.createElement("svg",{className:tm(["react-flow__background",d]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},s.createElement("pattern",{id:f+e,x:h[0]%x[0],y:h[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${k[0]},-${k[1]})`},m?s.createElement(Db,{color:p,radius:b/a}):s.createElement(Mb,{dimensions:w,color:p,lineWidth:i})),s.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}_b.displayName="Background";var Rb=o.memo(_b);function zb(e){return Math.min(11*e+35,200)}const Lb=s.createContext("LR"),Bb=o.memo((e=>{const{data:t,selected:n}=e,r=d(t.atom),i=Ko().indexOf(r.id),a=n?"var(--gray-9)":"var(--gray-3)",s=_m((({width:e})=>e)),l=o.useContext(Lb),c=r.code.split("\n").length;return x.jsxs("div",{children:[x.jsx(ry,{type:"target",id:"inputs",position:"LR"===l?yv.Left:yv.Top,style:{background:a}}),x.jsx(ry,{type:"source",id:"inputs",position:"LR"===l?yv.Left:yv.Top,style:{background:a}}),x.jsxs("div",{className:Mt("flex flex-col bg-card border border-input/50 rounded-md mx-[2px] overflow-hidden",n&&"border-primary"),style:{height:zb(c),width:t.forceWidth||(u=s,Math.min(Math.max(u-100,100),400))},children:[x.jsx("div",{className:"text-muted-foreground font-semibold text-xs py-1 px-2 bg-muted border-b",children:Xo(r.name,i)}),x.jsx(Ra,{code:r.code})]}),x.jsx(ry,{type:"source",id:"outputs",position:"LR"===l?yv.Right:yv.Bottom,style:{background:a}}),x.jsx(ry,{type:"target",id:"outputs",position:"LR"===l?yv.Right:yv.Bottom,style:{background:a}})]});var u}),((e,t)=>["data","selected","id"].every((n=>e[n]===t[n]))));Bb.displayName="CustomNode";const Fb={custom:Bb},Hb=({maxCount:e,cellIds:t,onClick:n,skipScroll:r})=>{const o=Ko(),i=[...t].sort(((e,t)=>o.indexOf(e)-o.indexOf(t)));return 0===t.length?x.jsx("div",{className:"text-muted-foreground",children:"--"}):x.jsxs(x.Fragment,{children:[i.slice(0,e).map(((e,o)=>x.jsxs("span",{className:"truncate",children:[x.jsx(Zo,{variant:"focus",cellId:e,skipScroll:r,className:"whitespace-nowrap",onClick:n?()=>n(e):void 0},e),o<t.length-1&&", "]},e))),t.length>e&&x.jsxs(Lt,{children:[x.jsx(Jn,{asChild:!0,children:x.jsxs("span",{className:"whitespace-nowrap text-muted-foreground text-xs hover:underline cursor-pointer",children:["+",t.length-e," more"]})}),x.jsx(Ht,{className:"w-auto",children:x.jsx("div",{className:"flex flex-col gap-1 py-1",children:i.slice(e).map((e=>x.jsx(Zo,{variant:"focus",cellId:e,className:"whitespace-nowrap",onClick:n?()=>n(e):void 0},e)))})})]})]})},Vb=({name:e,declaredBy:t,onClick:n,...r})=>x.jsx("div",{className:"max-w-[130px]",...r,children:x.jsx(Jo,{title:e,variant:t.length>1?"destructive":"outline",className:"rounded-sm text-ellipsis block overflow-hidden max-w-fit cursor-pointer font-medium",onClick:t=>{n?n(t):(navigator.clipboard.writeText(e),Q({title:"Copied to clipboard"}))},children:e})}),$b=o.memo((({onChange:e,view:t,settings:n,onSettingsChange:r})=>{const o=x.jsxs(Lt,{children:[x.jsx(Jn,{asChild:!0,children:x.jsx(P,{variant:"text",size:"xs",children:x.jsx(da,{className:"w-4 h-4"})})}),x.jsxs(Ht,{className:"w-auto p-2 text-muted-foreground",children:[x.jsx("div",{className:"font-semibold pb-4",children:"Settings"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(Ur,{"data-testid":"hide-pure-markdown-checkbox",id:"hide-pure-markdown",checked:n.hidePureMarkdown,onCheckedChange:e=>{return t="hidePureMarkdown",o=Boolean(e),void r({...n,[t]:o});var t,o}}),x.jsx(ae,{htmlFor:"hide-pure-markdown",children:"Hide pure markdown"})]})]})]});return x.jsxs(Lm,{position:"top-right",className:"flex flex-col items-end gap-2",children:[x.jsxs("div",{className:"flex gap-2",children:[x.jsxs(P,{variant:"outline",className:"bg-background","aria-selected":"_minimap_"===t,size:"xs",onClick:()=>e("_minimap_"),children:[x.jsx(zs,{className:"w-4 h-4 mr-1"}),"Mini Map"]}),x.jsxs(P,{variant:"outline",className:"bg-background","aria-selected":"TB"===t,size:"xs",onClick:()=>e("TB"),children:[x.jsx(Os,{className:"w-4 h-4 mr-1"}),"Vertical Tree"]}),x.jsxs(P,{variant:"outline",className:"bg-background","aria-selected":"LR"===t,size:"xs",onClick:()=>e("LR"),children:[x.jsx(Os,{className:"w-4 h-4 mr-1 transform -rotate-90"})," ","Horizontal Tree"]})]}),"_minimap_"!==t&&o]})}));$b.displayName="GraphToolbar";const Wb=o.memo((({selection:e,edges:t,variables:n})=>{if(!e)return null;const r=(e,t)=>{const n=Qo(e);n&&dn(n,t)};return x.jsx(Lm,{position:"bottom-left",children:x.jsx("div",{className:"min-h-[100px] shadow-md rounded-md border max-w-[550px] border-primary/40 my-4 min-w-[240px] bg-[var(--slate-1)] text-muted-foreground/80 flex flex-col",children:(()=>{if("node"===e.type){const t=Object.values(n).filter((t=>t.usedBy.includes(e.id))),o=Object.values(n).filter((t=>t.declaredBy.includes(e.id))),i=(e,t)=>x.jsxs(x.Fragment,{children:[0===e.length&&x.jsx("div",{className:"text-muted-foreground text-sm text-center",children:"--"}),x.jsx("div",{className:"grid grid-cols-5 gap-3 items-center text-sm py-1 flex-1 empty:hidden",children:e.map((e=>x.jsxs(s.Fragment,{children:[x.jsx(Vb,{declaredBy:e.declaredBy,name:e.name}),x.jsxs("div",{className:"truncate col-span-2",title:e.value,children:[e.value,x.jsxs("span",{className:"ml-1 truncate text-foreground/60 font-mono",children:["(",e.dataType,")"]})]}),x.jsx("div",{className:"truncate col-span-2 gap-1 items-center",children:x.jsx(Hb,{skipScroll:!0,onClick:()=>r("in"===t?e.declaredBy[0]:e.usedBy[0],e.name),maxCount:3,cellIds:e.usedBy})})]},e.name)))})]});return x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"font-bold py-2 flex items-center gap-2 border-b px-3",children:[x.jsx(Ue,{className:"w-5 h-5"}),x.jsx(Zo,{cellId:e.id}),x.jsx("div",{className:"flex-1"}),x.jsx(zd,{cellId:e.id,children:x.jsx(P,{variant:"ghost",size:"icon",children:x.jsx(gs,{className:"w-4 h-4"})})})]}),x.jsxs("div",{className:"text-sm flex flex-col py-3 pl-2 pr-4 flex-1 justify-center",children:[x.jsxs("div",{className:"flex flex-col gap-2",children:[x.jsxs("span",{className:"flex items-center gap-2 font-semibold",children:[x.jsx(Ja,{className:"w-4 h-4"}),"Outputs"]}),i(o,"out")]}),x.jsx("hr",{className:"border-divider my-3"}),x.jsxs("div",{className:"flex flex-col gap-2",children:[x.jsxs("span",{className:"flex items-center gap-2 font-semibold",children:[x.jsx(Qa,{className:"w-4 h-4"}),"Inputs"]}),i(t,"in")]})]})]})}if("edge"===e.type){const t=Object.values(n).filter((t=>t.declaredBy.includes(e.source)&&t.usedBy.includes(e.target)));return x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"font-bold py-2 flex items-center gap-2 border-b px-3",children:[x.jsx(tl,{className:"w-4 h-4"}),x.jsx(Zo,{cellId:e.source}),x.jsx(es,{className:"w-4 h-4"}),x.jsx(Zo,{cellId:e.target})]}),x.jsx("div",{className:"grid grid-cols-4 gap-3 max-w-[350px] items-center text-sm p-3 flex-1",children:t.map((e=>x.jsxs(s.Fragment,{children:[x.jsx(Vb,{declaredBy:e.declaredBy,name:e.name,onClick:()=>{r(e.declaredBy[0],e.name)}}),x.jsx("div",{className:"truncate text-foreground/60 font-mono",children:e.dataType}),x.jsx("div",{className:"truncate col-span-2",title:e.value,children:e.value})]},e.name)))})]})}})()})})}));function Ub(){const e=$y(),t=_m((({width:e})=>e)),n=_m((({height:e})=>e)),r=ei((()=>{e.fitView({duration:100})}),100);o.useEffect((()=>{t&&n&&r()}),[t,n,r])}Wb.displayName="GraphSelectionPanel";const Yb=new class{createEdge(e,t,n){return{type:"smoothstep",pathOptions:{offset:20,borderRadius:100},data:{direction:n},markerEnd:{type:mv.Arrow},id:`${e}-${t}-${n}`,source:e,sourceHandle:n,targetHandle:n,target:t}}createNode(e,t,n){return{id:e,data:{atom:t},width:250,type:"custom",height:zb(te.get(t).code.trim().split("\n").length),position:{x:0,y:n+20}}}createElements(e,t,n,r){let o=0;const i=[],a=[];for(const[l,c]of qo.zip(e,t)){const e=this.createNode(l,c,o);i.push(e),o=e.position.y+(e.height||0)}const s=new Set;for(const l of Object.values(n)){const{declaredBy:e,usedBy:t}=l;for(const n of e)for(const e of t){const t=`${n}-${e}`;s.has(t)||(s.add(t),a.push(this.createEdge(n,e,"inputs"),this.createEdge(n,e,"outputs")))}}return{nodes:i,edges:a}}},Gb=({cellIds:e,variables:t,cellAtoms:n,children:r})=>{const{nodes:i,edges:a}=Yb.createElements(e,n,t,!1),[s,l]=yb([]),[c,d]=vb(i),[u,f]=o.useState(),[p,g]=o.useState(),m=o.useRef(!1);Ub();const v=_m((({height:e})=>e)),y=h((e=>{d(e.nodes),l([])}));o.useEffect((()=>{m.current?y(Yb.createElements(e,n,t,!1)):m.current=!0}),[e,t,n,y]),o.useEffect((()=>{if(u){const e=a.filter((e=>{const{source:t,target:n,data:r}=e;return t===u&&"outputs"===r.direction||n===u&&"inputs"===r.direction}));l(e)}}),[u,l,a]);const b=function(e,t){const n=10;return o.useMemo((()=>{const r=e.reduce(((e,{position:r})=>Math.min(e,r.y-t/2-n)),Number.POSITIVE_INFINITY),o=e.reduce(((e,{position:r})=>Math.max(e,r.y+t/2+n)),Number.NEGATIVE_INFINITY);return[[Number.NEGATIVE_INFINITY,r],[Number.POSITIVE_INFINITY,o]]}),[e,t])}(c,v);return x.jsxs(gb,{nodes:c,edges:s,nodeTypes:Fb,translateExtent:b,onNodeClick:(e,t)=>{const n=t.id;f(n),g(void 0),l([])},onNodeDoubleClick:(e,t)=>{ti(t.id,"focus")},onEdgeClick:(e,t)=>{g(t)},snapToGrid:!0,fitView:!0,elementsSelectable:!0,minZoom:1,maxZoom:1,draggable:!1,panOnScrollMode:dv.Vertical,zoomOnDoubleClick:!1,nodesDraggable:!1,nodesConnectable:!1,nodesFocusable:!1,edgesFocusable:!1,selectNodesOnDrag:!1,panOnDrag:!1,preventScrolling:!1,zoomOnPinch:!1,panOnScroll:!0,autoPanOnNodeDrag:!1,autoPanOnConnect:!1,children:[p?x.jsx(Wb,{selection:{type:"edge",source:p.source,target:p.target},variables:t,edges:s}):u?x.jsx(Wb,{selection:{type:"node",id:u},variables:t,edges:s}):null,r]})};var qb="\0",Kb="\0",Xb="";function Zb(e,t){e[t]?e[t]++:e[t]=1}function Jb(e,t){--e[t]||delete e[t]}function Qb(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}return o+Xb+i+Xb+(void 0===r?qb:r)}function ew(e,t){return Qb(e,t.v,t.w,t.name)}var tw=class{constructor(e){t(this,"_isDirected",!0),t(this,"_isMultigraph",!1),t(this,"_isCompound",!1),t(this,"_label"),t(this,"_defaultNodeLabelFn",(()=>{})),t(this,"_defaultEdgeLabelFn",(()=>{})),t(this,"_nodes",{}),t(this,"_in",{}),t(this,"_preds",{}),t(this,"_out",{}),t(this,"_sucs",{}),t(this,"_edgeObjs",{}),t(this,"_edgeLabels",{}),t(this,"_nodeCount",0),t(this,"_edgeCount",0),t(this,"_parent"),t(this,"_children"),e&&(this._isDirected=!e.hasOwnProperty("directed")||e.directed,this._isMultigraph=!!e.hasOwnProperty("multigraph")&&e.multigraph,this._isCompound=!!e.hasOwnProperty("compound")&&e.compound),this._isCompound&&(this._parent={},this._children={},this._children[Kb]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return this._defaultNodeLabelFn=e,"function"!=typeof e&&(this._defaultNodeLabelFn=()=>e),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var e=this;return this.nodes().filter((t=>0===Object.keys(e._in[t]).length))}sinks(){var e=this;return this.nodes().filter((t=>0===Object.keys(e._out[t]).length))}setNodes(e,t){var n=arguments,r=this;return e.forEach((function(e){n.length>1?r.setNode(e,t):r.setNode(e)})),this}setNode(e,t){return this._nodes.hasOwnProperty(e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=Kb,this._children[e]={},this._children[Kb][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return this._nodes.hasOwnProperty(e)}removeNode(e){var t=this;if(this._nodes.hasOwnProperty(e)){var n=e=>t.removeEdge(t._edgeObjs[e]);delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],this.children(e).forEach((function(e){t.setParent(e)})),delete this._children[e]),Object.keys(this._in[e]).forEach(n),delete this._in[e],delete this._preds[e],Object.keys(this._out[e]).forEach(n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(void 0===t)t=Kb;else{for(var n=t+="";void 0!==n;n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var t=this._parent[e];if(t!==Kb)return t}}children(e=Kb){if(this._isCompound){var t=this._children[e];if(t)return Object.keys(t)}else{if(e===Kb)return this.nodes();if(this.hasNode(e))return[]}}predecessors(e){var t=this._preds[e];if(t)return Object.keys(t)}successors(e){var t=this._sucs[e];if(t)return Object.keys(t)}neighbors(e){var t=this.predecessors(e);if(t){const r=new Set(t);for(var n of this.successors(e))r.add(n);return Array.from(r.values())}}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;Object.entries(this._nodes).forEach((function([n,r]){e(n)&&t.setNode(n,r)})),Object.values(this._edgeObjs).forEach((function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var r={};function o(e){var i=n.parent(e);return void 0===i||t.hasNode(i)?(r[e]=i,i):i in r?r[i]:o(i)}return this._isCompound&&t.nodes().forEach((e=>t.setParent(e,o(e)))),t}setDefaultEdgeLabel(e){return this._defaultEdgeLabelFn=e,"function"!=typeof e&&(this._defaultEdgeLabelFn=()=>e),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(e,t){var n=this,r=arguments;return e.reduce((function(e,o){return r.length>1?n.setEdge(e,o,t):n.setEdge(e,o),o})),this}setEdge(){var e,t,n,r,o=!1,i=arguments[0];"object"==typeof i&&null!==i&&"v"in i?(e=i.v,t=i.w,n=i.name,2===arguments.length&&(r=arguments[1],o=!0)):(e=i,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],o=!0)),e=""+e,t=""+t,void 0!==n&&(n=""+n);var a=Qb(this._isDirected,e,t,n);if(this._edgeLabels.hasOwnProperty(a))return o&&(this._edgeLabels[a]=r),this;if(void 0!==n&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[a]=o?r:this._defaultEdgeLabelFn(e,t,n);var s=function(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};r&&(s.name=r);return s}(this._isDirected,e,t,n);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[a]=s,Zb(this._preds[t],e),Zb(this._sucs[e],t),this._in[t][a]=s,this._out[e][a]=s,this._edgeCount++,this}edge(e,t,n){var r=1===arguments.length?ew(this._isDirected,arguments[0]):Qb(this._isDirected,e,t,n);return this._edgeLabels[r]}edgeAsObj(){const e=this.edge(...arguments);return"object"!=typeof e?{label:e}:e}hasEdge(e,t,n){var r=1===arguments.length?ew(this._isDirected,arguments[0]):Qb(this._isDirected,e,t,n);return this._edgeLabels.hasOwnProperty(r)}removeEdge(e,t,n){var r=1===arguments.length?ew(this._isDirected,arguments[0]):Qb(this._isDirected,e,t,n),o=this._edgeObjs[r];return o&&(e=o.v,t=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],Jb(this._preds[t],e),Jb(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this}inEdges(e,t){var n=this._in[e];if(n){var r=Object.values(n);return t?r.filter((e=>e.v===t)):r}}outEdges(e,t){var n=this._out[e];if(n){var r=Object.values(n);return t?r.filter((e=>e.w===t)):r}}nodeEdges(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},nw={Graph:tw,version:"2.2.2"},rw=tw,ow={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:iw(e),edges:aw(e)};void 0!==e.graph()&&(t.value=structuredClone(e.graph()));return t},read:function(e){var t=new rw(e.options).setGraph(e.value);return e.nodes.forEach((function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),e.edges.forEach((function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}};function iw(e){return e.nodes().map((function(t){var n=e.node(t),r=e.parent(t),o={v:t};return void 0!==n&&(o.value=n),void 0!==r&&(o.parent=r),o}))}function aw(e){return e.edges().map((function(t){var n=e.edge(t),r={v:t.v,w:t.w};return void 0!==t.name&&(r.name=t.name),void 0!==n&&(r.value=n),r}))}var sw=function(e){var t,n={},r=[];function o(r){n.hasOwnProperty(r)||(n[r]=!0,t.push(r),e.successors(r).forEach(o),e.predecessors(r).forEach(o))}return e.nodes().forEach((function(e){t=[],o(e),t.length&&r.push(t)})),r};var lw=class{constructor(){t(this,"_arr",[]),t(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(e){return this._keyIndices.hasOwnProperty(e)}priority(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(e,t){var n=this._keyIndices;if(e=String(e),!n.hasOwnProperty(e)){var r=this._arr,o=r.length;return n[e]=o,r.push({key:e,priority:t}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)}_heapify(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))}_decrease(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t}_swap(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t}},cw=lw,dw=function(e,t,n,r){return function(e,t,n,r){var o,i,a={},s=new cw,l=function(e){var t=e.v!==o?e.v:e.w,r=a[t],l=n(e),c=i.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+l);c<r.distance&&(r.distance=c,r.predecessor=o,s.decrease(t,c))};e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},s.add(e,n)}));for(;s.size()>0&&(o=s.removeMin(),(i=a[o]).distance!==Number.POSITIVE_INFINITY);)r(o).forEach(l);return a}(e,String(t),n||uw,r||function(t){return e.outEdges(t)})},uw=()=>1;var hw=dw,fw=function(e,t,n){return e.nodes().reduce((function(r,o){return r[o]=hw(e,o,t,n),r}),{})};var pw=function(e){var t=0,n=[],r={},o=[];function i(a){var s=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){r.hasOwnProperty(e)?r[e].onStack&&(s.lowlink=Math.min(s.lowlink,r[e].index)):(i(e),s.lowlink=Math.min(s.lowlink,r[e].lowlink))})),s.lowlink===s.index){var l,c=[];do{l=n.pop(),r[l].onStack=!1,c.push(l)}while(a!==l);o.push(c)}}return e.nodes().forEach((function(e){r.hasOwnProperty(e)||i(e)})),o};var gw=pw,mw=function(e){return gw(e).filter((function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))};var vw=function(e,t,n){return function(e,t,n){var r={},o=e.nodes();return o.forEach((function(e){r[e]={},r[e][e]={distance:0},o.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var o=n.v===e?n.w:n.v,i=t(n);r[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var t=r[e];o.forEach((function(n){var i=r[n];o.forEach((function(n){var r=i[e],o=t[n],a=i[n],s=r.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)}))}))})),r}(e,t||yw,n||function(t){return e.outEdges(t)})},yw=()=>1;function xw(e){var t={},n={},r=[];if(e.sinks().forEach((function o(i){if(n.hasOwnProperty(i))throw new bw;t.hasOwnProperty(i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(o),delete n[i],r.push(i))})),Object.keys(t).length!==e.nodeCount())throw new bw;return r}class bw extends Error{constructor(){super(...arguments)}}var ww=xw;xw.CycleException=bw;var kw=ww;var Ew=function(e,t,n){Array.isArray(t)||(t=[t]);var r=e.isDirected()?t=>e.successors(t):t=>e.neighbors(t),o="post"===n?Cw:Sw,i=[],a={};return t.forEach((t=>{if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);o(t,r,a,i)})),i};function Cw(e,t,n,r){for(var o=[[e,!1]];o.length>0;){var i=o.pop();i[1]?r.push(i[0]):n.hasOwnProperty(i[0])||(n[i[0]]=!0,o.push([i[0],!0]),Nw(t(i[0]),(e=>o.push([e,!1]))))}}function Sw(e,t,n,r){for(var o=[e];o.length>0;){var i=o.pop();n.hasOwnProperty(i)||(n[i]=!0,r.push(i),Nw(t(i),(e=>o.push(e))))}}function Nw(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}var jw=Ew;var Iw=Ew;var Ow=tw,Mw=lw;var Dw={Graph:nw.Graph,json:ow,alg:{components:sw,dijkstra:dw,dijkstraAll:fw,findCycles:mw,floydWarshall:vw,isAcyclic:function(e){try{kw(e)}catch(t){if(t instanceof kw.CycleException)return!1;throw t}return!0},postorder:function(e,t){return jw(e,t,"post")},preorder:function(e,t){return Iw(e,t,"pre")},prim:function(e,t){var n,r=new Ow,o={},i=new Mw;function a(e){var r=e.v===n?e.w:e.v,a=i.priority(r);if(void 0!==a){var s=t(e);s<a&&(o[r]=n,i.decrease(r,s))}}if(0===e.nodeCount())return r;e.nodes().forEach((function(e){i.add(e,Number.POSITIVE_INFINITY),r.setNode(e)})),i.decrease(e.nodes()[0],0);var s=!1;for(;i.size()>0;){if(n=i.removeMin(),o.hasOwnProperty(n))r.setEdge(n,o[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(a)}return r},tarjan:pw,topsort:ww},version:nw.version};function Tw(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Pw(e,t){if("_next"!==e&&"_prev"!==e)return t}let Aw=Dw.Graph,_w=class{constructor(){let e={};e._next=e._prev=e,this._sentinel=e}dequeue(){let e=this._sentinel,t=e._prev;if(t!==e)return Tw(t),t}enqueue(e){let t=this._sentinel;e._prev&&e._next&&Tw(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t}toString(){let e=[],t=this._sentinel,n=t._prev;for(;n!==t;)e.push(JSON.stringify(n,Pw)),n=n._prev;return"["+e.join(", ")+"]"}};var Rw=function(e,t){if(e.nodeCount()<=1)return[];let n=function(e,t){let n=new Aw,r=0,o=0;e.nodes().forEach((e=>{n.setNode(e,{v:e,in:0,out:0})})),e.edges().forEach((e=>{let i=n.edge(e.v,e.w)||0,a=t(e),s=i+a;n.setEdge(e.v,e.w,s),o=Math.max(o,n.node(e.v).out+=a),r=Math.max(r,n.node(e.w).in+=a)}));let i=function(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}(o+r+3).map((()=>new _w)),a=r+1;return n.nodes().forEach((e=>{Bw(i,a,n.node(e))})),{graph:n,buckets:i,zeroIdx:a}}(e,t||zw);return function(e,t,n){let r,o=[],i=t[t.length-1],a=t[0];for(;e.nodeCount();){for(;r=a.dequeue();)Lw(e,t,n,r);for(;r=i.dequeue();)Lw(e,t,n,r);if(e.nodeCount())for(let i=t.length-2;i>0;--i)if(r=t[i].dequeue(),r){o=o.concat(Lw(e,t,n,r,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx).flatMap((t=>e.outEdges(t.v,t.w)))};let zw=()=>1;function Lw(e,t,n,r,o){let i=o?[]:void 0;return e.inEdges(r.v).forEach((r=>{let a=e.edge(r),s=e.node(r.v);o&&i.push({v:r.v,w:r.w}),s.out-=a,Bw(t,n,s)})),e.outEdges(r.v).forEach((r=>{let o=e.edge(r),i=r.w,a=e.node(i);a.in-=o,Bw(t,n,a)})),e.removeNode(r.v),i}function Bw(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}let Fw=Dw.Graph;var Hw={addBorderNode:function(e,t,n,r){let o={width:0,height:0};arguments.length>=4&&(o.rank=n,o.order=r);return Vw(e,"border",o,t)},addDummyNode:Vw,asNonCompoundGraph:function(e){let t=new Fw({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach((n=>{e.children(n).length||t.setNode(n,e.node(n))})),e.edges().forEach((n=>{t.setEdge(n,e.edge(n))})),t},buildLayerMatrix:function(e){let t=Yw($w(e)+1).map((()=>[]));return e.nodes().forEach((n=>{let r=e.node(n),o=r.rank;void 0!==o&&(t[o][r.order]=n)})),t},intersectRect:function(e,t){let n,r,o=e.x,i=e.y,a=t.x-o,s=t.y-i,l=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*l>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(l=-l),n=l,r=l*s/a);return{x:o+n,y:i+r}},mapValues:function(e,t){let n=t;"string"==typeof t&&(n=e=>e[t]);return Object.entries(e).reduce(((e,[t,r])=>(e[t]=n(r,t),e)),{})},maxRank:$w,normalizeRanks:function(e){let t=Math.min(...e.nodes().map((t=>{let n=e.node(t).rank;return void 0===n?Number.MAX_VALUE:n})));e.nodes().forEach((n=>{let r=e.node(n);r.hasOwnProperty("rank")&&(r.rank-=t)}))},notime:function(e,t){return t()},partition:function(e,t){let n={lhs:[],rhs:[]};return e.forEach((e=>{t(e)?n.lhs.push(e):n.rhs.push(e)})),n},pick:function(e,t){const n={};for(const r of t)void 0!==e[r]&&(n[r]=e[r]);return n},predecessorWeights:function(e){let t=e.nodes().map((t=>{let n={};return e.inEdges(t).forEach((t=>{n[t.v]=(n[t.v]||0)+e.edge(t).weight})),n}));return Gw(e.nodes(),t)},range:Yw,removeEmptyRanks:function(e){let t=Math.min(...e.nodes().map((t=>e.node(t).rank))),n=[];e.nodes().forEach((r=>{let o=e.node(r).rank-t;n[o]||(n[o]=[]),n[o].push(r)}));let r=0,o=e.graph().nodeRankFactor;Array.from(n).forEach(((t,n)=>{void 0===t&&n%o!=0?--r:void 0!==t&&r&&t.forEach((t=>e.node(t).rank+=r))}))},simplify:function(e){let t=(new Fw).setGraph(e.graph());return e.nodes().forEach((n=>t.setNode(n,e.node(n)))),e.edges().forEach((n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})})),t},successorWeights:function(e){let t=e.nodes().map((t=>{let n={};return e.outEdges(t).forEach((t=>{n[t.w]=(n[t.w]||0)+e.edge(t).weight})),n}));return Gw(e.nodes(),t)},time:function(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}},uniqueId:Uw,zipObject:Gw};function Vw(e,t,n,r){let o;do{o=Uw(r)}while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function $w(e){return Math.max(...e.nodes().map((t=>{let n=e.node(t).rank;return void 0===n?Number.MIN_VALUE:n})))}let Ww=0;function Uw(e){var t=++Ww;return toString(e)+t}function Yw(e,t,n=1){null==t&&(t=e,e=0);let r=e=>e<t;n<0&&(r=e=>t<e);const o=[];for(let i=e;r(i);i+=n)o.push(i);return o}function Gw(e,t){return e.reduce(((e,n,r)=>(e[n]=t[r],e)),{})}let qw=Rw,Kw=Hw.uniqueId;var Xw={run:function(e){("greedy"===e.graph().acyclicer?qw(e,(t=e,e=>t.edge(e).weight)):function(e){let t=[],n={},r={};function o(i){r.hasOwnProperty(i)||(r[i]=!0,n[i]=!0,e.outEdges(i).forEach((e=>{n.hasOwnProperty(e.w)?t.push(e):o(e.w)})),delete n[i])}return e.nodes().forEach(o),t}(e)).forEach((t=>{let n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,Kw("rev"))}));var t},undo:function(e){e.edges().forEach((t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}};let Zw=Hw;var Jw={run:function(e){e.graph().dummyChains=[],e.edges().forEach((t=>function(e,t){let n,r,o,i=t.v,a=e.node(i).rank,s=t.w,l=e.node(s).rank,c=t.name,d=e.edge(t),u=d.labelRank;if(l===a+1)return;for(e.removeEdge(t),o=0,++a;a<l;++o,++a)d.points=[],r={width:0,height:0,edgeLabel:d,edgeObj:t,rank:a},n=Zw.addDummyNode(e,"edge",r,"_d"),a===u&&(r.width=d.width,r.height=d.height,r.dummy="edge-label",r.labelpos=d.labelpos),e.setEdge(i,n,{weight:d.weight},c),0===o&&e.graph().dummyChains.push(n),i=n;e.setEdge(i,s,{weight:d.weight},c)}(e,t)))},undo:function(e){e.graph().dummyChains.forEach((t=>{let n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)}))}};var Qw={longestPath:function(e){var t={};e.sources().forEach((function n(r){var o=e.node(r);if(t.hasOwnProperty(r))return o.rank;t[r]=!0;var i=Math.min(...e.outEdges(r).map((t=>null==t?Number.POSITIVE_INFINITY:n(t.w)-e.edge(t).minlen)));return i===Number.POSITIVE_INFINITY&&(i=0),o.rank=i}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}};var ek=Dw.Graph,tk=Qw.slack,nk=function(e){var t,n,r=new ek({directed:!1}),o=e.nodes()[0],i=e.nodeCount();r.setNode(o,{});for(;rk(r,e)<i;)t=ok(r,e),n=r.hasNode(t.v)?tk(e,t):-tk(e,t),ik(r,e,n);return r};function rk(e,t){return e.nodes().forEach((function n(r){t.nodeEdges(r).forEach((o=>{var i=o.v,a=r===i?o.w:i;e.hasNode(a)||tk(t,o)||(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))}))})),e.nodeCount()}function ok(e,t){return t.edges().reduce(((n,r)=>{let o=Number.POSITIVE_INFINITY;return e.hasNode(r.v)!==e.hasNode(r.w)&&(o=tk(t,r)),o<n[0]?[o,r]:n}),[Number.POSITIVE_INFINITY,null])[1]}function ik(e,t,n){e.nodes().forEach((e=>t.node(e).rank+=n))}var ak=nk,sk=Qw.slack,lk=Qw.longestPath,ck=Dw.alg.preorder,dk=Dw.alg.postorder,uk=Hw.simplify,hk=fk;function fk(e){e=uk(e),lk(e);var t,n=ak(e);for(mk(n),pk(n,e);t=yk(n);)bk(n,e,t,xk(n,e,t))}function pk(e,t){var n=dk(e,e.nodes());(n=n.slice(0,n.length-1)).forEach((n=>function(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=gk(e,t,n)}(e,t,n)))}function gk(e,t,n){var r=e.node(n).parent,o=!0,i=t.edge(n,r),a=0;return i||(o=!1,i=t.edge(r,n)),a=i.weight,t.nodeEdges(n).forEach((i=>{var s,l,c=i.v===n,d=c?i.w:i.v;if(d!==r){var u=c===o,h=t.edge(i).weight;if(a+=u?h:-h,s=n,l=d,e.hasEdge(s,l)){var f=e.edge(n,d).cutvalue;a+=u?-f:f}}})),a}function mk(e,t){arguments.length<2&&(t=e.nodes()[0]),vk(e,{},1,t)}function vk(e,t,n,r,o){var i=n,a=e.node(r);return t[r]=!0,e.neighbors(r).forEach((o=>{t.hasOwnProperty(o)||(n=vk(e,t,n,o,r))})),a.low=i,a.lim=n++,o?a.parent=o:delete a.parent,n}function yk(e){return e.edges().find((t=>e.edge(t).cutvalue<0))}function xk(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),a=e.node(o),s=i,l=!1;return i.lim>a.lim&&(s=a,l=!0),t.edges().filter((t=>l===wk(e,e.node(t.v),s)&&l!==wk(e,e.node(t.w),s))).reduce(((e,n)=>sk(t,n)<sk(t,e)?n:e))}function bk(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),mk(e),pk(e,t),function(e,t){var n=e.nodes().find((e=>!t.node(e).parent)),r=ck(e,n);(r=r.slice(1)).forEach((n=>{var r=e.node(n).parent,o=t.edge(n,r),i=!1;o||(o=t.edge(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)}))}(e,t)}function wk(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}fk.initLowLimValues=mk,fk.initCutValues=pk,fk.calcCutValue=gk,fk.leaveEdge=yk,fk.enterEdge=xk,fk.exchangeEdges=bk;var kk=Qw.longestPath,Ek=nk,Ck=hk,Sk=function(e){switch(e.graph().ranker){case"network-simplex":default:jk(e);break;case"tight-tree":!function(e){kk(e),Ek(e)}(e);break;case"longest-path":Nk(e)}};var Nk=kk;function jk(e){Ck(e)}let Ik=Hw;function Ok(e,t,n,r,o,i,a){let s=e.children(a);if(!s.length)return void(a!==t&&e.setEdge(t,a,{weight:0,minlen:n}));let l=Ik.addBorderNode(e,"_bt"),c=Ik.addBorderNode(e,"_bb"),d=e.node(a);e.setParent(l,a),d.borderTop=l,e.setParent(c,a),d.borderBottom=c,s.forEach((s=>{Ok(e,t,n,r,o,i,s);let d=e.node(s),u=d.borderTop?d.borderTop:s,h=d.borderBottom?d.borderBottom:s,f=d.borderTop?r:2*r,p=u!==h?1:o-i[a]+1;e.setEdge(l,u,{weight:f,minlen:p,nestingEdge:!0}),e.setEdge(h,c,{weight:f,minlen:p,nestingEdge:!0})})),e.parent(a)||e.setEdge(t,l,{weight:0,minlen:o+i[a]})}let Mk=Hw;function Dk(e,t,n,r,o,i){let a={width:0,height:0,rank:i,borderType:t},s=o[t][i-1],l=Mk.addDummyNode(e,"border",a,n);o[t][i]=l,e.setParent(l,r),s&&e.setEdge(s,l,{weight:1})}function Tk(e){e.nodes().forEach((t=>Pk(e.node(t)))),e.edges().forEach((t=>Pk(e.edge(t))))}function Pk(e){let t=e.width;e.width=e.height,e.height=t}function Ak(e){e.y=-e.y}function _k(e){let t=e.x;e.x=e.y,e.y=t}let Rk=Hw;let zk=Hw.zipObject;function Lk(e,t,n){let r=zk(n,n.map(((e,t)=>t))),o=t.flatMap((t=>e.outEdges(t).map((t=>({pos:r[t.w],weight:e.edge(t).weight}))).sort(((e,t)=>e.pos-t.pos)))),i=1;for(;i<n.length;)i<<=1;let a=2*i-1;i-=1;let s=new Array(a).fill(0),l=0;return o.forEach((e=>{let t=e.pos+i;s[t]+=e.weight;let n=0;for(;t>0;)t%2&&(n+=s[t+1]),t=t-1>>1,s[t]+=e.weight;l+=e.weight*n})),l}let Bk=Hw;let Fk=Hw;function Hk(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}let Vk=function(e,t=[]){return t.map((t=>{let n=e.inEdges(t);if(n.length){let r=n.reduce(((t,n)=>{let r=e.edge(n),o=e.node(n.v);return{sum:t.sum+r.weight*o.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}}))},$k=function(e,t){let n={};return e.forEach(((e,t)=>{let r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};void 0!==e.barycenter&&(r.barycenter=e.barycenter,r.weight=e.weight)})),t.edges().forEach((e=>{let t=n[e.v],r=n[e.w];void 0!==t&&void 0!==r&&(r.indegree++,t.out.push(n[e.w]))})),function(e){let t=[];function n(e){return t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&function(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function r(t){return n=>{n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){let o=e.pop();t.push(o),o.in.reverse().forEach(n(o)),o.out.forEach(r(o))}return t.filter((e=>!e.merged)).map((e=>Bk.pick(e,["vs","i","barycenter","weight"])))}(Object.values(n).filter((e=>!e.indegree)))},Wk=function(e,t){let n=Fk.partition(e,(e=>e.hasOwnProperty("barycenter"))),r=n.lhs,o=n.rhs.sort(((e,t)=>t.i-e.i)),i=[],a=0,s=0,l=0;r.sort((c=!!t,(e,t)=>e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:c?t.i-e.i:e.i-t.i)),l=Hk(i,o,l),r.forEach((e=>{l+=e.vs.length,i.push(e.vs),a+=e.barycenter*e.weight,s+=e.weight,l=Hk(i,o,l)}));var c;let d={vs:i.flat(!0)};s&&(d.barycenter=a/s,d.weight=s);return d};var Uk=function e(t,n,r,o){let i=t.children(n),a=t.node(n),s=a?a.borderLeft:void 0,l=a?a.borderRight:void 0,c={};s&&(i=i.filter((e=>e!==s&&e!==l)));let d=Vk(t,i);d.forEach((n=>{if(t.children(n.v).length){let s=e(t,n.v,r,o);c[n.v]=s,s.hasOwnProperty("barycenter")&&(a=s,void 0!==(i=n).barycenter?(i.barycenter=(i.barycenter*i.weight+a.barycenter*a.weight)/(i.weight+a.weight),i.weight+=a.weight):(i.barycenter=a.barycenter,i.weight=a.weight))}var i,a}));let u=$k(d,r);!function(e,t){e.forEach((e=>{e.vs=e.vs.flatMap((e=>t[e]?t[e].vs:e))}))}(u,c);let h=Wk(u,o);if(s&&(h.vs=[s,h.vs,l].flat(!0),t.predecessors(s).length)){let e=t.node(t.predecessors(s)[0]),n=t.node(t.predecessors(l)[0]);h.hasOwnProperty("barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+e.order+n.order)/(h.weight+2),h.weight+=2}return h};let Yk=Dw.Graph,Gk=Hw;let qk=function(e){let t={},n=e.nodes().filter((t=>!e.children(t).length)),r=Math.max(...n.map((t=>e.node(t).rank))),o=Rk.range(r+1).map((()=>[]));return n.sort(((t,n)=>e.node(t).rank-e.node(n).rank)).forEach((function n(r){if(t[r])return;t[r]=!0;let i=e.node(r);o[i.rank].push(r),e.successors(r).forEach(n)})),o},Kk=function(e,t){let n=0;for(let r=1;r<t.length;++r)n+=Lk(e,t[r-1],t[r]);return n},Xk=Uk,Zk=function(e,t,n){let r=function(e){var t;for(;e.hasNode(t=Gk.uniqueId("_root")););return t}(e),o=new Yk({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((t=>e.node(t)));return e.nodes().forEach((i=>{let a=e.node(i),s=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(o.setNode(i),o.setParent(i,s||r),e[n](i).forEach((t=>{let n=t.v===i?t.w:t.v,r=o.edge(n,i),a=void 0!==r?r.weight:0;o.setEdge(n,i,{weight:e.edge(t).weight+a})})),a.hasOwnProperty("minRank")&&o.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))})),o},Jk=function(e,t,n){let r,o={};n.forEach((n=>{let i,a,s=e.parent(n);for(;s;){if(i=e.parent(s),i?(a=o[i],o[i]=s):(a=r,r=s),a&&a!==s)return void t.setEdge(a,s);s=i}}))},Qk=Dw.Graph,eE=Hw;var tE=function e(t,n){if(n&&"function"==typeof n.customOrder)return void n.customOrder(t,e);let r=eE.maxRank(t),o=nE(t,eE.range(1,r+1),"inEdges"),i=nE(t,eE.range(r-1,-1,-1),"outEdges"),a=qk(t);if(oE(t,a),n&&n.disableOptimalOrderHeuristic)return;let s,l=Number.POSITIVE_INFINITY;for(let c=0,d=0;d<4;++c,++d){rE(c%2?o:i,c%4>=2),a=eE.buildLayerMatrix(t);let e=Kk(t,a);e<l&&(d=0,s=Object.assign({},a),l=e)}oE(t,s)};function nE(e,t,n){return t.map((function(t){return Zk(e,t,n)}))}function rE(e,t){let n=new Qk;e.forEach((function(e){let r=e.graph().root,o=Xk(e,r,n,t);o.vs.forEach(((t,n)=>e.node(t).order=n)),Jk(e,n,o.vs)}))}function oE(e,t){Object.values(t).forEach((t=>t.forEach(((t,n)=>e.node(t).order=n))))}let iE=Dw.Graph,aE=Hw;var sE=function(e){let t,n=aE.buildLayerMatrix(e),r=Object.assign(lE(e,n),cE(e,n)),o={};["u","d"].forEach((i=>{t="u"===i?n:Object.values(n).reverse(),["l","r"].forEach((n=>{"r"===n&&(t=t.map((e=>Object.values(e).reverse())));let a=("u"===i?e.predecessors:e.successors).bind(e),s=hE(e,t,r,a),l=fE(e,t,s.root,s.align,"r"===n);"r"===n&&(l=aE.mapValues(l,(e=>-e))),o[i+n]=l}))}));let i=pE(e,o);return gE(o,i),mE(o,e.graph().align)};function lE(e,t){let n={};return t.length&&t.reduce((function(t,r){let o=0,i=0,a=t.length,s=r[r.length-1];return r.forEach(((t,l)=>{let c=function(e,t){if(e.node(t).dummy)return e.predecessors(t).find((t=>e.node(t).dummy))}(e,t),d=c?e.node(c).order:a;(c||t===s)&&(r.slice(i,l+1).forEach((t=>{e.predecessors(t).forEach((r=>{let i=e.node(r),a=i.order;!(a<o||d<a)||i.dummy&&e.node(t).dummy||dE(n,r,t)}))})),i=l+1,o=d)})),r})),n}function cE(e,t){let n={};function r(t,r,o,i,a){let s;aE.range(r,o).forEach((r=>{s=t[r],e.node(s).dummy&&e.predecessors(s).forEach((t=>{let r=e.node(t);r.dummy&&(r.order<i||r.order>a)&&dE(n,t,s)}))}))}return t.length&&t.reduce((function(t,n){let o,i=-1,a=0;return n.forEach(((s,l)=>{if("border"===e.node(s).dummy){let t=e.predecessors(s);t.length&&(o=e.node(t[0]).order,r(n,a,l,i,o),a=l,i=o)}r(n,a,n.length,o,t.length)})),n})),n}function dE(e,t,n){if(t>n){let e=t;t=n,n=e}let r=e[t];r||(e[t]=r={}),r[n]=!0}function uE(e,t,n){if(t>n){let e=t;t=n,n=e}return!!e[t]&&e[t].hasOwnProperty(n)}function hE(e,t,n,r){let o={},i={},a={};return t.forEach((e=>{e.forEach(((e,t)=>{o[e]=e,i[e]=e,a[e]=t}))})),t.forEach((e=>{let t=-1;e.forEach((e=>{let s=r(e);if(s.length){s=s.sort(((e,t)=>a[e]-a[t]));let r=(s.length-1)/2;for(let l=Math.floor(r),c=Math.ceil(r);l<=c;++l){let r=s[l];i[e]===e&&t<a[r]&&!uE(n,e,r)&&(i[r]=e,i[e]=o[e]=o[r],t=a[r])}}}))})),{root:o,align:i}}function fE(e,t,n,r,o){let i={},a=function(e,t,n,r){let o=new iE,i=e.graph(),a=function(e,t,n){return(r,o,i)=>{let a,s=r.node(o),l=r.node(i),c=0;if(c+=s.width/2,s.hasOwnProperty("labelpos"))switch(s.labelpos.toLowerCase()){case"l":a=-s.width/2;break;case"r":a=s.width/2}if(a&&(c+=n?a:-a),a=0,c+=(s.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,l.hasOwnProperty("labelpos"))switch(l.labelpos.toLowerCase()){case"l":a=l.width/2;break;case"r":a=-l.width/2}return a&&(c+=n?a:-a),a=0,c}}(i.nodesep,i.edgesep,r);return t.forEach((t=>{let r;t.forEach((t=>{let i=n[t];if(o.setNode(i),r){var s=n[r],l=o.edge(s,i);o.setEdge(s,i,Math.max(a(e,t,r),l||0))}r=t}))})),o}(e,t,n,o),s=o?"borderLeft":"borderRight";function l(e,t){let n=a.nodes(),r=n.pop(),o={};for(;r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return l((function(e){i[e]=a.inEdges(e).reduce(((e,t)=>Math.max(e,i[t.v]+a.edge(t))),0)}),a.predecessors.bind(a)),l((function(t){let n=a.outEdges(t).reduce(((e,t)=>Math.min(e,i[t.w]-a.edge(t))),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==s&&(i[t]=Math.max(i[t],n))}),a.successors.bind(a)),Object.keys(r).forEach((e=>i[e]=i[n[e]])),i}function pE(e,t){return Object.values(t).reduce(((t,n)=>{let r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;Object.entries(n).forEach((([t,n])=>{let i=function(e,t){return e.node(t).width}(e,t)/2;r=Math.max(n+i,r),o=Math.min(n-i,o)}));const i=r-o;return i<t[0]&&(t=[i,n]),t}),[Number.POSITIVE_INFINITY,null])[1]}function gE(e,t){let n=Object.values(t),r=Math.min(...n),o=Math.max(...n);["u","d"].forEach((n=>{["l","r"].forEach((i=>{let a=n+i,s=e[a];if(s===t)return;let l=Object.values(s),c=r-Math.min(...l);"l"!==i&&(c=o-Math.max(...l)),c&&(e[a]=aE.mapValues(s,(e=>e+c)))}))}))}function mE(e,t){return aE.mapValues(e.ul,((n,r)=>{if(t)return e[t.toLowerCase()][r];{let t=Object.values(e).map((e=>e[r])).sort(((e,t)=>e-t));return(t[1]+t[2])/2}}))}let vE=Hw,yE=sE;let xE=Xw,bE=Jw,wE=Sk,kE=Hw.normalizeRanks,EE=function(e){let t=function(e){let t={},n=0;function r(o){let i=n;e.children(o).forEach(r),t[o]={low:i,lim:n++}}return e.children().forEach(r),t}(e);e.graph().dummyChains.forEach((n=>{let r=e.node(n),o=r.edgeObj,i=function(e,t,n,r){let o,i,a=[],s=[],l=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);o=n;do{o=e.parent(o),a.push(o)}while(o&&(t[o].low>l||c>t[o].lim));i=o,o=r;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,t,o.v,o.w),a=i.path,s=i.lca,l=0,c=a[l],d=!0;for(;n!==o.w;){if(r=e.node(n),d){for(;(c=a[l])!==s&&e.node(c).maxRank<r.rank;)l++;c===s&&(d=!1)}if(!d){for(;l<a.length-1&&e.node(c=a[l+1]).minRank<=r.rank;)l++;c=a[l]}e.setParent(n,c),n=e.successors(n)[0]}}))},CE=Hw.removeEmptyRanks,SE={run:function(e){let t=Ik.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&i.forEach((e=>n(e,o+1))),t[r]=o}return e.children().forEach((e=>n(e,1))),t}(e),r=Math.max(...Object.values(n))-1,o=2*r+1;e.graph().nestingRoot=t,e.edges().forEach((t=>e.edge(t).minlen*=o));let i=function(e){return e.edges().reduce(((t,n)=>t+e.edge(n).weight),0)}(e)+1;e.children().forEach((a=>Ok(e,t,o,i,r,n,a))),e.graph().nodeRankFactor=o},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach((t=>{e.edge(t).nestingEdge&&e.removeEdge(t)}))}},NE=function(e){e.children().forEach((function t(n){let r=e.children(n),o=e.node(n);if(r.length&&r.forEach(t),o.hasOwnProperty("minRank")){o.borderLeft=[],o.borderRight=[];for(let t=o.minRank,r=o.maxRank+1;t<r;++t)Dk(e,"borderLeft","_bl",n,o,t),Dk(e,"borderRight","_br",n,o,t)}}))},jE={adjust:function(e){let t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||Tk(e)},undo:function(e){let t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){e.nodes().forEach((t=>Ak(e.node(t)))),e.edges().forEach((t=>{let n=e.edge(t);n.points.forEach(Ak),n.hasOwnProperty("y")&&Ak(n)}))}(e);"lr"!==t&&"rl"!==t||(!function(e){e.nodes().forEach((t=>_k(e.node(t)))),e.edges().forEach((t=>{let n=e.edge(t);n.points.forEach(_k),n.hasOwnProperty("x")&&_k(n)}))}(e),Tk(e))}},IE=tE,OE=function(e){(function(e){let t=vE.buildLayerMatrix(e),n=e.graph().ranksep,r=0;t.forEach((t=>{const o=t.reduce(((t,n)=>{const r=e.node(n).height;return t>r?t:r}),0);t.forEach((t=>e.node(t).y=r+o/2)),r+=o+n}))})(e=vE.asNonCompoundGraph(e)),Object.entries(yE(e)).forEach((([t,n])=>e.node(t).x=n))},ME=Hw,DE=Dw.Graph;var TE=function(e,t){let n=t&&t.debugTiming?ME.time:ME.notime;n("layout",(()=>{let t=n("  buildLayoutGraph",(()=>function(e){let t=new DE({multigraph:!0,compound:!0}),n=VE(e.graph());return t.setGraph(Object.assign({},AE,HE(n,PE),ME.pick(n,_E))),e.nodes().forEach((n=>{const r=HE(VE(e.node(n)),RE);Object.keys(zE).forEach((e=>{void 0===r[e]&&(r[e]=zE[e])})),t.setNode(n,r),t.setParent(n,e.parent(n))})),e.edges().forEach((n=>{let r=VE(e.edge(n));t.setEdge(n,Object.assign({},BE,HE(r,LE),ME.pick(r,FE)))})),t}(e)));n("  runLayout",(()=>function(e,t){t("    makeSpaceForEdgeLabels",(()=>function(e){let t=e.graph();t.ranksep/=2,e.edges().forEach((n=>{let r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(e))),t("    removeSelfEdges",(()=>function(e){e.edges().forEach((t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e))),t("    acyclic",(()=>xE.run(e))),t("    nestingGraph.run",(()=>SE.run(e))),t("    rank",(()=>wE(ME.asNonCompoundGraph(e)))),t("    injectEdgeLabelProxies",(()=>function(e){e.edges().forEach((t=>{let n=e.edge(t);if(n.width&&n.height){let n=e.node(t.v),r={rank:(e.node(t.w).rank-n.rank)/2+n.rank,e:t};ME.addDummyNode(e,"edge-proxy",r,"_ep")}}))}(e))),t("    removeEmptyRanks",(()=>CE(e))),t("    nestingGraph.cleanup",(()=>SE.cleanup(e))),t("    normalizeRanks",(()=>kE(e))),t("    assignRankMinMax",(()=>function(e){let t=0;e.nodes().forEach((n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))})),e.graph().maxRank=t}(e))),t("    removeEdgeLabelProxies",(()=>function(e){e.nodes().forEach((t=>{let n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(e))),t("    normalize.run",(()=>bE.run(e))),t("    parentDummyChains",(()=>EE(e))),t("    addBorderSegments",(()=>NE(e))),t("    order",(()=>IE(e))),t("    insertSelfEdges",(()=>function(e){var t=ME.buildLayerMatrix(e);t.forEach((t=>{var n=0;t.forEach(((t,r)=>{var o=e.node(t);o.order=r+n,(o.selfEdges||[]).forEach((t=>{ME.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:o.rank,order:r+ ++n,e:t.e,label:t.label},"_se")})),delete o.selfEdges}))}))}(e))),t("    adjustCoordinateSystem",(()=>jE.adjust(e))),t("    position",(()=>OE(e))),t("    positionSelfEdges",(()=>function(e){e.nodes().forEach((t=>{var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}}))}(e))),t("    removeBorderNodes",(()=>function(e){e.nodes().forEach((t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),a=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(a.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}})),e.nodes().forEach((t=>{"border"===e.node(t).dummy&&e.removeNode(t)}))}(e))),t("    normalize.undo",(()=>bE.undo(e))),t("    fixupEdgeLabelCoords",(()=>function(e){e.edges().forEach((t=>{let n=e.edge(t);if(n.hasOwnProperty("x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(e))),t("    undoCoordinateSystem",(()=>jE.undo(e))),t("    translateGraph",(()=>function(e){let t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),a=i.marginx||0,s=i.marginy||0;function l(e){let i=e.x,a=e.y,s=e.width,l=e.height;t=Math.min(t,i-s/2),n=Math.max(n,i+s/2),r=Math.min(r,a-l/2),o=Math.max(o,a+l/2)}e.nodes().forEach((t=>l(e.node(t)))),e.edges().forEach((t=>{let n=e.edge(t);n.hasOwnProperty("x")&&l(n)})),t-=a,r-=s,e.nodes().forEach((n=>{let o=e.node(n);o.x-=t,o.y-=r})),e.edges().forEach((n=>{let o=e.edge(n);o.points.forEach((e=>{e.x-=t,e.y-=r})),o.hasOwnProperty("x")&&(o.x-=t),o.hasOwnProperty("y")&&(o.y-=r)})),i.width=n-t+a,i.height=o-r+s}(e))),t("    assignNodeIntersects",(()=>function(e){e.edges().forEach((t=>{let n,r,o=e.edge(t),i=e.node(t.v),a=e.node(t.w);o.points?(n=o.points[0],r=o.points[o.points.length-1]):(o.points=[],n=a,r=i),o.points.unshift(ME.intersectRect(i,n)),o.points.push(ME.intersectRect(a,r))}))}(e))),t("    reversePoints",(()=>function(e){e.edges().forEach((t=>{let n=e.edge(t);n.reversed&&n.points.reverse()}))}(e))),t("    acyclic.undo",(()=>xE.undo(e)))}(t,n))),n("  updateInputGraph",(()=>function(e,t){e.nodes().forEach((n=>{let r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r.rank=o.rank,t.children(n).length&&(r.width=o.width,r.height=o.height))})),e.edges().forEach((n=>{let r=e.edge(n),o=t.edge(n);r.points=o.points,o.hasOwnProperty("x")&&(r.x=o.x,r.y=o.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)))}))};let PE=["nodesep","edgesep","ranksep","marginx","marginy"],AE={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},_E=["acyclicer","ranker","rankdir","align"],RE=["width","height"],zE={width:0,height:0},LE=["minlen","weight","width","height","labeloffset"],BE={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},FE=["labelpos"];function HE(e,t){return ME.mapValues(ME.pick(e,t),Number)}function VE(e){var t={};return e&&Object.entries(e).forEach((([e,n])=>{"string"==typeof e&&(e=e.toLowerCase()),t[e]=n})),t}let $E=Hw,WE=Dw.Graph;var UE={graphlib:Dw,layout:TE,debug:{debugOrdering:function(e){let t=$E.buildLayerMatrix(e),n=new WE({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach((t=>{n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)})),e.edges().forEach((e=>n.setEdge(e.v,e.w,{},e.name))),t.forEach(((e,t)=>{let r="layer"+t;n.setNode(r,{rank:"same"}),e.reduce(((e,t)=>(n.setEdge(e,t,{style:"invis"}),t)))})),n}},util:{time:Hw.time,notime:Hw.notime},version:"1.1.2"};const YE=(new UE.graphlib.Graph).setDefaultEdgeLabel((()=>({}))),GE=(e,t,n)=>(YE.setGraph({rankdir:n.direction,nodesep:150,ranksep:200,ranker:"longest-path"}),t.forEach((e=>YE.setEdge(e.source,e.target))),e.forEach((e=>YE.setNode(e.id,{...e,width:e.width??0,height:e.height??0}))),UE.layout(YE),{nodes:e.map((e=>{const{x:t,y:n}=YE.node(e.id);return{...e,position:{x:t,y:n}}})),edges:t}),qE=new class{createEdge(e,t){return{animated:!0,markerEnd:{type:mv.ArrowClosed},id:`${e}-${t}`,style:{strokeWidth:2},source:e,sourceHandle:"outputs",targetHandle:"inputs",target:t}}createNode(e,t){return{id:e,data:{atom:t,forceWidth:300},width:300,type:"custom",height:zb(te.get(t).code.trim().split("\n").length),position:{x:0,y:0}}}createElements(e,t,n,r){const o=[],i=[],a=new Set,s=new Set;for(const l of Object.values(n)){if("marimo"===l.value&&"mo"===l.name)continue;const{declaredBy:e,usedBy:t}=l;for(const n of e)for(const e of t){const t=`${n}-${e}`;s.has(t)||(s.add(t),a.add(n),a.add(e),i.push(this.createEdge(n,e)))}}for(const[l,c]of qo.zip(e,t)){r||o.push(this.createNode(l,c));const e=a.has(l),t=te.get(c).code.trim().startsWith("mo.md");!e&&t||o.push(this.createNode(l,c))}return{nodes:o,edges:i}}},KE=({cellIds:e,variables:t,cellAtoms:n,children:r,layoutDirection:i,settings:a})=>{const s=o.useMemo((()=>{let r=qE.createElements(e,n,t,a.hidePureMarkdown);return r=GE(r.nodes,r.edges,{direction:i}),r}),[]),[l,c,d]=vb(s.nodes),[u,f,p]=yb(s.edges),g=h((e=>{const t=GE(e.nodes,e.edges,{direction:i});c(t.nodes),f(t.edges)}));o.useEffect((()=>{g(qE.createElements(e,n,t,a.hidePureMarkdown))}),[e,t,n,g,a.hidePureMarkdown]);const[m,v]=o.useState();return Ub(),x.jsx(Lb.Provider,{value:i,children:x.jsxs(gb,{nodes:l,edges:u,nodeTypes:Fb,minZoom:.2,fitViewOptions:{minZoom:.5,maxZoom:1.5},onNodeClick:(e,t)=>{v({type:"node",id:t.id})},onEdgeClick:(e,t)=>{const{source:n,target:r}=t;v({type:"edge",source:n,target:r})},onNodeDoubleClick:(e,t)=>{ti(t.id,"focus")},fitView:!0,onNodesChange:d,onEdgesChange:p,zoomOnDoubleClick:!1,nodesConnectable:!1,children:[x.jsx(Rb,{color:"#ccc",variant:jb.Dots}),x.jsx(Ob,{position:"bottom-right",showInteractive:!1}),x.jsx(Wb,{selection:m,variables:t,edges:u}),r]})})},XE=c("_minimap_"),ZE=c({hidePureMarkdown:!0}),JE=e=>{const[t,n]=E(XE),[r,o]=E(ZE);return x.jsx(sb,{children:"_minimap_"===t?x.jsx(Gb,{...e,children:x.jsx($b,{settings:r,onSettingsChange:o,view:t,onChange:n})}):x.jsx(KE,{...e,settings:r,layoutDirection:t,children:x.jsx($b,{settings:r,onSettingsChange:o,view:t,onChange:n})})},t)},QE=()=>{const e=za(),t=Ko(),[n]=ni();return x.jsx("div",{className:Mt("w-full h-full flex-1 mx-auto -mb-4 relative"),children:x.jsx(JE,{cellAtoms:n,variables:e,cellIds:t})})};const eC="name",tC="type-value",nC="defs-refs",rC=[{id:eC,accessorFn:e=>[e.name,e.declaredBy],enableSorting:!0,sortingFn:"alphanumeric",header:({column:e})=>x.jsx(gi,{header:"Name",column:e}),cell:({getValue:e})=>{const[t,n]=e();return x.jsx(Vb,{name:t,declaredBy:n})}},{id:tC,accessorFn:e=>[e.dataType,e.value],enableSorting:!0,sortingFn:"alphanumeric",header:({column:e})=>x.jsx(gi,{header:x.jsxs("div",{className:"flex flex-col gap-1",children:[x.jsx("span",{children:"Type"}),x.jsx("span",{children:"Value"})]}),column:e}),cell:({getValue:e})=>{const[t,n]=e();return x.jsxs("div",{className:"max-w-[150px]",children:[x.jsx("div",{className:"text-ellipsis overflow-hidden whitespace-nowrap text-muted-foreground font-mono text-xs",children:t}),x.jsx("div",{className:"text-ellipsis overflow-hidden whitespace-nowrap",title:n,children:n})]})}},{id:nC,accessorFn:e=>[e.declaredBy,e.usedBy,e.name],enableSorting:!0,sortingFn:"basic",header:({column:e})=>x.jsx(gi,{header:x.jsxs("div",{className:"flex flex-col gap-1",children:[x.jsx("span",{children:"Declared By"}),x.jsx("span",{children:"Used By"})]}),column:e}),cell:({getValue:e})=>{const[t,n,r]=e(),o=e=>{const t=Qo(e);t&&dn(t,r)};return x.jsxs("div",{className:"flex flex-col gap-1 py-1",children:[x.jsxs("div",{className:"flex flex-row overflow-auto gap-2 items-center",children:[x.jsx("span",{title:"Declared by",children:x.jsx(Us,{className:"w-3.5 h-3.5 text-muted-foreground"})}),1===t.length?x.jsx(Zo,{variant:"focus",cellId:t[0],skipScroll:!0,onClick:()=>o(t[0])}):x.jsx("div",{className:"text-destructive flex flex-row gap-2",children:t.slice(0,3).map(((e,n)=>x.jsxs("span",{className:"flex",children:[x.jsx(Zo,{variant:"focus",cellId:e,skipScroll:!0,className:"whitespace-nowrap text-destructive",onClick:()=>o(e)},e),n<t.length-1&&", "]},e)))})]}),x.jsxs("div",{className:"flex flex-row overflow-auto gap-2 items-baseline",children:[x.jsx("span",{title:"Used by",children:x.jsx(tl,{className:"w-3.5 h-3.5 text-muted-foreground"})}),x.jsx(Hb,{maxCount:3,cellIds:n,skipScroll:!0,onClick:o})]})]})}}];const oC=o.memo((({className:e,cellIds:t,variables:n})=>{const[r,i]=s.useState([]),[a,l]=s.useState(""),c=o.useMemo((()=>{const e=new Map;return t.forEach(((t,n)=>e.set(t,n))),function(e,t,n){t||(t={id:nC,desc:!1});let r=[];switch(t.id){case eC:r=Ga(e,(e=>e.name));break;case tC:r=Ga(e,(e=>e.dataType));break;case nC:r=Ga(e,(e=>n.get(e.declaredBy[0])))}return t.desc?r.reverse():r}(Object.values(n),r[0],e)}),[n,r,t]),d=ri({data:c,columns:rC,getCoreRowModel:oi(),onGlobalFilterChange:l,getFilteredRowModel:ii(),enableFilters:!0,enableGlobalFilter:!0,getColumnCanGlobalFilter:e=>e.columnDef.enableGlobalFilter??!0,globalFilterFn:"auto",manualSorting:!0,onSortingChange:i,getSortedRowModel:ai(),state:{sorting:r,globalFilter:a}});return x.jsxs(x.Fragment,{children:[x.jsx(si,{className:"w-full",placeholder:"Search",value:a,onChange:e=>l(e.target.value)}),x.jsxs(li,{className:Mt("w-full text-sm flex-1 border-separate border-spacing-0",e),children:[x.jsx(ci,{children:x.jsx(di,{className:"whitespace-nowrap text-xs",children:d.getFlatHeaders().map((e=>x.jsx(ui,{className:"sticky top-0 bg-background border-b",children:hi(e.column.columnDef.header,e.getContext())},e.id)))})}),x.jsx(fi,{children:d.getRowModel().rows.map((e=>x.jsx(di,{className:"hover:bg-accent",children:e.getVisibleCells().map((e=>x.jsx(pi,{className:"border-b",children:hi(e.column.columnDef.cell,e.getContext())},e.id)))},e.id)))})]})]})}));oC.displayName="VariableTable";const iC=()=>{const e=za(),t=Ko();return 0===Object.keys(e).length?x.jsx(Jg,{title:"No variables",description:"Global variables will appear here.",icon:x.jsx(Ue,{})}):x.jsx(oC,{className:"flex-1",cellIds:t,variables:e})},aC=()=>{const e=mi(),{clearLogs:t}=X();return 0===e.length?x.jsx(Jg,{title:"No logs",description:x.jsxs("span",{children:[x.jsx("code",{className:"border rounded px-1",children:"stdout"})," and"," ",x.jsx("code",{className:"border rounded px-1",children:"stderr"})," logs will appear here."]}),icon:x.jsx(Ge,{})}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"flex flex-row justify-end px-2 py-1",children:x.jsx("button",{"data-testid":"clear-logs-button",className:"text-xs font-semibold text-accent-foreground",onClick:t,children:"Clear"})}),x.jsx("div",{className:"overflow-auto flex-1",children:x.jsx(sC,{logs:e,className:"min-w-[300px]"})})]})},sC=({logs:e,className:t})=>{const n="opacity-70 group-hover:bg-[var(--gray-3)] group-hover:opacity-100";return x.jsx("div",{className:Mt("flex flex-col",t),children:x.jsx("pre",{className:"grid text-xs font-mono gap-1 whitespace-break-spaces font-semibold align-left",children:x.jsx("div",{className:"grid grid-cols-[30px,1fr]",style:{whiteSpace:"pre-wrap"},children:e.map(((e,t)=>x.jsxs("div",{className:"contents group",children:[x.jsx("span",{className:Mt(n,"text-right col-span-1 py-1 pr-1"),children:t+1}),x.jsx("span",{className:Mt(n,"px-2 flex gap-x-1.5 py-1 flex-wrap"),children:lC(e)})]},t)))})})})};function lC(e){const t=vi(e.timestamp),n=cC[e.level],r=e.level.toUpperCase();return x.jsxs(x.Fragment,{children:[x.jsxs("span",{className:"flex-shrink-0 text-[var(--gray-10)]",children:["[",t,"]"]}),x.jsx("span",{className:Mt("flex-shrink-0",n),children:r}),x.jsxs("span",{className:"flex-shrink-0 text-[var(--gray-10)]",children:["(",x.jsx(Zo,{cellId:e.cellId}),")"]}),e.message]})}const cC={stdout:"text-[var(--grass-9)]",stderr:"text-[var(--red-9)]"},dC=()=>{const{documentation:e}=d(rn);return e?x.jsx("div",{className:"p-3 overflow-y-auto overflow-x-hidden h-full docs-documentation flex flex-col gap-4",children:ao({html:e})}):x.jsx(Jg,{title:"View docs as you type",description:"Move your text cursor over a symbol to see its documentation.",icon:x.jsx(Zs,{})})};function uC(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:"contentBoxSize"===t?e.contentRect["inlineSize"===n?"width":"height"]:void 0}function hC(e){void 0===e&&(e={});var t=e.onResize,n=o.useRef(void 0);n.current=t;var r=e.round||Math.round,i=o.useRef(),a=o.useState({width:void 0,height:void 0}),s=a[0],l=a[1],c=o.useRef(!1);o.useEffect((function(){return c.current=!1,function(){c.current=!0}}),[]);var d=o.useRef({width:void 0,height:void 0}),u=function(e,t){var n=o.useRef(null),r=o.useRef(null);r.current=t;var i=o.useRef(null);o.useEffect((function(){a()}));var a=o.useCallback((function(){var t=i.current,o=r.current,a=t||(o?o instanceof Element?o:o.current:null);n.current&&n.current.element===a&&n.current.subscriber===e||(n.current&&n.current.cleanup&&n.current.cleanup(),n.current={element:a,subscriber:e,cleanup:a?e(a):void 0})}),[e]);return o.useEffect((function(){return function(){n.current&&n.current.cleanup&&(n.current.cleanup(),n.current=null)}}),[]),o.useCallback((function(e){i.current=e,a()}),[a])}(o.useCallback((function(t){return i.current&&i.current.box===e.box&&i.current.round===r||(i.current={box:e.box,round:r,instance:new ResizeObserver((function(t){var o=t[0],i="border-box"===e.box?"borderBoxSize":"device-pixel-content-box"===e.box?"devicePixelContentBoxSize":"contentBoxSize",a=uC(o,i,"inlineSize"),s=uC(o,i,"blockSize"),u=a?r(a):void 0,h=s?r(s):void 0;if(d.current.width!==u||d.current.height!==h){var f={width:u,height:h};d.current.width=u,d.current.height=h,n.current?n.current(f):c.current||l(f)}}))}),i.current.instance.observe(t,{box:e.box}),function(){i.current&&i.current.instance.unobserve(t)}}),[e.box,r]),e.ref);return o.useMemo((function(){return{ref:u,width:s.width,height:s.height}}),[u,s.width,s.height])}const fC=o.createContext(null);function pC(){const e=o.useContext(fC);if(null===e)throw new Error("No Tree Api Provided");return e}const gC=o.createContext(null);const mC=o.createContext(null);const vC=o.createContext(0);function yC(){o.useContext(vC)}function xC(e,t,n){return Math.max(Math.min(e,n),t)}function bC(e){return e&&e.isLeaf}function wC(e){return e&&e.isInternal&&!e.isOpen}function kC(e){var t;return e&&e.isOpen&&!(null===(t=e.children)||void 0===t?void 0:t.length)}const EC=(e,t)=>{let n=e;for(;n;){if(n.id===t.id)return!0;n=n.parent}return!1},CC=e=>{if(!e.parent)throw Error("Node does not have a parent");return e.parent.children.findIndex((t=>t.id===e.id))};function SC(e,t){if(!e)return null;if(e.id===t)return e;if(e.children)for(let n of e.children){const e=SC(n,t);if(e)return e}return null}function NC(e,t){if(t(e),e.children)for(let n of e.children)NC(n,t)}function jC(e){const t=DC(e);let n;for(let r=0;r<t.length;++r){if(t[r]===e){n=OC(t,r);break}}null==n||n.focus()}function IC(e){const t=DC(e);let n;for(let r=0;r<t.length;++r){if(t[r]===e){n=MC(t,r);break}}null==n||n.focus()}function OC(e,t){return t+1<e.length?e[t+1]:e[0]}function MC(e,t){return t-1>=0?e[t-1]:e[e.length-1]}function DC(e){return Array.from(document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled]), details:not([disabled]), summary:not(:disabled)')).filter((t=>t===e||!e.contains(t)))}function TC(e,t){return"boolean"==typeof t?t:"string"==typeof t?e[t]:t(e)}function PC(e){return null===e?null:AC(e)}function AC(e){return"string"==typeof e?e:e.id}function _C(e,...t){if(e)return e(...t)}function RC(e){return new Promise(((t,n)=>{let r=0;!function o(){r+=1,100===r&&n(),e()?t():setTimeout(o,10)}()}))}function zC(e){var t,n;const r=e.focusedNode;return r?r.isOpen?0:r.parent?r.childIndex+1:0:null!==(n=null===(t=e.root.children)||void 0===t?void 0:t.length)&&void 0!==n?n:0}function LC(e){const t=e.focusedNode;return t?t.isOpen?t.id:t.parent&&!t.parent.isRoot?t.parent.id:null:null}const BC=Object.freeze(Object.defineProperty({__proto__:null,access:TC,bound:xC,dfs:SC,focusNextElement:jC,focusPrevElement:IC,getInsertIndex:zC,getInsertParentId:LC,identify:AC,identifyNull:PC,indexOf:CC,isClosed:wC,isDescendant:EC,isItem:bC,isOpenWithEmptyChildren:kC,mergeRefs:function(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}},noop:function(){},safeRun:_C,waitFor:RC,walk:NC},Symbol.toStringTag,{value:"Module"})),FC={display:"flex",alignItems:"center",zIndex:1},HC={flex:1,height:"2px",background:"#4B91E2",borderRadius:"1px"},VC={width:"4px",height:"4px",boxShadow:"0 0 0 3px #4B91E2",borderRadius:"50%"},$C=s.memo((function({top:e,left:t,indent:n}){const r={position:"absolute",pointerEvents:"none",top:e-2+"px",left:t+"px",right:n+"px"};return x.jsxs("div",{style:Object.assign(Object.assign({},FC),r),children:[x.jsx("div",{style:Object.assign({},VC)}),x.jsx("div",{style:Object.assign({},HC)})]})}));function WC({node:e,attrs:t,innerRef:n,children:r}){return x.jsx("div",Object.assign({},t,{ref:n,onFocus:e=>e.stopPropagation(),onClick:e.handleClick,children:r}))}function UC(e){return x.jsxs("div",{ref:e.dragHandle,style:e.style,children:[x.jsx("span",{onClick:t=>{t.stopPropagation(),e.node.toggle()},children:e.node.isLeaf?"🌳":e.node.isOpen?"🗁":"🗀"})," ",e.node.isEditing?x.jsx(GC,Object.assign({},e)):x.jsx(YC,Object.assign({},e))]})}function YC(e){return x.jsx(x.Fragment,{children:x.jsx("span",{children:e.node.data.name})})}function GC({node:e}){const t=o.useRef();return o.useEffect((()=>{var e,n;null===(e=t.current)||void 0===e||e.focus(),null===(n=t.current)||void 0===n||n.select()}),[]),x.jsx("input",{ref:t,defaultValue:e.data.name,onBlur:()=>e.reset(),onKeyDown:n=>{var r;"Escape"===n.key&&e.reset(),"Enter"===n.key&&e.submit((null===(r=t.current)||void 0===r?void 0:r.value)||"")}})}function qC(e){return{type:"EDIT",id:e}}function KC(e){return{type:"FOCUS",id:e}}class XC{constructor(e){this.handleClick=e=>{e.metaKey&&!this.tree.props.disableMultiSelection?this.isSelected?this.deselect():this.selectMulti():e.shiftKey&&!this.tree.props.disableMultiSelection?this.selectContiguous():(this.select(),this.activate())},this.tree=e.tree,this.id=e.id,this.data=e.data,this.level=e.level,this.children=e.children,this.parent=e.parent,this.isDraggable=e.isDraggable,this.rowIndex=e.rowIndex}get isRoot(){return this.id===ZC}get isLeaf(){return!Array.isArray(this.children)}get isInternal(){return!this.isLeaf}get isOpen(){return!this.isLeaf&&this.tree.isOpen(this.id)}get isClosed(){return!this.isLeaf&&!this.tree.isOpen(this.id)}get isEditable(){return this.tree.isEditable(this.data)}get isEditing(){return this.tree.editingId===this.id}get isSelected(){return this.tree.isSelected(this.id)}get isOnlySelection(){return this.isSelected&&this.tree.hasOneSelection}get isSelectedStart(){var e;return this.isSelected&&!(null===(e=this.prev)||void 0===e?void 0:e.isSelected)}get isSelectedEnd(){var e;return this.isSelected&&!(null===(e=this.next)||void 0===e?void 0:e.isSelected)}get isFocused(){return this.tree.isFocused(this.id)}get isDragging(){return this.tree.isDragging(this.id)}get willReceiveDrop(){return this.tree.willReceiveDrop(this.id)}get state(){return{isClosed:this.isClosed,isDragging:this.isDragging,isEditing:this.isEditing,isFocused:this.isFocused,isInternal:this.isInternal,isLeaf:this.isLeaf,isOpen:this.isOpen,isSelected:this.isSelected,isSelectedEnd:this.isSelectedEnd,isSelectedStart:this.isSelectedStart,willReceiveDrop:this.willReceiveDrop}}get childIndex(){return this.parent&&this.parent.children?this.parent.children.findIndex((e=>e.id===this.id)):-1}get next(){return null===this.rowIndex?null:this.tree.at(this.rowIndex+1)}get prev(){return null===this.rowIndex?null:this.tree.at(this.rowIndex-1)}get nextSibling(){var e,t;const n=this.childIndex;return null!==(t=null===(e=this.parent)||void 0===e?void 0:e.children[n+1])&&void 0!==t?t:null}isAncestorOf(e){if(!e)return!1;let t=e;for(;t;){if(t.id===this.id)return!0;t=t.parent}return!1}select(){this.tree.select(this)}deselect(){this.tree.deselect(this)}selectMulti(){this.tree.selectMulti(this)}selectContiguous(){this.tree.selectContiguous(this)}activate(){this.tree.activate(this)}focus(){this.tree.focus(this)}toggle(){this.tree.toggle(this)}open(){this.tree.open(this)}openParents(){this.tree.openParents(this)}close(){this.tree.close(this)}submit(e){this.tree.submit(this,e)}reset(){this.tree.reset()}clone(){return new XC(Object.assign({},this))}edit(){return this.tree.edit(this)}}const ZC="__REACT_ARBORIST_INTERNAL_ROOT__";function JC(e){var t;function n(t,r,o){const i=e.accessId(t),a=new XC({tree:e,data:t,level:r,parent:o,id:i,children:null,isDraggable:e.isDraggable(t),rowIndex:null}),s=e.accessChildren(t);return s&&(a.children=s.map((e=>n(e,r+1,a)))),a}const r=new XC({tree:e,id:ZC,data:{id:ZC},level:-1,parent:null,children:null,isDraggable:!0,rowIndex:null}),o=null!==(t=e.props.data)&&void 0!==t?t:[];return r.children=o.map((e=>n(e,0,r))),r}const QC={open:(e,t)=>({type:"VISIBILITY_OPEN",id:e,filtered:t}),close:(e,t)=>({type:"VISIBILITY_CLOSE",id:e,filtered:t}),toggle:(e,t)=>({type:"VISIBILITY_TOGGLE",id:e,filtered:t}),clear:e=>({type:"VISIBILITY_CLEAR",filtered:e})};function eS(e={},t){if("VISIBILITY_OPEN"===t.type)return Object.assign(Object.assign({},e),{[t.id]:!0});if("VISIBILITY_CLOSE"===t.type)return Object.assign(Object.assign({},e),{[t.id]:!1});if("VISIBILITY_TOGGLE"===t.type){const n=e[t.id];return Object.assign(Object.assign({},e),{[t.id]:!n})}return"VISIBILITY_CLEAR"===t.type?{}:e}const tS=e=>{var t;return{nodes:{open:{filtered:{},unfiltered:null!==(t=null==e?void 0:e.initialOpenState)&&void 0!==t?t:{}},focus:{id:null,treeFocused:!1},edit:{id:null},drag:{id:null,selectedIds:[],destinationParentId:null,destinationIndex:null},selection:{ids:new Set,anchor:null,mostRecent:null}},dnd:{cursor:{type:"none"},dragId:null,dragIds:[],parentId:null,index:-1}}},nS=e=>({type:"SELECTION_ONLY",id:AC(e)}),rS=e=>({type:"SELECTION_ADD",ids:(Array.isArray(e)?e:[e]).map(AC)}),oS=e=>({type:"SELECTION_REMOVE",ids:(Array.isArray(e)?e:[e]).map(AC)}),iS=e=>Object.assign({type:"SELECTION_SET"},e),aS=e=>({type:"SELECTION_MOST_RECENT",id:null===e?null:AC(e)}),sS=e=>({type:"SELECTION_ANCHOR",id:null===e?null:AC(e)});const lS={cursor:e=>({type:"DND_CURSOR",cursor:e}),dragStart:(e,t)=>({type:"DND_DRAG_START",id:e,dragIds:t}),dragEnd:()=>({type:"DND_DRAG_END"}),hovering:(e,t)=>({type:"DND_HOVERING",parentId:e,index:t})};const cS={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},dS=e=>{if(!e)return{display:"none"};const{x:t,y:n}=e;return{transform:`translate(${t}px, ${n}px)`}},uS=e=>{if(!e)return{display:"none"};const{x:t,y:n}=e;return{transform:`translate(${t+10}px, ${n+10}px)`}};function hS({offset:e,mouse:t,id:n,dragIds:r,isDragging:o}){return x.jsxs(fS,{isDragging:o,children:[x.jsx(pS,{offset:e,children:x.jsx(mS,{id:n,dragIds:r})}),x.jsx(gS,{mouse:t,count:r.length})]})}const fS=o.memo((function(e){return e.isDragging?x.jsx("div",{style:cS,children:e.children}):null}));function pS(e){return x.jsx("div",{className:"row preview",style:dS(e.offset),children:e.children})}function gS(e){const{count:t,mouse:n}=e;return t>1?x.jsx("div",{className:"selected-count",style:uS(n),children:t}):null}const mS=o.memo((function(e){const t=pC(),n=t.get(e.id);return n?x.jsx(t.renderNode,{preview:!0,node:n,style:{paddingLeft:n.level*t.indent,opacity:.2,background:"transparent"},tree:t}):null}));var vS=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function yS(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],o=t[n],!(r===o||vS(r)&&vS(o)))return!1;var r,o;return!0}function xS(e,t){var n;void 0===t&&(t=yS);var r,o=[],i=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return i&&n===this&&t(a,o)||(r=e.apply(this,a),i=!0,n=this,o=a),r}}var bS="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function wS(e){cancelAnimationFrame(e.id)}var kS=-1;function ES(e){if(void 0===e&&(e=!1),-1===kS||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(t),kS=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return kS}var CS=null;function SS(e){if(void 0===e&&(e=!1),null===CS||e){var t=document.createElement("div"),n=t.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var r=document.createElement("div"),o=r.style;return o.width="100px",o.height="100px",t.appendChild(r),document.body.appendChild(t),t.scrollLeft>0?CS="positive-descending":(t.scrollLeft=1,CS=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),CS}return CS}var NS=function(e,t){return e};function jS(e){var t,n=e.getItemOffset,r=e.getEstimatedTotalSize,i=e.getItemSize,a=e.getOffsetForIndexAndAlignment,s=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,c=e.initInstanceProps,d=e.shouldResetStyleCacheOnItemSizeChange,u=e.validateProps;return(t=function(e){var t,h;function f(t){var r;return(r=e.call(this,t)||this)._instanceProps=c(r.props,il(r)),r._outerRef=void 0,r._resetIsScrollingTimeoutId=null,r.state={instance:il(r),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof r.props.initialScrollOffset?r.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},r._callOnItemsRendered=void 0,r._callOnItemsRendered=xS((function(e,t,n,o){return r.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:o})})),r._callOnScroll=void 0,r._callOnScroll=xS((function(e,t,n){return r.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n})})),r._getItemStyle=void 0,r._getItemStyle=function(e){var t,o=r.props,a=o.direction,s=o.itemSize,l=o.layout,c=r._getItemStyleCache(d&&s,d&&l,d&&a);if(c.hasOwnProperty(e))t=c[e];else{var u=n(r.props,e,r._instanceProps),h=i(r.props,e,r._instanceProps),f="horizontal"===a||"horizontal"===l,p="rtl"===a,g=f?u:0;c[e]=t={position:"absolute",left:p?void 0:g,right:p?g:void 0,top:f?0:u,height:f?"100%":h,width:f?h:"100%"}}return t},r._getItemStyleCache=void 0,r._getItemStyleCache=xS((function(e,t,n){return{}})),r._onScrollHorizontal=function(e){var t=e.currentTarget,n=t.clientWidth,o=t.scrollLeft,i=t.scrollWidth;r.setState((function(e){if(e.scrollOffset===o)return null;var t=r.props.direction,a=o;if("rtl"===t)switch(SS()){case"negative":a=-o;break;case"positive-descending":a=i-n-o}return a=Math.max(0,Math.min(a,i-n)),{isScrolling:!0,scrollDirection:e.scrollOffset<a?"forward":"backward",scrollOffset:a,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._onScrollVertical=function(e){var t=e.currentTarget,n=t.clientHeight,o=t.scrollHeight,i=t.scrollTop;r.setState((function(e){if(e.scrollOffset===i)return null;var t=Math.max(0,Math.min(i,o-n));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){var e,t,n,o;null!==r._resetIsScrollingTimeoutId&&wS(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=(e=r._resetIsScrolling,t=150,n=bS(),o={id:requestAnimationFrame((function r(){bS()-n>=t?e.call(null):o.id=requestAnimationFrame(r)}))})},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1,null)}))},r}h=e,(t=f).prototype=Object.create(h.prototype),t.prototype.constructor=t,ol(t,h),f.getDerivedStateFromProps=function(e,t){return IS(e,t),u(e),null};var p=f.prototype;return p.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},p.scrollToItem=function(e,t){void 0===t&&(t="auto");var n=this.props,r=n.itemCount,o=n.layout,i=this.state.scrollOffset;e=Math.max(0,Math.min(e,r-1));var s=0;if(this._outerRef){var l=this._outerRef;s="vertical"===o?l.scrollWidth>l.clientWidth?ES():0:l.scrollHeight>l.clientHeight?ES():0}this.scrollTo(a(this.props,e,t,i,this._instanceProps,s))},p.componentDidMount=function(){var e=this.props,t=e.direction,n=e.initialScrollOffset,r=e.layout;if("number"==typeof n&&null!=this._outerRef){var o=this._outerRef;"horizontal"===t||"horizontal"===r?o.scrollLeft=n:o.scrollTop=n}this._callPropsCallbacks()},p.componentDidUpdate=function(){var e=this.props,t=e.direction,n=e.layout,r=this.state,o=r.scrollOffset;if(r.scrollUpdateWasRequested&&null!=this._outerRef){var i=this._outerRef;if("horizontal"===t||"horizontal"===n)if("rtl"===t)switch(SS()){case"negative":i.scrollLeft=-o;break;case"positive-ascending":i.scrollLeft=o;break;default:var a=i.clientWidth,s=i.scrollWidth;i.scrollLeft=s-a-o}else i.scrollLeft=o;else i.scrollTop=o}this._callPropsCallbacks()},p.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&wS(this._resetIsScrollingTimeoutId)},p.render=function(){var e=this.props,t=e.children,n=e.className,i=e.direction,a=e.height,s=e.innerRef,l=e.innerElementType,c=e.innerTagName,d=e.itemCount,u=e.itemData,h=e.itemKey,f=void 0===h?NS:h,p=e.layout,g=e.outerElementType,m=e.outerTagName,v=e.style,y=e.useIsScrolling,x=e.width,b=this.state.isScrolling,w="horizontal"===i||"horizontal"===p,k=w?this._onScrollHorizontal:this._onScrollVertical,E=this._getRangeToRender(),C=E[0],S=E[1],N=[];if(d>0)for(var j=C;j<=S;j++)N.push(o.createElement(t,{data:u,key:f(j,u),index:j,isScrolling:y?b:void 0,style:this._getItemStyle(j)}));var I=r(this.props,this._instanceProps);return o.createElement(g||m||"div",{className:n,onScroll:k,ref:this._outerRefSetter,style:ir({position:"relative",height:a,width:x,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:i},v)},o.createElement(l||c||"div",{children:N,ref:s,style:{height:w?"100%":I,pointerEvents:b?"none":void 0,width:w?I:"100%"}}))},p._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],n=e[1],r=e[2],o=e[3];this._callOnItemsRendered(t,n,r,o)}if("function"==typeof this.props.onScroll){var i=this.state,a=i.scrollDirection,s=i.scrollOffset,l=i.scrollUpdateWasRequested;this._callOnScroll(a,s,l)}},p._getRangeToRender=function(){var e=this.props,t=e.itemCount,n=e.overscanCount,r=this.state,o=r.isScrolling,i=r.scrollDirection,a=r.scrollOffset;if(0===t)return[0,0,0,0];var c=s(this.props,a,this._instanceProps),d=l(this.props,c,a,this._instanceProps),u=o&&"backward"!==i?1:Math.max(1,n),h=o&&"forward"!==i?1:Math.max(1,n);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+h)),c,d]},f}(o.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var IS=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},OS=jS({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,n,r,o,i){var a=e.direction,s=e.height,l=e.itemCount,c=e.itemSize,d=e.layout,u=e.width,h="horizontal"===a||"horizontal"===d?u:s,f=Math.max(0,l*c-h),p=Math.min(f,t*c),g=Math.max(0,t*c-h+c+i);switch("smart"===n&&(n=r>=g-h&&r<=p+h?"auto":"center"),n){case"start":return p;case"end":return g;case"center":var m=Math.round(g+(p-g)/2);return m<Math.ceil(h/2)?0:m>f+Math.floor(h/2)?f:m;default:return r>=g&&r<=p?r:r<g?g:p}},getStartIndexForOffset:function(e,t){var n=e.itemCount,r=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/r)))},getStopIndexForStartIndex:function(e,t,n){var r=e.direction,o=e.height,i=e.itemCount,a=e.itemSize,s=e.layout,l=e.width,c=t*a,d="horizontal"===r||"horizontal"===s?l:o,u=Math.ceil((d+n-c)/a);return Math.max(0,Math.min(i-1,t+u-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function MS(){var e,t;const n=pC(),r=function(){const e=o.useContext(mC);if(null===e)throw new Error("Provide a DnDContext");return e}().cursor;if(!r||"line"!==r.type)return null;const i=n.indent,a=n.rowHeight*r.index+(null!==(t=null!==(e=n.props.padding)&&void 0!==e?e:n.props.paddingTop)&&void 0!==t?t:0),s=i*r.level,l=n.renderCursor;return x.jsx(l,{top:a,left:s,indent:i})}const DS=o.forwardRef((function(e,t){const{children:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["children"]),o=pC();return x.jsxs("div",Object.assign({ref:t},r,{onClick:e=>{e.currentTarget===e.target&&o.deselectAll()},children:[x.jsx(TS,{}),n]}))})),TS=()=>{const e=pC();return x.jsx("div",{style:{height:e.visibleNodes.length*e.rowHeight,width:"100%",position:"absolute",left:"0",right:"0"},children:x.jsx(MS,{})})};const PS=o.forwardRef((function(e,t){var n,r,o,i,{style:a}=e,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["style"]);const l=pC(),c=null!==(r=null!==(n=l.props.padding)&&void 0!==n?n:l.props.paddingTop)&&void 0!==r?r:0,d=null!==(i=null!==(o=l.props.padding)&&void 0!==o?o:l.props.paddingBottom)&&void 0!==i?i:0;return x.jsx("div",Object.assign({ref:t,style:Object.assign(Object.assign({},a),{height:`${parseFloat(a.height)+c+d}px`})},s))}));var AS,_S,RS=o.createContext({dragDropManager:void 0});function zS(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(!e){var i;if(void 0===t)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=0;(i=new Error(t.replace(/%s/g,(function(){return r[a++]})))).name="Invariant Violation"}throw i.framesToPop=1,i}}(_S=AS||(AS={})).SOURCE="SOURCE",_S.TARGET="TARGET";var LS="dnd-core/INIT_COORDS",BS="dnd-core/BEGIN_DRAG",FS="dnd-core/PUBLISH_DRAG_SOURCE",HS="dnd-core/HOVER",VS="dnd-core/DROP",$S="dnd-core/END_DRAG";function WS(e,t){return{type:LS,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function US(e){return(US="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YS(e){return"object"===US(e)}var GS={type:LS,payload:{clientOffset:null,sourceClientOffset:null}};function qS(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,o=void 0===r||r,i=n.clientOffset,a=n.getSourceClientOffset,s=e.getMonitor(),l=e.getRegistry();e.dispatch(WS(i)),function(e,t,n){zS(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){zS(n.getSource(e),"Expected sourceIds to be registered.")}))}(t,s,l);var c=function(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,s);if(null!==c){var d=null;if(i){if(!a)throw new Error("getSourceClientOffset must be defined");!function(e){zS("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(a),d=a(c)}e.dispatch(WS(i,d));var u=l.getSource(c).beginDrag(s,c);if(null!=u){!function(e){zS(YS(e),"Item must be an object.")}(u),l.pinSource(c);var h=l.getSourceType(c);return{type:BS,payload:{itemType:h,item:u,sourceId:c,clientOffset:i||null,sourceClientOffset:d||null,isSourcePublic:!!o}}}}else e.dispatch(GS)}}function KS(e){return function(){if(e.getMonitor().isDragging())return{type:FS}}}function XS(e,t){return null===t?null===e:Array.isArray(e)?e.some((function(e){return e===t})):e===t}function ZS(e){return function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clientOffset;!function(e){zS(Array.isArray(e),"Expected targetIds to be an array.")}(t);var r=t.slice(0),o=e.getMonitor(),i=e.getRegistry();return function(e,t,n){zS(t.isDragging(),"Cannot call hover while not dragging."),zS(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var o=e[r];zS(e.lastIndexOf(o)===r,"Expected targetIds to be unique in the passed array."),zS(n.getTarget(o),"Expected targetIds to be registered.")}}(r,o,i),function(e,t,n){for(var r=e.length-1;r>=0;r--){var o=e[r];XS(t.getTargetType(o),n)||e.splice(r,1)}}(r,i,o.getItemType()),function(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}(r,o,i),{type:HS,payload:{targetIds:r,clientOffset:n||null}}}}function JS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function QS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JS(Object(n),!0).forEach((function(t){eN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tN(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();!function(e){zS(e.isDragging(),"Cannot call drop while not dragging."),zS(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);var o=function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);o.forEach((function(o,i){var a=function(e,t,n,r){var o=n.getTarget(e),i=o?o.drop(r,e):void 0;(function(e){zS(void 0===e||YS(e),"Drop result must either be an object or undefined.")})(i),void 0===i&&(i=0===t?{}:r.getDropResult());return i}(o,i,r,n),s={type:VS,payload:{dropResult:QS(QS({},t),a)}};e.dispatch(s)}))}}function nN(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){zS(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:$S}}}function rN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iN=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),oN(this,"store",void 0),oN(this,"monitor",void 0),oN(this,"backend",void 0),oN(this,"isSetUp",!1),oN(this,"handleRefCountChange",(function(){var e=r.store.getState().refCount>0;r.backend&&(e&&!r.isSetUp?(r.backend.setup(),r.isSetUp=!0):!e&&r.isSetUp&&(r.backend.teardown(),r.isSetUp=!1))})),this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}var t,n,r;return t=e,n=[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch,n=function(e){return{beginDrag:qS(e),publishDragSource:KS(e),hover:ZS(e),drop:tN(e),endDrag:nN(e)}}(this);return Object.keys(n).reduce((function(r,o){var i,a=n[o];return r[o]=(i=a,function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var a=i.apply(e,r);void 0!==a&&t(a)}),r}),{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}],n&&rN(t.prototype,n),r&&rN(t,r),e}();function aN(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var sN="function"==typeof Symbol&&Symbol.observable||"@@observable",lN=function(){return Math.random().toString(36).substring(7).split("").join(".")},cN={INIT:"@@redux/INIT"+lN(),REPLACE:"@@redux/REPLACE"+lN(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+lN()}};function dN(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(aN(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(aN(1));return n(dN)(e,t)}if("function"!=typeof e)throw new Error(aN(2));var o=e,i=t,a=[],s=a,l=!1;function c(){s===a&&(s=a.slice())}function d(){if(l)throw new Error(aN(3));return i}function u(e){if("function"!=typeof e)throw new Error(aN(4));if(l)throw new Error(aN(5));var t=!0;return c(),s.push(e),function(){if(t){if(l)throw new Error(aN(6));t=!1,c();var n=s.indexOf(e);s.splice(n,1),a=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(aN(7));if(void 0===e.type)throw new Error(aN(8));if(l)throw new Error(aN(9));try{l=!0,i=o(i,e)}finally{l=!1}for(var t=a=s,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:cN.INIT}),(r={dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error(aN(10));o=e,h({type:cN.REPLACE})}})[sN]=function(){var e,t=u;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(aN(11));function n(){e.next&&e.next(d())}return n(),{unsubscribe:t(n)}}})[sN]=function(){return this},e},r}var uN=function(e,t){return e===t};function hN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hN(Object(n),!0).forEach((function(t){pN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gN={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function mN(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gN,r=arguments.length>1?arguments[1]:void 0,o=r.payload;switch(r.type){case LS:case BS:return{initialSourceClientOffset:o.sourceClientOffset,initialClientOffset:o.clientOffset,clientOffset:o.clientOffset};case HS:return e=n.clientOffset,t=o.clientOffset,!e&&!t||e&&t&&e.x===t.x&&e.y===t.y?n:fN(fN({},n),{},{clientOffset:o.clientOffset});case $S:case VS:return gN;default:return n}}var vN="dnd-core/ADD_SOURCE",yN="dnd-core/ADD_TARGET",xN="dnd-core/REMOVE_SOURCE",bN="dnd-core/REMOVE_TARGET";function wN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wN(Object(n),!0).forEach((function(t){EN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function EN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var CN={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function SN(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CN,r=arguments.length>1?arguments[1]:void 0,o=r.payload;switch(r.type){case BS:return kN(kN({},n),{},{itemType:o.itemType,item:o.item,sourceId:o.sourceId,isSourcePublic:o.isSourcePublic,dropResult:null,didDrop:!1});case FS:return kN(kN({},n),{},{isSourcePublic:!0});case HS:return kN(kN({},n),{},{targetIds:o.targetIds});case bN:return-1===n.targetIds.indexOf(o.targetId)?n:kN(kN({},n),{},{targetIds:(e=n.targetIds,t=o.targetId,e.filter((function(e){return e!==t})))});case VS:return kN(kN({},n),{},{dropResult:o.dropResult,didDrop:!0,targetIds:[]});case $S:return kN(kN({},n),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return n}}function NN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case vN:case yN:return e+1;case xN:case bN:return e-1;default:return e}}var jN=[],IN=[];function ON(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case HS:break;case vN:case yN:case bN:case xN:return jN;default:return IN}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,o=t.prevTargetIds,i=void 0===o?[]:o,a=function(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var o=[];return n.forEach((function(e,t){1===e&&o.push(t)})),o}(r,i),s=a.length>0||!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:uN;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(r,i);if(!s)return jN;var l=i[i.length-1],c=r[r.length-1];return l!==c&&(l&&a.push(l),c&&a.push(c)),a}function MN(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function DN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DN(Object(n),!0).forEach((function(t){PN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DN(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function PN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AN(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:ON(r.dirtyHandlerIds,{type:o.type,payload:TN(TN({},o.payload),{},{prevTargetIds:(e=r,t="dragOperation.targetIds",n=[],t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:n||null}),e))})}),dragOffset:mN(r.dragOffset,o),refCount:NN(r.refCount,o),dragOperation:SN(r.dragOperation,o),stateId:MN(r.stateId)}}function _N(e,t){return{x:e.x-t.x,y:e.y-t.y}}function RN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}jN.__IS_NONE__=!0,IN.__IS_ALL__=!0;var LN=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),zN(this,"store",void 0),zN(this,"registry",void 0),this.store=t,this.registry=n}var t,n,r;return t=e,n=[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0}).handlerIds;zS("function"==typeof e,"listener must be a function."),zS(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe((function(){var o=t.store.getState(),i=o.stateId;try{var a=i===r||i===r+1&&!function(e,t){return e!==jN&&(e===IN||void 0===t||(n=e,t.filter((function(e){return n.indexOf(e)>-1}))).length>0);var n}(o.dirtyHandlerIds,n);a||e()}finally{r=i}}))}},{key:"subscribeToOffsetChange",value:function(e){var t=this;zS("function"==typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())}))}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return zS(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return zS(t,"Expected to find a valid target. targetId=".concat(e)),!(!this.isDragging()||this.didDrop())&&XS(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return zS(t,"Expected to find a valid source. sourceId=".concat(e)),!(!this.isDragging()||!this.isSourcePublic())&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}},{key:"isOverTarget",value:function(e){if(!e)return!1;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(r&&!XS(n,r))return!1;var o=this.getTargetIds();if(!o.length)return!1;var i=o.indexOf(e);return t?i===o.length-1:i>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return e=this.store.getState().dragOffset,r=e.clientOffset,o=e.initialClientOffset,i=e.initialSourceClientOffset,r&&o&&i?_N((n=i,{x:(t=r).x+n.x,y:t.y+n.y}),o):null;var e,t,n,r,o,i}},{key:"getDifferenceFromInitialOffset",value:function(){return e=this.store.getState().dragOffset,t=e.clientOffset,n=e.initialClientOffset,t&&n?_N(t,n):null;var e,t,n}}],n&&RN(t.prototype,n),r&&RN(t,r),e}(),BN=0;function FN(e){return(FN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HN(e,t){t&&Array.isArray(e)?e.forEach((function(e){return HN(e,!1)})):zS("string"==typeof e||"symbol"===FN(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}const VN="undefined"!=typeof global?global:self,$N=VN.MutationObserver||VN.WebKitMutationObserver;function WN(e){return function(){const t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}const UN="function"==typeof $N?function(e){let t=1;const n=new $N(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:WN;class YN{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const GN=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=UN(this.flush),this.requestErrorThrow=WN((()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()}))}},qN=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new YN(this.onError,(e=>t[t.length]=e));return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(GN.registerPendingError);function KN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return JN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JN(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QN(e){var t=(BN++).toString();switch(e){case AS.SOURCE:return"S".concat(t);case AS.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function ej(e){switch(e[0]){case"S":return AS.SOURCE;case"T":return AS.TARGET;default:zS(!1,"Cannot parse handler ID: ".concat(e))}}function tj(e,t){var n=e.entries(),r=!1;do{var o=n.next(),i=o.done;if(ZN(o.value,2)[1]===t)return!0;r=!!i}while(!r);return!1}var nj=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),XN(this,"types",new Map),XN(this,"dragSources",new Map),XN(this,"dropTargets",new Map),XN(this,"pinnedSourceId",null),XN(this,"pinnedSource",null),XN(this,"store",void 0),this.store=t}var t,n,r;return t=e,n=[{key:"addSource",value:function(e,t){HN(e),function(e){zS("function"==typeof e.canDrag,"Expected canDrag to be a function."),zS("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),zS("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler(AS.SOURCE,e,t);return this.store.dispatch(function(e){return{type:vN,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){HN(e,!0),function(e){zS("function"==typeof e.canDrop,"Expected canDrop to be a function."),zS("function"==typeof e.hover,"Expected hover to be a function."),zS("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler(AS.TARGET,e,t);return this.store.dispatch(function(e){return{type:yN,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return tj(this.dragSources,e)||tj(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return zS(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return zS(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return zS(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return zS(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return ej(e)===AS.SOURCE}},{key:"isTargetId",value:function(e){return ej(e)===AS.TARGET}},{key:"removeSource",value:function(e){var t,n=this;zS(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:xN,payload:{sourceId:e}}}(e)),t=function(){n.dragSources.delete(e),n.types.delete(e)},GN.enqueueTask(qN.create(t))}},{key:"removeTarget",value:function(e){zS(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:bN,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);zS(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){zS(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=QN(e);return this.types.set(r,t),e===AS.SOURCE?this.dragSources.set(r,n):e===AS.TARGET&&this.dropTargets.set(r,n),r}}],n&&KN(t.prototype,n),r&&KN(t,r),e}();function rj(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return dN(AN,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(arguments.length>3&&void 0!==arguments[3]&&arguments[3]),o=new LN(r,new nj(r)),i=new iN(r,o),a=e(i,t,n);return i.receiveBackend(a),i}var oj=["children"];function ij(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return aj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sj(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var lj=0,cj=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),dj=o.memo((function(e){var t=e.children,n=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uj(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=t;o[cj]||(o[cj]={dragDropManager:rj(e,t,n,r)});return o[cj]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(sj(e,oj)),r=ij(n,2),i=r[0],a=r[1];return o.useEffect((function(){if(a){var e=uj();return++lj,function(){0==--lj&&(e[cj]=null)}}}),[]),x.jsx(RS.Provider,Object.assign({value:i},{children:t}),void 0)}));function uj(){return"undefined"!=typeof global?global:window}function hj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pj=!1,gj=!1,mj=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),fj(this,"internalMonitor",void 0),fj(this,"sourceId",null),this.internalMonitor=t.getMonitor()}var t,n,r;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.sourceId=e}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){zS(!pj,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return pj=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{pj=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;zS(!gj,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return gj=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{gj=!1}}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"isDraggingSource",value:function(e){return this.internalMonitor.isDraggingSource(e)}},{key:"isOverTarget",value:function(e,t){return this.internalMonitor.isOverTarget(e,t)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(e){return this.internalMonitor.subscribeToOffsetChange(e)}},{key:"canDragSource",value:function(e){return this.internalMonitor.canDragSource(e)}},{key:"canDropOnTarget",value:function(e){return this.internalMonitor.canDropOnTarget(e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&hj(t.prototype,n),r&&hj(t,r),e}();function vj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xj=!1,bj=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),yj(this,"internalMonitor",void 0),yj(this,"targetId",null),this.internalMonitor=t.getMonitor()}var t,n,r;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.targetId=e}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;zS(!xj,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return xj=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{xj=!1}}},{key:"isOver",value:function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&vj(t.prototype,n),r&&vj(t,r),e}();function wj(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!o.isValidElement(t)){var r=t;return e(r,n),r}var i=t;return function(e){if("string"!=typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}(i),function(e,t){var n=e.ref;return zS("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?o.cloneElement(e,{ref:function(e){Ej(n,e),Ej(t,e)}}):o.cloneElement(e,{ref:t})}(i,n?function(t){return e(t,n)}:e)}}function kj(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{var o=wj(r);t[n]=function(){return o}}})),t}function Ej(e,t){"function"==typeof e?e(t):e.current=t}function Cj(e){return(Cj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sj(e){return null!==e&&"object"===Cj(e)&&Object.prototype.hasOwnProperty.call(e,"current")}function Nj(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<i.length;l++){var c=i[l];if(!s(c))return!1;var d=e[c],u=t[c];if(!1===(o=n?n.call(r,d,u,c):void 0)||void 0===o&&d!==u)return!1}return!0}function jj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ij(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oj=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ij(this,"hooks",kj({dragSource:function(e,t){n.clearDragSource(),n.dragSourceOptions=t||null,Sj(e)?n.dragSourceRef=e:n.dragSourceNode=e,n.reconnectDragSource()},dragPreview:function(e,t){n.clearDragPreview(),n.dragPreviewOptions=t||null,Sj(e)?n.dragPreviewRef=e:n.dragPreviewNode=e,n.reconnectDragPreview()}})),Ij(this,"handlerId",null),Ij(this,"dragSourceRef",null),Ij(this,"dragSourceNode",void 0),Ij(this,"dragSourceOptionsInternal",null),Ij(this,"dragSourceUnsubscribe",void 0),Ij(this,"dragPreviewRef",null),Ij(this,"dragPreviewNode",void 0),Ij(this,"dragPreviewOptionsInternal",null),Ij(this,"dragPreviewUnsubscribe",void 0),Ij(this,"lastConnectedHandlerId",null),Ij(this,"lastConnectedDragSource",null),Ij(this,"lastConnectedDragSourceOptions",null),Ij(this,"lastConnectedDragPreview",null),Ij(this,"lastConnectedDragPreviewOptions",null),Ij(this,"backend",void 0),this.backend=t}var t,n,r;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();t&&this.disconnectDragSource(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)):this.lastConnectedDragSource=e)}},{key:"reconnectDragPreview",value:function(){var e=this.dragPreview,t=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();t&&this.disconnectDragPreview(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=e,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,e,this.dragPreviewOptions)):this.lastConnectedDragPreview=e)}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!Nj(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!Nj(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}}])&&jj(t.prototype,n),r&&jj(t,r),e}();function Mj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tj=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Dj(this,"hooks",kj({dropTarget:function(e,t){n.clearDropTarget(),n.dropTargetOptions=t,Sj(e)?n.dropTargetRef=e:n.dropTargetNode=e,n.reconnect()}})),Dj(this,"handlerId",null),Dj(this,"dropTargetRef",null),Dj(this,"dropTargetNode",void 0),Dj(this,"dropTargetOptionsInternal",null),Dj(this,"unsubscribeDropTarget",void 0),Dj(this,"lastConnectedHandlerId",null),Dj(this,"lastConnectedDropTarget",null),Dj(this,"lastConnectedDropTargetOptions",null),Dj(this,"backend",void 0),this.backend=t}var t,n,r;return t=e,(n=[{key:"connectTarget",get:function(){return this.dropTarget}},{key:"reconnect",value:function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}},{key:"receiveHandlerId",value:function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!Nj(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}}])&&Mj(t.prototype,n),r&&Mj(t,r),e}();var Pj="undefined"!=typeof window?o.useLayoutEffect:o.useEffect;function Aj(e){return(Aj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zj=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Rj(this,"spec",void 0),Rj(this,"monitor",void 0),Rj(this,"connector",void 0),this.spec=t,this.monitor=n,this.connector=r}var t,n,r;return t=e,(n=[{key:"beginDrag",value:function(){var e,t=this.spec,n=this.monitor;return null!==(e="object"===Aj(t.item)?t.item:"function"==typeof t.item?t.item(n):{})&&void 0!==e?e:null}},{key:"canDrag",value:function(){var e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}},{key:"isDragging",value:function(e,t){var n=this.spec,r=this.monitor,o=n.isDragging;return o?o(r):t===e.getSourceId()}},{key:"endDrag",value:function(){var e=this.spec,t=this.monitor,n=this.connector,r=e.end;r&&r(t.getItem(),t),n.reconnect()}}])&&_j(t.prototype,n),r&&_j(t,r),e}();function Lj(){var e=o.useContext(RS).dragDropManager;return zS(null!=e,"Expected drag drop context"),e}function Bj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hj(e,t,n){var r=Lj(),i=function(e,t,n){var r=o.useMemo((function(){return new zj(e,t,n)}),[t,n]);return o.useEffect((function(){r.spec=e}),[e]),r}(e,t,n),a=function(e){return o.useMemo((function(){var t=e.type;return zS(null!=t,"spec.type must be defined"),t}),[e])}(e);Pj((function(){if(null!=a){var e=function(e,t,n){var r=n.getRegistry(),o=r.addSource(e,t);return[o,function(){return r.removeSource(o)}]}(a,i,r),o=Bj(e,2),s=o[0],l=o[1];return t.receiveHandlerId(s),n.receiveHandlerId(s),l}}),[r,t,n,i,a])}function Vj(e){return function(e){if(Array.isArray(e))return $j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return $j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wj(e,t){var n=Vj(t||[]);return null==t&&"function"!=typeof e&&n.push(e),o.useMemo((function(){return"function"==typeof e?e():e}),n)}function Uj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Yj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gj(e,t,n){var r=Uj(o.useState((function(){return t(e)})),2),i=r[0],a=r[1],s=o.useCallback((function(){var r=t(e);Ya(i,r)||(a(r),n&&n())}),[i,e,n]);return Pj(s),[i,s]}function qj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Kj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xj(e,t,n){return function(e,t,n){var r=qj(Gj(e,t,n),2),o=r[0],i=r[1];return Pj((function(){var t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(i,{handlerIds:[t]})}),[e,i]),o}(t,e||function(){return{}},(function(){return n.reconnect()}))}function Zj(e){return o.useMemo((function(){return e.hooks.dragSource()}),[e])}function Jj(e){return o.useMemo((function(){return e.hooks.dragPreview()}),[e])}function Qj(e,t){var n=Wj(e,t);zS(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");var r,i=(r=Lj(),o.useMemo((function(){return new mj(r)}),[r])),a=function(e,t){var n=Lj(),r=o.useMemo((function(){return new Oj(n.getBackend())}),[n]);return Pj((function(){return r.dragSourceOptions=e||null,r.reconnect(),function(){return r.disconnectDragSource()}}),[r,e]),Pj((function(){return r.dragPreviewOptions=t||null,r.reconnect(),function(){return r.disconnectDragPreview()}}),[r,t]),r}(n.options,n.previewOptions);return Hj(n,i,a),[Xj(n.collect,i,a),Zj(a),Jj(a)]}function eI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nI=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),tI(this,"spec",void 0),tI(this,"monitor",void 0),this.spec=t,this.monitor=n}var t,n,r;return t=e,(n=[{key:"canDrop",value:function(){var e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}},{key:"hover",value:function(){var e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}},{key:"drop",value:function(){var e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}}])&&eI(t.prototype,n),r&&eI(t,r),e}();function rI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return oI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iI(e,t,n){var r=Lj(),i=function(e,t){var n=o.useMemo((function(){return new nI(e,t)}),[t]);return o.useEffect((function(){n.spec=e}),[e]),n}(e,t),a=function(e){var t=e.accept;return o.useMemo((function(){return zS(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t]}),[t])}(e);Pj((function(){var e=function(e,t,n){var r=n.getRegistry(),o=r.addTarget(e,t);return[o,function(){return r.removeTarget(o)}]}(a,i,r),o=rI(e,2),s=o[0],l=o[1];return t.receiveHandlerId(s),n.receiveHandlerId(s),l}),[r,t,i,n,a.map((function(e){return e.toString()})).join("|")])}function aI(e){return o.useMemo((function(){return e.hooks.dropTarget()}),[e])}function sI(e,t){var n,r=Wj(e,t),i=(n=Lj(),o.useMemo((function(){return new bj(n)}),[n])),a=function(e){var t=Lj(),n=o.useMemo((function(){return new Tj(t.getBackend())}),[t]);return Pj((function(){return n.dropTargetOptions=e||null,n.reconnect(),function(){return n.disconnectDropTarget()}}),[e]),n}(r.options);return iI(r,i,a),[Xj(r.collect,i,a),aI(a)]}function lI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cI(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dI(e){var t=null;return function(){return null==t&&(t=e()),t}}function uI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fI=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),hI(this,"entered",[]),hI(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}var t,n,r;return t=e,(n=[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var o=[];return n.forEach((function(e){return o.push(e)})),o}(this.entered.filter((function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))})),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter((function(e){return e!==n}))),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}])&&uI(t.prototype,n),r&&uI(t,r),e}(),pI=dI((function(){return/firefox/i.test(navigator.userAgent)})),gI=dI((function(){return Boolean(window.safari)}));function mI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yI=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),vI(this,"xs",void 0),vI(this,"ys",void 0),vI(this,"c1s",void 0),vI(this,"c2s",void 0),vI(this,"c3s",void 0);for(var r=t.length,o=[],i=0;i<r;i++)o.push(i);o.sort((function(e,n){return t[e]<t[n]?-1:1}));for(var a,s,l=[],c=[],d=0;d<r-1;d++)a=t[d+1]-t[d],s=n[d+1]-n[d],l.push(a),c.push(s/a);for(var u=[c[0]],h=0;h<l.length-1;h++){var f=c[h],p=c[h+1];if(f*p<=0)u.push(0);else{a=l[h];var g=l[h+1],m=a+g;u.push(3*m/((m+g)/f+(m+a)/p))}}u.push(c[c.length-1]);for(var v,y=[],x=[],b=0;b<u.length-1;b++){v=c[b];var w=u[b],k=1/l[b],E=w+u[b+1]-v-v;y.push((v-w-E)*k),x.push(E*k*k)}this.xs=t,this.ys=n,this.c1s=u,this.c2s=y,this.c3s=x}var t,n,r;return t=e,(n=[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,o=this.c2s,i=this.c3s,a=t.length-1;if(e===t[a])return n[a];for(var s,l=0,c=i.length-1;l<=c;){var d=t[s=Math.floor(.5*(l+c))];if(d<e)l=s+1;else{if(!(d>e))return n[s];c=s-1}}var u=e-t[a=Math.max(0,c)],h=u*u;return n[a]+r[a]*u+o[a]*h+i[a]*u*h}}])&&mI(t.prototype,n),r&&mI(t,r),e}(),xI=1;function bI(e){var t=e.nodeType===xI?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function wI(e){return{x:e.clientX,y:e.clientY}}function kI(e,t,n,r,o){var i,a,s,l="IMG"===(i=t).nodeName&&(pI()||!(null!==(a=document.documentElement)&&void 0!==a&&a.contains(i))),c=bI(l?e:t),d={x:n.x-c.x,y:n.y-c.y},u=e.offsetWidth,h=e.offsetHeight,f=r.anchorX,p=r.anchorY,g=function(e,t,n,r){var o=e?t.width:n,i=e?t.height:r;return gI()&&e&&(i/=window.devicePixelRatio,o/=window.devicePixelRatio),{dragPreviewWidth:o,dragPreviewHeight:i}}(l,t,u,h),m=g.dragPreviewWidth,v=g.dragPreviewHeight,y=o.offsetX,x=o.offsetY,b=0===x||x;return{x:0===y||y?y:new yI([0,.5,1],[d.x,d.x/u*m,d.x+m-u]).interpolate(f),y:b?x:(s=new yI([0,.5,1],[d.y,d.y/h*v,d.y+v-h]).interpolate(p),gI()&&l&&(s+=(window.devicePixelRatio-1)*v),s)}}var EI="__NATIVE_FILE__",CI="__NATIVE_URL__",SI="__NATIVE_TEXT__",NI="__NATIVE_HTML__";const jI=Object.freeze(Object.defineProperty({__proto__:null,FILE:EI,HTML:NI,TEXT:SI,URL:CI},Symbol.toStringTag,{value:"Module"}));function II(e,t,n){var r=t.reduce((function(t,n){return t||e.getData(n)}),"");return null!=r?r:n}var OI;function MI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var DI=(MI(OI={},EI,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items},dataTransfer:function(e){return e}},matchesTypes:["Files"]}),MI(OI,NI,{exposeProperties:{html:function(e,t){return II(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Html","text/html"]}),MI(OI,CI,{exposeProperties:{urls:function(e,t){return II(e,t,"").split("\n")},dataTransfer:function(e){return e}},matchesTypes:["Url","text/uri-list"]}),MI(OI,SI,{exposeProperties:{text:function(e,t){return II(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Text","text/plain"]}),OI);function TI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var AI=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),PI(this,"item",void 0),PI(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}var t,n,r;return t=e,(n=[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach((function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})}))}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach((function(r){n[r]={value:t.config.exposeProperties[r](e,t.config.matchesTypes),configurable:!0,enumerable:!0}})),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}])&&TI(t.prototype,n),r&&TI(t,r),e}();function _I(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(DI).filter((function(e){return DI[e].matchesTypes.some((function(e){return t.indexOf(e)>-1}))}))[0]||null}function RI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var LI=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),zI(this,"ownerDocument",null),zI(this,"globalContext",void 0),zI(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=n}var t,n,r;return t=e,(n=[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}},{key:"document",get:function(){var e;return null!==(e=this.globalContext)&&void 0!==e&&e.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}}])&&RI(t.prototype,n),r&&RI(t,r),e}();function BI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function FI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BI(Object(n),!0).forEach((function(t){VI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $I,WI=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),VI(this,"options",void 0),VI(this,"actions",void 0),VI(this,"monitor",void 0),VI(this,"registry",void 0),VI(this,"enterLeaveCounter",void 0),VI(this,"sourcePreviewNodes",new Map),VI(this,"sourcePreviewNodeOptions",new Map),VI(this,"sourceNodes",new Map),VI(this,"sourceNodeOptions",new Map),VI(this,"dragStartSourceIds",null),VI(this,"dropTargetIds",[]),VI(this,"dragEnterTargetIds",[]),VI(this,"currentNativeSource",null),VI(this,"currentNativeHandle",null),VI(this,"currentDragSourceNode",null),VI(this,"altKeyPressed",!1),VI(this,"mouseMoveTimeoutTimer",null),VI(this,"asyncEndDragFrameId",null),VI(this,"dragOverTargetIds",null),VI(this,"lastClientOffset",null),VI(this,"hoverRafId",null),VI(this,"getSourceClientOffset",(function(e){var t=o.sourceNodes.get(e);return t&&bI(t)||null})),VI(this,"endDragNativeItem",(function(){o.isDraggingNativeItem()&&(o.actions.endDrag(),o.currentNativeHandle&&o.registry.removeSource(o.currentNativeHandle),o.currentNativeHandle=null,o.currentNativeSource=null)})),VI(this,"isNodeInDocument",(function(e){return Boolean(e&&o.document&&o.document.body&&o.document.body.contains(e))})),VI(this,"endDragIfSourceWasRemovedFromDOM",(function(){var e=o.currentDragSourceNode;null==e||o.isNodeInDocument(e)||o.clearCurrentDragSourceNode()&&o.monitor.isDragging()&&o.actions.endDrag()})),VI(this,"handleTopDragStartCapture",(function(){o.clearCurrentDragSourceNode(),o.dragStartSourceIds=[]})),VI(this,"handleTopDragStart",(function(e){if(!e.defaultPrevented){var t=o.dragStartSourceIds;o.dragStartSourceIds=null;var n=wI(e);o.monitor.isDragging()&&o.actions.endDrag(),o.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:o.getSourceClientOffset,clientOffset:n});var r=e.dataTransfer,i=_I(r);if(o.monitor.isDragging()){if(r&&"function"==typeof r.setDragImage){var a=o.monitor.getSourceId(),s=o.sourceNodes.get(a),l=o.sourcePreviewNodes.get(a)||s;if(l){var c=o.getCurrentSourcePreviewNodeOptions(),d=kI(s,l,n,{anchorX:c.anchorX,anchorY:c.anchorY},{offsetX:c.offsetX,offsetY:c.offsetY});r.setDragImage(l,d.x,d.y)}}try{null==r||r.setData("application/json",{})}catch(u){}o.setCurrentDragSourceNode(e.target),o.getCurrentSourcePreviewNodeOptions().captureDraggingState?o.actions.publishDragSource():setTimeout((function(){return o.actions.publishDragSource()}),0)}else if(i)o.beginDragNativeItem(i);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}})),VI(this,"handleTopDragEndCapture",(function(){o.clearCurrentDragSourceNode()&&o.monitor.isDragging()&&o.actions.endDrag()})),VI(this,"handleTopDragEnterCapture",(function(e){if(o.dragEnterTargetIds=[],o.enterLeaveCounter.enter(e.target)&&!o.monitor.isDragging()){var t=e.dataTransfer,n=_I(t);n&&o.beginDragNativeItem(n,t)}})),VI(this,"handleTopDragEnter",(function(e){var t=o.dragEnterTargetIds;(o.dragEnterTargetIds=[],o.monitor.isDragging())&&(o.altKeyPressed=e.altKey,t.length>0&&o.actions.hover(t,{clientOffset:wI(e)}),t.some((function(e){return o.monitor.canDropOnTarget(e)}))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=o.getCurrentDropEffect())))})),VI(this,"handleTopDragOverCapture",(function(){o.dragOverTargetIds=[]})),VI(this,"handleTopDragOver",(function(e){var t=o.dragOverTargetIds;if(o.dragOverTargetIds=[],!o.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));o.altKeyPressed=e.altKey,o.lastClientOffset=wI(e),null===o.hoverRafId&&"undefined"!=typeof requestAnimationFrame&&(o.hoverRafId=requestAnimationFrame((function(){o.monitor.isDragging()&&o.actions.hover(t||[],{clientOffset:o.lastClientOffset}),o.hoverRafId=null}))),(t||[]).some((function(e){return o.monitor.canDropOnTarget(e)}))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=o.getCurrentDropEffect())):o.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))})),VI(this,"handleTopDragLeaveCapture",(function(e){o.isDraggingNativeItem()&&e.preventDefault(),o.enterLeaveCounter.leave(e.target)&&o.isDraggingNativeItem()&&setTimeout((function(){return o.endDragNativeItem()}),0)})),VI(this,"handleTopDropCapture",(function(e){var t;(o.dropTargetIds=[],o.isDraggingNativeItem())?(e.preventDefault(),null===(t=o.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):_I(e.dataTransfer)&&e.preventDefault();o.enterLeaveCounter.reset()})),VI(this,"handleTopDrop",(function(e){var t=o.dropTargetIds;o.dropTargetIds=[],o.actions.hover(t,{clientOffset:wI(e)}),o.actions.drop({dropEffect:o.getCurrentDropEffect()}),o.isDraggingNativeItem()?o.endDragNativeItem():o.monitor.isDragging()&&o.actions.endDrag()})),VI(this,"handleSelectStart",(function(e){var t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))})),this.options=new LI(n,r),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new fI(this.isNodeInDocument)}var t,n,r;return t=e,(n=[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}},{key:"teardown",value:function(){var e,t=this.rootElement;void 0!==t&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(e=this.window)||void 0===e||e.cancelAnimationFrame(this.asyncEndDragFrameId)))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var o=function(t){return r.handleDragStart(t,e)},i=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",o),t.addEventListener("selectstart",i),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",o),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},o=function(t){return n.handleDragOver(t,e)},i=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",o),t.addEventListener("drop",i),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",o),t.removeEventListener("drop",i)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return FI({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return FI({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(jI).some((function(t){return jI[t]===e}))}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=new AI(DI[e]);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout((function(){var e;return null===(e=t.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){var e;return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.rootElement&&(null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}}])&&HI(t.prototype,n),r&&HI(t,r),e}();var UI=function(e,t,n){return new WI(e,t,n)};function YI(e){const t=pC(),n=t.selectedIds,[r,i,a]=Qj((()=>({canDrag:()=>e.isDraggable,type:"NODE",item:()=>{const r=t.isSelected(e.id)?Array.from(n):[e.id];return t.dispatch(lS.dragStart(e.id,r)),{id:e.id}},end:()=>{t.hideCursor();let{parentId:e,index:n,dragIds:r}=t.state.dnd;t.canDrop()&&(_C(t.props.onMove,{dragIds:r,parentId:e===ZC?null:e,index:null===n?0:n,dragNodes:t.dragNodes,parentNode:t.get(e)}),t.open(e)),t.dispatch(lS.dragEnd())}})),[n,e]);return o.useEffect((()=>{a(($I||(($I=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),$I))}),[a]),i}function GI(e,t){return{parentId:e||null,index:t}}function qI(e,t){return{type:"line",index:e,level:t}}function KI(e,t){var n;let r=e;for(;r.parent&&r.level>t;)r=r.parent;return{parentId:(null===(n=r.parent)||void 0===n?void 0:n.id)||null,index:CC(r)+1}}function XI(e){var t;const n=function(e,t){const n=e.getBoundingClientRect(),r=t.x-Math.round(n.x),o=t.y-Math.round(n.y),i=n.height,a=o<i/2,s=!a,l=i/4,c=o>l&&o<i-l;return{x:r,inTopHalf:a,inBottomHalf:s,inMiddle:c,atTop:!c&&a,atBottom:!c&&s}}(e.element,e.offset),r=e.indent,o=Math.round(Math.max(0,n.x-r)/r),{node:i,nextNode:a,prevNode:s}=e,[l,c]=function(e,t,n,r){return e?e.isInternal?r.atTop?[t,e]:r.inMiddle?[e,e]:[e,n]:r.inTopHalf?[t,e]:[e,n]:[t,null]}(i,s,a,n);if(i&&i.isInternal&&n.inMiddle)return{drop:GI(i.id,null),cursor:(d=i.id,{type:"highlight",id:d})};var d;if(!l)return{drop:GI(null===(t=null==c?void 0:c.parent)||void 0===t?void 0:t.id,0),cursor:qI(0,0)};if(bC(l)){const e=xC(o,(null==c?void 0:c.level)||0,l.level);return{drop:KI(l,e),cursor:qI(l.rowIndex+1,e)}}if(wC(l)){const e=xC(o,(null==c?void 0:c.level)||0,l.level);return{drop:KI(l,e),cursor:qI(l.rowIndex+1,e)}}if(kC(l)){const e=xC(o,0,l.level+1);return e>l.level?{drop:GI(l.id,0),cursor:qI(l.rowIndex+1,e)}:{drop:KI(l,e),cursor:qI(l.rowIndex+1,e)}}return{drop:GI(null==l?void 0:l.id,0),cursor:qI(l.rowIndex+1,l.level+1)}}const ZI=s.memo((function({index:e,style:t}){yC(),function(){const e=o.useContext(gC);if(null===e)throw new Error("Provide a NodesContext")}();const n=pC(),r=function(e){const t=pC(),n=t.at(e);if(!n)throw new Error(`Could not find node for index: ${e}`);return o.useMemo((()=>{const r=n.clone();return t.visibleNodes[e]=r,r}),[...Object.values(n.state),n])}(e),i=o.useRef(null),a=YI(r),s=function(e,t){const n=pC(),[r,o]=sI((()=>({accept:"NODE",canDrop:()=>n.canDrop(),hover:(r,o)=>{const i=o.getClientOffset();if(!e.current||!i)return;const{cursor:a,drop:s}=XI({element:e.current,offset:i,indent:n.indent,node:t,prevNode:t.prev,nextNode:t.next});s&&n.dispatch(lS.hovering(s.parentId,s.index)),o.canDrop()?a&&n.showCursor(a):n.hideCursor()},drop:(e,t)=>{if(!t.canDrop())return null}})),[t,e.current,n.props]);return o}(i,r),l=o.useCallback((e=>{i.current=e,s(e)}),[s]),c=n.indent*r.level,d=o.useMemo((()=>({paddingLeft:c})),[c]),u=o.useMemo((()=>{var e,r;return Object.assign(Object.assign({},t),{top:parseFloat(t.top)+(null!==(r=null!==(e=n.props.padding)&&void 0!==e?e:n.props.paddingTop)&&void 0!==r?r:0)})}),[t,n.props.padding,n.props.paddingTop]),h={role:"treeitem","aria-level":r.level+1,"aria-selected":r.isSelected,style:u,tabIndex:-1,className:n.props.rowClassName};o.useEffect((()=>{var e;!r.isEditing&&r.isFocused&&(null===(e=i.current)||void 0===e||e.focus({preventScroll:!0}))}),[r.isEditing,r.isFocused,i.current]);const f=n.renderNode,p=n.renderRow;return x.jsx(p,{node:r,innerRef:l,attrs:h,children:x.jsx(f,{node:r,tree:n,style:d,dragHandle:a})})}));let JI="",QI=null;function eO(){yC();const e=pC();return x.jsx("div",{role:"tree",style:{height:e.height,width:e.width,minHeight:0,minWidth:0},onContextMenu:e.props.onContextMenu,onClick:e.props.onClick,tabIndex:0,onFocus:t=>{t.currentTarget.contains(t.relatedTarget)||e.onFocus()},onBlur:t=>{t.currentTarget.contains(t.relatedTarget)||e.onBlur()},onKeyDown:t=>{var n;if(e.isEditing)return;if("Backspace"===t.key){if(!e.props.onDelete)return;const t=Array.from(e.selectedIds);if(t.length>1){let n=e.mostRecentNode;for(;n&&n.isSelected;)n=n.nextSibling;n||(n=e.lastNode),e.focus(n,{scroll:!1}),e.delete(Array.from(t))}else{const t=e.focusedNode;if(t){const n=t.nextSibling,r=t.parent;e.focus(n||r,{scroll:!1}),e.delete(t)}}return}if("Tab"===t.key&&!t.shiftKey)return t.preventDefault(),void jC(t.currentTarget);if("Tab"===t.key&&t.shiftKey)return t.preventDefault(),void IC(t.currentTarget);if("ArrowDown"===t.key){t.preventDefault();const n=e.nextNode;if(t.metaKey)return e.select(e.focusedNode),void e.activate(e.focusedNode);if(!t.shiftKey||e.props.disableMultiSelection)return void e.focus(n);{if(!n)return;const t=e.focusedNode;return void(t?t.isSelected?e.selectContiguous(n):e.selectMulti(n):e.focus(e.firstNode))}}if("ArrowUp"===t.key){t.preventDefault();const n=e.prevNode;if(!t.shiftKey||e.props.disableMultiSelection)return void e.focus(n);{if(!n)return;const t=e.focusedNode;return void(t?t.isSelected?e.selectContiguous(n):e.selectMulti(n):e.focus(e.lastNode))}}if("ArrowRight"===t.key){const t=e.focusedNode;if(!t)return;return void(t.isInternal&&t.isOpen?e.focus(e.nextNode):t.isInternal&&e.open(t.id))}if("ArrowLeft"===t.key){const t=e.focusedNode;if(!t||t.isRoot)return;return void(t.isInternal&&t.isOpen?e.close(t.id):(null===(n=t.parent)||void 0===n?void 0:n.isRoot)||e.focus(t.parent))}if("a"===t.key&&t.metaKey&&!e.props.disableMultiSelection)return t.preventDefault(),void e.selectAll();if("a"===t.key&&!t.metaKey&&e.props.onCreate)return void e.createLeaf();if("A"===t.key&&!t.metaKey){if(!e.props.onCreate)return;return void e.createInternal()}if("Home"===t.key)return t.preventDefault(),void e.focus(e.firstNode);if("End"===t.key)return t.preventDefault(),void e.focus(e.lastNode);if("Enter"===t.key){const t=e.focusedNode;if(!t)return;if(!t.isEditable||!e.props.onRename)return;return void setTimeout((()=>{t&&e.edit(t)}))}if(" "===t.key){t.preventDefault();const n=e.focusedNode;if(!n)return;return void(n.isLeaf?(n.select(),n.activate()):n.toggle())}if("*"===t.key){const t=e.focusedNode;if(!t)return;return void e.openSiblings(t)}if("PageUp"===t.key)return t.preventDefault(),void e.pageUp();"PageDown"===t.key&&(t.preventDefault(),e.pageDown()),clearTimeout(QI),JI+=t.key,QI=setTimeout((()=>{JI=""}),600);const r=e.visibleNodes.find((e=>{const t=e.data.name;return"string"==typeof t&&t.toLowerCase().startsWith(JI)}));r&&e.focus(r.id)},children:x.jsx(OS,{className:e.props.className,outerRef:e.listEl,itemCount:e.visibleNodes.length,height:e.height,width:e.width,itemSize:e.rowHeight,overscanCount:e.overscanCount,itemKey:t=>{var n;return(null===(n=e.visibleNodes[t])||void 0===n?void 0:n.id)||t},outerElementType:DS,innerElementType:PS,onScroll:e.props.onScroll,onItemsRendered:e.onItemsRendered.bind(e),ref:e.list,children:ZI})})}function tO(e){return e.isFiltered?function(e,t){const n={},r=[];function o(e){if(!e.isRoot&&t(e)){n[e.id]=!0;let t=e.parent;for(;t;)n[t.id]=!0,t=t.parent}if(e.children)for(let t of e.children)o(t)}function i(e){var t;e.level>=0&&n[e.id]&&r.push(e),e.isOpen&&(null===(t=e.children)||void 0===t||t.forEach(i))}return o(e),i(e),r.forEach(nO),r}(e.root,e.isMatch.bind(e)):function(e){const t=[];function n(e){var r;e.level>=0&&t.push(e),e.isOpen&&(null===(r=e.children)||void 0===r||r.forEach(n))}return n(e),t.forEach(nO),t}(e.root)}function nO(e,t){e.rowIndex=t}const rO=e=>e.reduce(((e,t,n)=>(e[t.id]=n,e)),{});var oO=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function s(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const{safeRun:iO,identify:aO,identifyNull:sO}=BC;class lO{constructor(e,t,n,r){this.store=e,this.props=t,this.list=n,this.listEl=r,this.visibleStartIndex=0,this.visibleStopIndex=0,this.root=JC(this),this.visibleNodes=tO(this),this.idToIndex=rO(this.visibleNodes)}update(e){this.props=e,this.root=JC(this),this.visibleNodes=tO(this),this.idToIndex=rO(this.visibleNodes)}dispatch(e){return this.store.dispatch(e)}get state(){return this.store.getState()}get openState(){return this.state.nodes.open.unfiltered}get width(){var e;return null!==(e=this.props.width)&&void 0!==e?e:300}get height(){var e;return null!==(e=this.props.height)&&void 0!==e?e:500}get indent(){var e;return null!==(e=this.props.indent)&&void 0!==e?e:24}get rowHeight(){var e;return null!==(e=this.props.rowHeight)&&void 0!==e?e:24}get overscanCount(){var e;return null!==(e=this.props.overscanCount)&&void 0!==e?e:1}get searchTerm(){return(this.props.searchTerm||"").trim()}get matchFn(){var e;const t=null!==(e=this.props.searchMatch)&&void 0!==e?e:(e,t)=>JSON.stringify(Object.values(e.data)).toLocaleLowerCase().includes(t.toLocaleLowerCase());return e=>t(e,this.searchTerm)}accessChildren(e){var t;return null!==(t=TC(e,this.props.childrenAccessor||"children"))&&void 0!==t?t:null}accessId(e){const t=TC(e,this.props.idAccessor||"id");if(!t)throw new Error("Data must contain an 'id' property or props.idAccessor must return a string");return t}get firstNode(){var e;return null!==(e=this.visibleNodes[0])&&void 0!==e?e:null}get lastNode(){var e;return null!==(e=this.visibleNodes[this.visibleNodes.length-1])&&void 0!==e?e:null}get focusedNode(){var e;return null!==(e=this.get(this.state.nodes.focus.id))&&void 0!==e?e:null}get mostRecentNode(){var e;return null!==(e=this.get(this.state.nodes.selection.mostRecent))&&void 0!==e?e:null}get nextNode(){const e=this.indexOf(this.focusedNode);return null===e?null:this.at(e+1)}get prevNode(){const e=this.indexOf(this.focusedNode);return null===e?null:this.at(e-1)}get(e){return e&&e in this.idToIndex&&this.visibleNodes[this.idToIndex[e]]||null}at(e){return this.visibleNodes[e]||null}nodesBetween(e,t){var n;if(null===e||null===t)return[];const r=null!==(n=this.indexOf(e))&&void 0!==n?n:0,o=this.indexOf(t);if(null===o)return[];const i=Math.min(r,o),a=Math.max(r,o);return this.visibleNodes.slice(i,a+1)}indexOf(e){const t=PC(e);return t?this.idToIndex[t]:null}get editingId(){return this.state.nodes.edit.id}createInternal(){return this.create({type:"internal"})}createLeaf(){return this.create({type:"leaf"})}create(e={}){var t,n;return oO(this,void 0,void 0,(function*(){const r=void 0===e.parentId?LC(this):e.parentId,o=null!==(t=e.index)&&void 0!==t?t:zC(this),i=null!==(n=e.type)&&void 0!==n?n:"leaf",a=yield iO(this.props.onCreate,{type:i,parentId:r,index:o,parentNode:this.get(r)});a&&(this.focus(a),setTimeout((()=>{this.edit(a).then((()=>{this.select(a),this.activate(a)}))})))}))}delete(e){return oO(this,void 0,void 0,(function*(){if(!e)return;const t=(Array.isArray(e)?e:[e]).map(aO),n=t.map((e=>this.get(e))).filter((e=>!!e));yield iO(this.props.onDelete,{nodes:n,ids:t})}))}edit(e){const t=aO(e);return this.resolveEdit({cancelled:!0}),this.scrollTo(t),this.dispatch(qC(t)),new Promise((e=>{lO.editPromise=e}))}submit(e,t){return oO(this,void 0,void 0,(function*(){if(!e)return;const n=aO(e);yield iO(this.props.onRename,{id:n,name:t,node:this.get(n)}),this.dispatch(qC(null)),this.resolveEdit({cancelled:!1,value:t}),setTimeout((()=>this.onFocus()))}))}reset(){this.dispatch(qC(null)),this.resolveEdit({cancelled:!0}),setTimeout((()=>this.onFocus()))}activate(e){const t=this.get(sO(e));t&&iO(this.props.onActivate,t)}resolveEdit(e){const t=lO.editPromise;t&&t(e),lO.editPromise=null}get selectedIds(){return this.state.nodes.selection.ids}get selectedNodes(){let e=[];for(let t of Array.from(this.selectedIds)){const n=this.get(t);n&&e.push(n)}return e}focus(e,t={}){e&&(this.props.selectionFollowsFocus?this.select(e):(this.dispatch(KC(aO(e))),!1!==t.scroll&&this.scrollTo(e),this.focusedNode&&iO(this.props.onFocus,this.focusedNode)))}pageUp(){var e,t;const n=this.visibleStartIndex,r=this.visibleStopIndex-n;let o=null!==(t=null===(e=this.focusedNode)||void 0===e?void 0:e.rowIndex)&&void 0!==t?t:0;o=o>n?n:Math.max(n-r,0),this.focus(this.at(o))}pageDown(){var e,t;const n=this.visibleStartIndex,r=this.visibleStopIndex,o=r-n;let i=null!==(t=null===(e=this.focusedNode)||void 0===e?void 0:e.rowIndex)&&void 0!==t?t:0;i=i<r?r:Math.min(i+o,this.visibleNodes.length-1),this.focus(this.at(i))}select(e,t={}){if(!e)return;const n=!1!==t.focus,r=aO(e);n&&this.dispatch(KC(r)),this.dispatch(nS(r)),this.dispatch(sS(r)),this.dispatch(aS(r)),this.scrollTo(r,t.align),this.focusedNode&&n&&iO(this.props.onFocus,this.focusedNode),iO(this.props.onSelect,this.selectedNodes)}deselect(e){if(!e)return;const t=aO(e);this.dispatch(oS(t))}selectMulti(e){const t=this.get(sO(e));t&&(this.dispatch(KC(t.id)),this.dispatch(rS(t.id)),this.dispatch(sS(t.id)),this.dispatch(aS(t.id)),this.scrollTo(t),this.focusedNode&&iO(this.props.onFocus,this.focusedNode),iO(this.props.onSelect,this.selectedNodes))}selectContiguous(e){if(!e)return;const t=aO(e),{anchor:n,mostRecent:r}=this.state.nodes.selection;this.dispatch(KC(t)),this.dispatch(oS(this.nodesBetween(n,r))),this.dispatch(rS(this.nodesBetween(n,sO(t)))),this.dispatch(aS(t)),this.scrollTo(t),this.focusedNode&&iO(this.props.onFocus,this.focusedNode),iO(this.props.onSelect,this.selectedNodes)}deselectAll(){this.setSelection({ids:[],anchor:null,mostRecent:null}),iO(this.props.onSelect,this.selectedNodes)}selectAll(){var e;this.setSelection({ids:Object.keys(this.idToIndex),anchor:this.firstNode,mostRecent:this.lastNode}),this.dispatch(KC(null===(e=this.lastNode)||void 0===e?void 0:e.id)),this.focusedNode&&iO(this.props.onFocus,this.focusedNode),iO(this.props.onSelect,this.selectedNodes)}setSelection(e){var t;const n=new Set(null===(t=e.ids)||void 0===t?void 0:t.map(aO)),r=sO(e.anchor),o=sO(e.mostRecent);this.dispatch(iS({ids:n,anchor:r,mostRecent:o})),iO(this.props.onSelect,this.selectedNodes)}get cursorParentId(){const{cursor:e}=this.state.dnd;return"highlight"===e.type?e.id:null}get cursorOverFolder(){return"highlight"===this.state.dnd.cursor.type}get dragNodes(){return this.state.dnd.dragIds.map((e=>this.get(e))).filter((e=>!!e))}get dragNode(){return this.get(this.state.nodes.drag.id)}get dragDestinationParent(){return this.get(this.state.nodes.drag.destinationParentId)}get dragDestinationIndex(){return this.state.nodes.drag.destinationIndex}canDrop(){var e;if(this.isFiltered)return!1;const t=null!==(e=this.get(this.state.dnd.parentId))&&void 0!==e?e:this.root,n=this.dragNodes,r=this.props.disableDrop;for(const o of n){if(!o)return!1;if(!t)return!1;if(o.isInternal&&EC(t,o))return!1}return"function"==typeof r?!r({parentNode:t,dragNodes:this.dragNodes,index:this.state.dnd.index||0}):"string"==typeof r?!t.data[r]:"boolean"!=typeof r||!r}hideCursor(){this.dispatch(lS.cursor({type:"none"}))}showCursor(e){this.dispatch(lS.cursor(e))}open(e){const t=sO(e);t&&(this.isOpen(t)||(this.dispatch(QC.open(t,this.isFiltered)),iO(this.props.onToggle,t)))}close(e){const t=sO(e);t&&this.isOpen(t)&&(this.dispatch(QC.close(t,this.isFiltered)),iO(this.props.onToggle,t))}toggle(e){const t=sO(e);if(t)return this.isOpen(t)?this.close(t):this.open(t)}openParents(e){const t=sO(e);if(!t)return;const n=SC(this.root,t);let r=null==n?void 0:n.parent;for(;r;)this.open(r.id),r=r.parent}openSiblings(e){const t=e.parent;if(t){if(t.children){const n=e.isOpen;for(let e of t.children)e.isInternal&&(n?this.close(e.id):this.open(e.id));this.scrollTo(this.focusedNode)}}else this.toggle(e.id)}openAll(){NC(this.root,(e=>{e.isInternal&&e.open()}))}closeAll(){NC(this.root,(e=>{e.isInternal&&e.close()}))}scrollTo(e,t="smart"){if(!e)return;const n=aO(e);return this.openParents(n),RC((()=>n in this.idToIndex)).then((()=>{var e;const r=this.idToIndex[n];void 0!==r&&(null===(e=this.list.current)||void 0===e||e.scrollToItem(r,t))})).catch((()=>{}))}get isEditing(){return null!==this.state.nodes.edit.id}get isFiltered(){var e;return!!(null===(e=this.props.searchTerm)||void 0===e?void 0:e.trim())}get hasFocus(){return this.state.nodes.focus.treeFocused}get hasNoSelection(){return 0===this.state.nodes.selection.ids.size}get hasOneSelection(){return 1===this.state.nodes.selection.ids.size}get hasMultipleSelections(){return this.state.nodes.selection.ids.size>1}isSelected(e){return!!e&&this.state.nodes.selection.ids.has(e)}isOpen(e){var t,n,r;if(!e)return!1;if(e===ZC)return!0;const o=null===(t=this.props.openByDefault)||void 0===t||t;return this.isFiltered?null===(n=this.state.nodes.open.filtered[e])||void 0===n||n:null!==(r=this.state.nodes.open.unfiltered[e])&&void 0!==r?r:o}isEditable(e){var t;return null===(t=!TC(e,this.props.disableEdit||(()=>!1)))||void 0===t||t}isDraggable(e){var t;return null===(t=!TC(e,this.props.disableDrag||(()=>!1)))||void 0===t||t}isDragging(e){const t=sO(e);return!!t&&this.state.nodes.drag.id===t}isFocused(e){return this.hasFocus&&this.state.nodes.focus.id===e}isMatch(e){return this.matchFn(e)}willReceiveDrop(e){const t=sO(e);if(!t)return!1;const{destinationParentId:n,destinationIndex:r}=this.state.nodes.drag;return t===n&&null===r}onFocus(){const e=this.focusedNode||this.firstNode;e&&this.dispatch(KC(e.id))}onBlur(){this.dispatch({type:"TREE_BLUR"})}onItemsRendered(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleStopIndex=e.visibleStopIndex}get renderContainer(){return this.props.renderContainer||eO}get renderRow(){return this.props.renderRow||WC}get renderNode(){return this.props.children||UC}get renderDragPreview(){return this.props.renderDragPreview||hS}get renderCursor(){return this.props.renderCursor||$C}}function cO(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var dO=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),uO=()=>Math.random().toString(36).substring(7).split("").join("."),hO={INIT:`@@redux/INIT${uO()}`,REPLACE:`@@redux/REPLACE${uO()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${uO()}`};function fO(e,t,n){if("function"!=typeof e)throw new Error(cO(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(cO(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(cO(1));return n(fO)(e,t)}let r=e,o=t,i=new Map,a=i,s=0,l=!1;function c(){a===i&&(a=new Map,i.forEach(((e,t)=>{a.set(t,e)})))}function d(){if(l)throw new Error(cO(3));return o}function u(e){if("function"!=typeof e)throw new Error(cO(4));if(l)throw new Error(cO(5));let t=!0;c();const n=s++;return a.set(n,e),function(){if(t){if(l)throw new Error(cO(6));t=!1,c(),a.delete(n),i=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}(e))throw new Error(cO(7));if(void 0===e.type)throw new Error(cO(8));if("string"!=typeof e.type)throw new Error(cO(17));if(l)throw new Error(cO(9));try{l=!0,o=r(o,e)}finally{l=!1}return(i=a).forEach((e=>{e()})),e}h({type:hO.INIT});return{dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error(cO(10));r=e,h({type:hO.REPLACE})},[dO]:function(){const e=u;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(cO(11));function n(){const e=t;e.next&&e.next(d())}n();return{unsubscribe:e(n)}},[dO](){return this}}}}}function pO(e){const t=Object.keys(e),n={};for(let a=0;a<t.length;a++){const r=t[a];"function"==typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let o;try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if(void 0===n(void 0,{type:hO.INIT}))throw new Error(cO(12));if(void 0===n(void 0,{type:hO.PROBE_UNKNOWN_ACTION()}))throw new Error(cO(13))}))}(n)}catch(i){o=i}return function(e={},t){if(o)throw o;let i=!1;const a={};for(let o=0;o<r.length;o++){const s=r[o],l=n[s],c=e[s],d=l(c,t);if(void 0===d)throw t&&t.type,new Error(cO(14));a[s]=d,i=i||d!==c}return i=i||r.length!==Object.keys(e).length,i?a:e}}const gO=pO({nodes:pO({focus:function(e={id:null,treeFocused:!1},t){return"FOCUS"===t.type?Object.assign(Object.assign({},e),{id:t.id,treeFocused:!0}):"TREE_BLUR"===t.type?Object.assign(Object.assign({},e),{treeFocused:!1}):e},edit:function(e={id:null},t){return"EDIT"===t.type?Object.assign(Object.assign({},e),{id:t.id}):e},open:function(e={filtered:{},unfiltered:{}},t){return t.type.startsWith("VISIBILITY")?t.filtered?Object.assign(Object.assign({},e),{filtered:eS(e.filtered,t)}):Object.assign(Object.assign({},e),{unfiltered:eS(e.unfiltered,t)}):e},selection:function(e=tS().nodes.selection,t){const n=e.ids;switch(t.type){case"SELECTION_CLEAR":return Object.assign(Object.assign({},e),{ids:new Set});case"SELECTION_ONLY":return Object.assign(Object.assign({},e),{ids:new Set([t.id])});case"SELECTION_ADD":return 0===t.ids.length?e:(t.ids.forEach((e=>n.add(e))),Object.assign(Object.assign({},e),{ids:new Set(n)}));case"SELECTION_REMOVE":return 0===t.ids.length?e:(t.ids.forEach((e=>n.delete(e))),Object.assign(Object.assign({},e),{ids:new Set(n)}));case"SELECTION_SET":return Object.assign(Object.assign({},e),{ids:t.ids,mostRecent:t.mostRecent,anchor:t.anchor});case"SELECTION_MOST_RECENT":return Object.assign(Object.assign({},e),{mostRecent:t.id});case"SELECTION_ANCHOR":return Object.assign(Object.assign({},e),{anchor:t.id});default:return e}},drag:function(e=tS().nodes.drag,t){switch(t.type){case"DND_DRAG_START":return Object.assign(Object.assign({},e),{id:t.id,selectedIds:t.dragIds});case"DND_DRAG_END":return Object.assign(Object.assign({},e),{id:null,destinationParentId:null,destinationIndex:null,selectedIds:[]});case"DND_HOVERING":return t.parentId!==e.destinationParentId||t.index!=e.destinationIndex?Object.assign(Object.assign({},e),{destinationParentId:t.parentId,destinationIndex:t.index}):e;default:return e}}}),dnd:function(e=tS().dnd,t){switch(t.type){case"DND_CURSOR":return Object.assign(Object.assign({},e),{cursor:t.cursor});case"DND_DRAG_START":return Object.assign(Object.assign({},e),{dragId:t.id,dragIds:t.dragIds});case"DND_DRAG_END":return tS().dnd;case"DND_HOVERING":return Object.assign(Object.assign({},e),{parentId:t.parentId,index:t.index});default:return e}}}),mO=tS();function vO({treeProps:e,imperativeHandle:t,children:n}){const r=o.useRef(null),i=o.useRef(null),a=o.useRef(fO(gO,tS(e))),s=Fr.useSyncExternalStore(a.current.subscribe,a.current.getState,(()=>mO)),l=o.useMemo((()=>new lO(a.current,e,r,i)),[]),c=o.useRef(0);return o.useMemo((()=>{c.current+=1,l.update(e)}),[...Object.values(e),s.nodes.open]),o.useImperativeHandle(t,(()=>l)),o.useEffect((()=>{l.props.selection?l.select(l.props.selection,{focus:!1}):l.deselectAll()}),[l.props.selection]),o.useEffect((()=>{l.props.searchTerm||a.current.dispatch(QC.clear(!0))}),[l.props.searchTerm]),x.jsx(fC.Provider,{value:l,children:x.jsx(vC.Provider,{value:c.current,children:x.jsx(gC.Provider,{value:s.nodes,children:x.jsx(mC.Provider,{value:s.dnd,children:x.jsx(dj,Object.assign({backend:UI,options:{rootElement:l.props.dndRootElement||void 0}},e.dndManager&&{manager:e.dndManager},{children:n}))})})})})}function yO(e){return function(){const e=pC(),[,t]=sI((()=>({accept:"NODE",canDrop:(t,n)=>!!n.isOver({shallow:!0})&&e.canDrop(),hover:(t,n)=>{if(!n.isOver({shallow:!0}))return;const r=n.getClientOffset();if(!e.listEl.current||!r)return;const{cursor:o,drop:i}=XI({element:e.listEl.current,offset:r,indent:e.indent,node:null,prevNode:e.visibleNodes[e.visibleNodes.length-1],nextNode:null});i&&e.dispatch(lS.hovering(i.parentId,i.index)),n.canDrop()?o&&e.showCursor(o):e.hideCursor()}})),[e]);t(e.listEl)}(),e.children}function xO(){const e=pC().props.renderContainer||eO;return x.jsx(x.Fragment,{children:x.jsx(e,{})})}function bO(){const e=pC(),{offset:t,mouse:n,item:r,isDragging:i}=(a=e=>({offset:e.getSourceClientOffset(),mouse:e.getClientOffset(),item:e.getItem(),isDragging:e.isDragging()}),s=Lj().getMonitor(),l=lI(Gj(s,a),2),c=l[0],d=l[1],o.useEffect((function(){return s.subscribeToOffsetChange(d)})),o.useEffect((function(){return s.subscribeToStateChange(d)})),c);var a,s,l,c,d;const u=e.props.renderDragPreview||hS;return x.jsx(u,{offset:t,mouse:n,id:(null==r?void 0:r.id)||null,dragIds:(null==r?void 0:r.dragIds)||[],isDragging:i})}class wO{constructor(e){this.root=function(e){const t=new EO({id:"ROOT"},null);return t.children=e.map((e=>kO(e,t))),t}(e)}get data(){var e,t;return null!==(t=null===(e=this.root.children)||void 0===e?void 0:e.map((e=>e.data)))&&void 0!==t?t:[]}create(e){const t=e.parentId?this.find(e.parentId):this.root;if(!t)return null;t.addChild(e.data,e.index)}move(e){const t=this.find(e.id),n=e.parentId?this.find(e.parentId):this.root;t&&n&&(n.addChild(t.data,e.index),t.drop())}update(e){const t=this.find(e.id);t&&t.update(e.changes)}drop(e){const t=this.find(e.id);t&&t.drop()}find(e,t=this.root){if(!t)return null;if(t.id===e)return t;if(t.children){for(let n of t.children){const t=this.find(e,n);if(t)return t}return null}return null}}function kO(e,t){const n=new EO(e,t);return e.children&&(n.children=e.children.map((e=>kO(e,n)))),n}class EO{constructor(e,t){this.data=e,this.parent=t,this.id=e.id}hasParent(){return!!this.parent}get childIndex(){return this.hasParent()?this.parent.children.indexOf(this):-1}addChild(e,t){var n,r;const o=kO(e,this);this.children=null!==(n=this.children)&&void 0!==n?n:[],this.children.splice(t,0,o),this.data.children=null!==(r=this.data.children)&&void 0!==r?r:[],this.data.children.splice(t,0,e)}removeChild(e){var t,n;null===(t=this.children)||void 0===t||t.splice(e,1),null===(n=this.data.children)||void 0===n||n.splice(e,1)}update(e){if(this.hasParent()){const t=this.childIndex;this.parent.addChild(Object.assign(Object.assign({},this.data),e),t),this.drop()}}drop(){this.hasParent()&&this.parent.removeChild(this.childIndex)}}let CO=0;function SO(e){if(e.initialData&&e.data)throw new Error("React Arborist Tree => Provide either a data or initialData prop, but not both.");if(e.initialData&&(e.onCreate||e.onDelete||e.onMove||e.onRename))throw new Error("React Arborist Tree => You passed the initialData prop along with a data handler.\nUse the data prop if you want to provide your own handlers.");if(e.initialData){const[t,n]=function(e){const[t,n]=o.useState(e),r=o.useMemo((()=>new wO(t)),[t]);return[t,{onMove:e=>{for(const t of e.dragIds)r.move({id:t,parentId:e.parentId,index:e.index});n(r.data)},onRename:({name:e,id:t})=>{r.update({id:t,changes:{name:e}}),n(r.data)},onCreate:({parentId:e,index:t,type:o})=>{const i={id:"simple-tree-id-"+CO++,name:""};return"internal"===o&&(i.children=[]),r.create({parentId:e,index:t,data:i}),n(r.data),i},onDelete:e=>{e.ids.forEach((e=>r.drop({id:e}))),n(r.data)}}]}(e.initialData);return Object.assign(Object.assign(Object.assign({},e),n),{data:t})}return e}const NO=o.forwardRef((function(e,t){const n=SO(e);return x.jsxs(vO,{treeProps:n,imperativeHandle:t,children:[x.jsx(yO,{children:x.jsx(xO,{})}),x.jsx(bO,{})]})})),jO=new Map,IO=({file:e})=>{const{theme:t}=be(),[n,r]=o.useState(""),{data:i,loading:a,error:s,setData:l}=_t((async()=>{const t=await yi({path:e.path}),n=t.contents||"";return r(jO.get(e.path)||n),t}),[e.path]),c=async()=>{n!==(null==i?void 0:i.contents)&&await Si({path:e.path,contents:n}).then((e=>{e.success&&(l((e=>e?{...e,contents:n}:void 0)),r(n))}))},d=o.useRef(n);if(d.current=n,o.useEffect((()=>()=>{if(!i)return;const t=d.current;t===i.contents?jO.delete(e.path):jO.set(e.path,t)}),[e.path,null==i?void 0:i.contents]),s)return x.jsx(xi,{error:s});if(a||!i)return null;const u=i.mimeType||"text/plain";if(!i.contents)return x.jsxs("div",{className:"grid grid-cols-2 gap-2 p-6",children:[x.jsx("div",{className:"font-bold text-muted-foreground",children:"Name"}),x.jsx("div",{children:i.file.name}),x.jsx("div",{className:"font-bold text-muted-foreground",children:"Type"}),x.jsx("div",{children:u})]});const h=x.jsxs("div",{className:"text-xs text-muted-foreground p-1 flex justify-end gap-2 border-b",children:[x.jsx(b,{content:"Download",children:x.jsx(Gi,{size:"small",onClick:()=>{if(PO(u)){const e=Ci(i.contents,u);Ni(e,i.file.name)}else A(new Blob([i.contents||n],{type:u}),i.file.name)},children:x.jsx(Qe,{})})}),!PO(u)&&x.jsxs(x.Fragment,{children:[x.jsx(b,{content:"Copy contents to clipboard",children:x.jsx(Gi,{size:"small",onClick:()=>{navigator.clipboard.writeText(n)},children:x.jsx(Be,{})})}),x.jsx(b,{content:jl("global.save"),children:x.jsx(Gi,{size:"small",color:n===i.contents?void 0:"green",onClick:c,disabled:n===i.contents,children:x.jsx(Ls,{})})})]})]});return u.startsWith("image/")?x.jsxs(x.Fragment,{children:[h,x.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:x.jsx(MO,{base64:i.contents,mime:u})})]}):"text/csv"===u?x.jsxs(x.Fragment,{children:[h,x.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:x.jsx(OO,{contents:i.contents})})]}):u.startsWith("audio/")?x.jsxs(x.Fragment,{children:[h,x.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:x.jsx(DO,{base64:i.contents,mime:u})})]}):u.startsWith("video/")?x.jsxs(x.Fragment,{children:[h,x.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:x.jsx(TO,{base64:i.contents,mime:u})})]}):x.jsxs(x.Fragment,{children:[h,x.jsx("div",{className:"flex-1 overflow-auto",children:x.jsx(bi,{theme:"dark"===t?"dark":"light",language:AO[u]||AO.default,className:"border-b",extensions:[wt.lineWrapping,Jt.of([{key:f.getHotkey("global.save").key,stopPropagation:!0,run:()=>n!==i.contents&&(c(),!0)}])],value:n,onChange:r})})]})},OO=({contents:e})=>{const t=o.useMemo((()=>wi(e)),[e]),n=o.useMemo((()=>ki(t,[],null)),[t]);return x.jsx(Ei,{data:t,columns:n,wrapperClassName:"h-full justify-between pb-1 px-1",pagination:!0,pageSize:10,className:"rounded-none border-b flex overflow-hidden",rowSelection:v.EMPTY})},MO=({mime:e,base64:t})=>x.jsx("img",{src:Ci(t,e),alt:"Preview"}),DO=({mime:e,base64:t})=>x.jsx("audio",{controls:!0,src:Ci(t,e)}),TO=({mime:e,base64:t})=>x.jsx("video",{controls:!0,src:Ci(t,e)}),PO=e=>!!e&&(e.startsWith("image/")||e.startsWith("audio/")||e.startsWith("video/")),AO={"application/javascript":"javascript","text/markdown":"markdown","text/html":"html","text/css":"css","text/x-python":"python","application/json":"json","application/xml":"xml","text/x-yaml":"yaml","text/csv":"markdown","text/plain":"markdown",default:"markdown"};const _O=c(new class{constructor(e){t(this,"delegate",new wO([])),t(this,"rootPath",""),t(this,"onChange",m.NOOP),t(this,"path",new ji("/")),t(this,"initialize",(async e=>{if(this.onChange=e,0===this.delegate.data.length)try{const e=await this.callbacks.listFiles({path:this.rootPath});this.delegate=new wO(e.files),this.rootPath=e.root,this.path=ji.guessDeliminator(e.root)}catch(t){Q({title:"Failed",description:$r(t)})}this.onChange(this.delegate.data)})),t(this,"refreshAll",(async e=>{const t=[this.rootPath,...e.map((e=>{var t;return null==(t=this.delegate.find(e))?void 0:t.data.path}))].filter(Boolean),n=await Promise.all(t.map((e=>this.callbacks.listFiles({path:e}).catch((()=>({files:[]}))))));for(const[r,o]of t.entries()){const e=n[r];o===this.rootPath?this.delegate=new wO(e.files):this.delegate.update({id:o,changes:{children:e.files}})}this.onChange(this.delegate.data)})),t(this,"relativeFromRoot",(e=>{const t=function(e){return e.endsWith("/")?e:`${e}/`}(this.rootPath);return e.startsWith(t)?e.slice(t.length):e})),t(this,"handleResponse",(e=>{e.success||Q({title:"Failed",description:e.message})})),this.callbacks=e}async expand(e){const t=this.delegate.find(e);if(!t)return!1;if(!t.data.isDirectory)return!1;if(t.children&&t.children.length>0)return!0;const n=await this.callbacks.listFiles({path:t.data.path});return this.delegate.update({id:e,changes:{children:n.files}}),this.onChange(this.delegate.data),!0}async rename(e,t){const n=this.delegate.find(e);if(!n)return;const r=n.data.path,o=this.path.join(this.path.dirname(r),t);await this.callbacks.renameFileOrFolder({path:r,newPath:o}).then(this.handleResponse),this.delegate.update({id:e,changes:{name:t,path:o}}),this.onChange(this.delegate.data)}async move(e,t){var n;const r=t?(null==(n=this.delegate.find(t))?void 0:n.data.path)??t:this.rootPath;await Promise.all(e.map((e=>{this.delegate.move({id:e,parentId:t,index:0});const n=this.delegate.find(e);if(!n)return Promise.resolve();const o=this.path.join(r,this.path.basename(n.data.path));return this.delegate.update({id:e,changes:{path:o}}),this.callbacks.renameFileOrFolder({path:n.data.path,newPath:o}).then(this.handleResponse)}))),this.onChange(this.delegate.data),await this.refreshAll([r])}async delete(e){const t=this.delegate.find(e);t&&(await this.callbacks.deleteFileOrFolder({path:t.data.path}).then(this.handleResponse),this.delegate.drop({id:e}),this.onChange(this.delegate.data))}}({listFiles:Rt,createFileOrFolder:Ii,deleteFileOrFolder:Oi,renameFileOrFolder:Mi})),RO=c({});function zO(e={}){return Di({multiple:!0,maxSize:52428800,onError:e=>{y.error(e),Q({title:"File upload failed",description:e.message,variant:"danger"})},onDropRejected:e=>{Q({title:"File upload failed",description:x.jsx("div",{className:"flex flex-col gap-1",children:e.map((e=>x.jsxs("div",{children:[e.file.name," (",e.errors.map((e=>e.message)).join(", "),")"]},e.file.name)))}),variant:"danger"})},onDrop:async e=>{for(const t of e){const e=(await Ti(t)).split(",")[1];await Ii({path:"",type:"file",name:t.name,contents:e})}await async function(){await te.get(_O).refreshAll([])}()},...e})}const LO=s.createContext(null),BO=({height:e})=>{const[t]=E(_O),[n,r]=o.useState([]),[i,a]=E(RO),[s,l]=o.useState(null),{loading:c,error:d}=_t((()=>t.initialize(r)),[]);return c?x.jsx(ca,{size:"medium",centered:!0}):d?x.jsx(xi,{error:d}):s?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"flex items-center pl-1 pr-3 flex-shrink-0 border-b justify-between",children:[x.jsx(P,{onClick:()=>l(null),"data-testid":"file-explorer-back-button",variant:"text",size:"xs",className:"mb-0",children:x.jsx(Za,{size:16})}),x.jsx("span",{className:"font-bold",children:s.name})]}),x.jsx(o.Suspense,{children:x.jsx(IO,{file:s})})]}):x.jsxs(x.Fragment,{children:[x.jsx(HO,{onRefresh:()=>t.refreshAll(Object.keys(i).filter((e=>i[e])))}),x.jsx(LO.Provider,{value:t,children:x.jsx(NO,{width:"100%",height:e-33,className:"h-full",data:n,initialOpenState:i,openByDefault:!1,renderCursor:()=>null,disableDrop:({parentNode:e})=>!e.data.isDirectory,onDelete:async({ids:e})=>{for(const n of e)await t.delete(n)},onRename:async({id:e,name:n})=>{await t.rename(e,n)},onMove:async({dragIds:e,parentId:n})=>{await t.move(e,n)},onSelect:e=>{const t=e[0];t&&(t.data.isDirectory||l(t.data))},onToggle:async e=>{if(await t.expand(e)){const t=i[e]??!1;a({...i,[e]:!t})}},padding:15,rowHeight:30,indent:FO,overscanCount:1e3,disableMultiSelection:!0,children:WO})})]})},FO=15,HO=({onRefresh:e})=>{const{getRootProps:t,getInputProps:n}=zO({noDrag:!0,noDragEventsBubbling:!0});return x.jsxs("div",{className:"flex items-center justify-end px-2 flex-shrink-0 border-b",children:[x.jsx(b,{content:"Upload file",children:x.jsx("button",{"data-testid":"file-explorer-upload-button",...t({}),className:Pi({variant:"text",size:"xs",className:"mb-0"}),children:x.jsx(Ai,{size:16})})}),x.jsx("input",{...n({}),type:"file"}),x.jsx(b,{content:"Refresh",children:x.jsx(P,{"data-testid":"file-explorer-refresh-button",onClick:e,variant:"text",size:"xs",className:"mb-0",children:x.jsx(_i,{size:16})})})]})},VO=({node:e})=>x.jsx("span",{className:"flex-1 overflow-hidden text-ellipsis",onClick:t=>{e.data.isDirectory||(t.stopPropagation(),e.select())},children:e.data.name}),$O=({node:e})=>{const t=o.useRef(null);return o.useEffect((()=>{var n,r;null==(n=t.current)||n.focus(),null==(r=t.current)||r.setSelectionRange(0,e.data.name.lastIndexOf("."))}),[e.data.name]),x.jsx("input",{ref:t,className:"flex-1 bg-transparent border border-border text-muted-foreground",defaultValue:e.data.name,onClick:e=>e.stopPropagation(),onBlur:()=>e.reset(),onKeyDown:t=>{"Escape"===t.key&&e.reset(),"Enter"===t.key&&e.submit(t.currentTarget.value)}})},WO=({node:e,style:t,dragHandle:n})=>{const r=e.data.isDirectory?"directory":zt(e.data.name),i=Vt[r],{openConfirm:a}=M(),s=o.useContext(LO);return x.jsxs("div",{style:t,ref:n,className:Mt("flex items-center cursor-pointer ml-1 text-muted-foreground whitespace-nowrap group"),draggable:!0,onClick:t=>{t.stopPropagation(),e.data.isDirectory&&e.toggle()},children:[x.jsx(UO,{node:e}),x.jsxs("span",{className:Mt("flex items-center pl-1 py-1 cursor-pointer hover:bg-accent/50 hover:text-accent-foreground rounded-l flex-1 overflow-hidden",e.willReceiveDrop&&e.data.isDirectory&&"bg-accent/80 hover:bg-accent/80 text-accent-foreground"),children:[x.jsx(i,{className:"w-5 h-5 flex-shrink-0 mr-2",strokeWidth:1.5}),e.isEditing?x.jsx($O,{node:e}):x.jsx(VO,{node:e}),x.jsxs(at,{modal:!1,children:[x.jsx(st,{asChild:!0,tabIndex:-1,onClick:e=>e.stopPropagation(),children:x.jsx(P,{"data-testid":"file-explorer-more-button",variant:"text",tabIndex:-1,size:"xs",className:"mb-0","aria-label":"More options",children:x.jsx(gs,{strokeWidth:2,className:"w-5 h-5 hidden group-hover:block"})})}),x.jsxs(lt,{align:"end",className:"no-print w-[220px]",onClick:e=>e.stopPropagation(),onCloseAutoFocus:e=>e.preventDefault(),children:[!e.data.isDirectory&&x.jsxs(gt,{onSelect:()=>e.select(),children:[x.jsx(Qs,{className:"mr-2",size:14,strokeWidth:1.5}),"Open file"]}),x.jsxs(gt,{onSelect:()=>e.edit(),children:[x.jsx(As,{className:"mr-2",size:14,strokeWidth:1.5}),"Rename"]}),x.jsxs(gt,{onSelect:()=>{Q({title:"Copied to clipboard",description:"Code to open the file has been copied to your clipboard. You can also drag and drop this file into the editor"});const{path:t}=e.data,n=Ri[r](t);navigator.clipboard.writeText(n)},children:[x.jsx(Be,{className:"mr-2",size:14,strokeWidth:1.5}),"Copy snippet to clipboard"]}),e.data.isMarimoFile&&!_()&&x.jsxs(x.Fragment,{children:[x.jsx(ft,{}),x.jsxs(gt,{onSelect:async t=>{t.stopPropagation(),t.preventDefault();const n=s?s.relativeFromRoot(e.data.path):e.data.path;window.open(`/?file=${n}`,"_blank")},children:[x.jsx(Gs,{className:"mr-2",size:14,strokeWidth:1.5}),"Open notebook"]})]}),x.jsx(ft,{}),x.jsxs(gt,{onSelect:async t=>{t.stopPropagation(),t.preventDefault(),a({title:"Delete file",description:`Are you sure you want to delete ${e.data.name}?`,confirmAction:x.jsx(He,{onClick:async()=>{await e.tree.delete(e.id)},"aria-label":"Confirm",children:"Delete"})})},variant:"danger",children:[x.jsx(ye,{className:"mr-2",size:14,strokeWidth:1.5}),"Delete"]})]})]})]})]})},UO=({node:e})=>e.data.isDirectory?e.isOpen?x.jsx(ve,{className:"w-5 h-5 flex-shrink-0"}):x.jsx(zi,{className:"w-5 h-5 flex-shrink-0"}):x.jsx("span",{className:"w-5 h-5 flex-shrink-0"}),YO=()=>{const{ref:e,height:t=1}=hC(),{getRootProps:n,getInputProps:r,isDragActive:o}=zO({noClick:!0,noKeyboard:!0});return x.jsxs("div",{...n(),className:Mt("flex flex-col flex-1 overflow-hidden relative"),children:[x.jsx("input",{...r()}),o&&x.jsx("div",{className:"absolute inset-0 flex items-center uppercase justify-center text-xl font-bold text-primary/90 bg-accent/85 z-10 border-2 border-dashed border-primary/90 rounded-lg pointer-events-none",children:"Drop files here"}),x.jsx("div",{ref:e,className:"flex flex-col flex-1 overflow-hidden",children:x.jsx(BO,{height:t})})]})},GO=({children:e})=>{const{openModal:t,closeModal:n}=M();return x.jsx(Bo,{onClick:()=>t(x.jsx(KO,{onClose:n})),children:e})},qO=[wt.lineWrapping],KO=({onClose:e})=>{const[t,n]=o.useState(""),{theme:r}=be();return x.jsx(j,{className:"w-fit",children:x.jsxs("form",{onSubmit:async t=>{t.preventDefault();const n=new FormData(t.target),r=n.get("title"),o=n.get("description"),i=n.get("code");fetch("https://marimo.io/api/suggest-snippet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r,description:o,code:i})}),e(),Q({title:"Snippet Submitted",description:"Thank you for contributing! We will review your snippet shortly."})},children:[x.jsxs(I,{children:[x.jsx(O,{children:"Contribute a Snippet"}),x.jsxs(D,{children:["Have a useful snippet you want to share with the community? Submit it here or make a pull request"," ",x.jsx("a",{href:ze.githubPage,target:"_blank",rel:"noreferrer",className:"underline",children:"on GitHub"}),"."]})]}),x.jsxs("div",{className:"flex flex-col gap-6 py-4",children:[x.jsx(Le,{id:"title",name:"title",autoFocus:!0,placeholder:"Title",required:!0,autoComplete:"off"}),x.jsx(Fo,{id:"description",name:"description",autoFocus:!0,placeholder:"Description",rows:5,required:!0,autoComplete:"off"}),x.jsx("input",{type:"hidden",name:"code",value:t}),x.jsx(bi,{theme:"dark"===r?"dark":"light",language:"python",className:"cm border rounded overflow-hidden",extensions:qO,value:t,onChange:n})]}),x.jsxs(T,{children:[x.jsx(P,{"data-testid":"snippet-cancel-button",variant:"secondary",onClick:e,children:"Cancel"}),x.jsx(P,{"data-testid":"snippet-send-button","aria-label":"Save",variant:"default",type:"submit",children:"Send"})]})]})})},XO=[wt.lineWrapping],ZO=()=>{const[e,t]=s.useState(),{data:n,error:r,loading:i}=_t((()=>Li()),[]);return r?x.jsx(xi,{error:r}):i||!n?x.jsx(ca,{size:"medium",centered:!0}):x.jsxs("div",{className:"flex-1 overflow-hidden",children:[x.jsxs(Bt,{className:Mt("border-b rounded-none",e?"h-1/3":"h-full"),children:[x.jsxs("div",{className:"flex items-center w-full",children:[x.jsx(je,{placeholder:"Search snippets...",className:"h-6 m-1",rootClassName:"flex-1 border-r"}),x.jsx(GO,{children:x.jsx("button",{className:"float-right border-b px-2 m-0 h-full hover:bg-accent hover:text-accent-foreground",children:x.jsx(Un,{className:"h-4 w-4"})})})]}),x.jsx(Oe,{children:"No results"}),x.jsx(QO,{onSelect:e=>t(e),snippets:n.snippets})]}),x.jsx(o.Suspense,{children:x.jsx("div",{className:"h-2/3 snippet-viewer flex flex-col",children:e?x.jsx(JO,{snippet:e},e.title):x.jsx(Jg,{title:"",description:"Click on a snippet to view its content."})})})]})},JO=({snippet:e})=>{const{theme:t}=be(),{createNewCell:n}=X(),r=d(Jl);return x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"text-sm font-semibold bg-muted border-y px-2 py-1",children:e.title}),x.jsxs("div",{className:"px-2 py-2 space-y-4 overflow-auto flex-1",children:[x.jsx("div",{className:"flex justify-end",children:x.jsxs(P,{className:"float-right",size:"xs",variant:"outline",onClick:()=>{for(const t of[...e.sections].reverse())t.code&&n({code:t.code,before:!1,cellId:r??"__end__"})},children:["Insert snippet",x.jsx(ns,{className:"ml-2 h-4 w-4"})]})}),e.sections.map((o=>{const{code:i,html:a,id:s}=o;return a?x.jsx("div",{children:ao({html:a})},`${e.title}-${s}`):i?x.jsxs("div",{className:"relative hover-actions-parent pr-2",children:[x.jsx(b,{content:"Insert snippet",children:x.jsx(P,{className:"absolute -top-2 -right-1 z-10 hover-action px-2 bg-background",size:"sm",variant:"outline",onClick:()=>{(e=>{n({code:e,before:!1,cellId:r??"__end__"})})(i)},children:x.jsx(ns,{className:"h-5 w-5"})})}),x.jsx(bi,{theme:"dark"===t?"dark":"light",language:"python",className:"cm border rounded overflow-hidden",extensions:XO,value:i,readOnly:!0},`${e.title}-${s}`)]},`${e.title}-${s}`):null}))]})]})},QO=({snippets:e,onSelect:t})=>x.jsx(Bi,{className:"flex flex-col overflow-auto",children:e.map((e=>x.jsx(Pe,{className:"rounded-none",onSelect:()=>t(e),children:x.jsx("div",{className:"flex flex-row gap-2 items-center",children:x.jsx("span",{className:"mt-1 text-accent-foreground",children:e.title})})},e.title)))}),eM={boolean:Fi,date:Hi,number:qa,string:Ka,integer:Xa,unknown:Ka},tM=({value:e,className:t,tooltip:n})=>{const[r,i]=o.useState(!1),a=Fe.stopPropagation((()=>{navigator.clipboard.writeText(e).then((()=>{i(!0),setTimeout((()=>i(!1)),2e3)}))})),s=x.jsx("span",{onClick:a,children:r?x.jsx(ot,{className:Mt(t,"text-[var(--grass-11)]")}):x.jsx(Be,{className:t})});return!1===n?s:x.jsx(b,{content:r?"Copied!":n??"Copy to clipboard",delayDuration:400,children:s})},nM=()=>{const[e,t]=s.useState(""),n=d(ie),r=d(Jl),{tables:o,expandedColumns:i,expandedTables:a,columnsPreviews:l}=La(),{toggleTable:c,toggleColumn:u,closeAllColumns:h}=Ba(),{createNewCell:f}=X();if(0===o.length)return x.jsx(Jg,{title:"No tables found",description:"Any datasets/dataframes in the global scope will be shown here.",icon:x.jsx(Ye,{})});const p=!!e.trim();return x.jsx("div",{className:"flex-1 overflow-hidden",children:x.jsxs(Bt,{className:Mt("border-b bg-background rounded-none","h-full"),children:[x.jsxs("div",{className:"flex items-center w-full",children:[x.jsx(je,{placeholder:"Search tables...",className:"h-6 m-1",value:e,onValueChange:e=>{e.length>0&&h(),t(e)},rootClassName:"flex-1 border-r"}),p&&x.jsx("button",{type:"button",className:"float-right border-b px-2 m-0 h-full hover:bg-accent hover:text-accent-foreground",onClick:()=>t(""),children:x.jsx(jt,{className:"h-4 w-4"})})]}),x.jsx(rM,{onAddColumnChart:e=>{!function(e,t,n){Kl("altair","alt",(r=>{const o=ne.create();t({cellId:n??"__end__",before:!1,code:r,lastCodeRun:e?r:void 0,newCellId:o,autoFocus:!1}),e&&K([o],[r])}))}(n,f,r),f({code:e,before:!1,cellId:r??"__end__"})},onAddTable:e=>{Xl(n,f,r),f({code:`mo.ui.table(${e.name})`,before:!1,cellId:r??"__end__"})},onExpandColumn:(e,t)=>{const n=`${e.name}:${t.name}`;u({table:e.name,column:t.name}),l.has(n)||Vi({source:e.source,tableName:e.name,columnName:t.name})},onExpandTable:e=>{c(e.name)},columnPreviews:l,tables:o,isSearching:p,isTableExpanded:e=>!!p||a.has(e.name),isColumnExpanded:(e,t)=>{const n=`${e.name}:${t.name}`;return i.has(n)}})]})})},rM=({tables:e,isSearching:t,columnPreviews:n,onAddColumnChart:r,onAddTable:o,onExpandTable:i,onExpandColumn:a,isTableExpanded:l,isColumnExpanded:c})=>x.jsx(Bi,{className:"flex flex-col overflow-auto",children:e.flatMap((e=>{const d=l(e),u=[x.jsx(oM,{table:e,forceMount:t,onExpand:()=>i(e),onAddTable:()=>o(e),isExpanded:d},e.name)];return d&&u.push(...e.columns.map((t=>x.jsxs(s.Fragment,{children:[x.jsx(iM,{table:e,column:t,onExpandColumn:a,isExpanded:c(e,t)},`${e.name}.${t.name}`),c(e,t)&&x.jsx("div",{className:"pl-10 pr-2 py-2 bg-[var(--slate-1)] shadow-inner border-b",children:x.jsx($i,{children:x.jsx(sM,{onAddColumnChart:r,preview:n.get(`${e.name}:${t.name}`)})})})]},`${e.name}.${t.name}`)))),u}))}),oM=({table:e,onExpand:t,onAddTable:n,isExpanded:r})=>x.jsxs(Pe,{className:"rounded-none py-1 group min-h-9 border-t",value:e.name,"aria-selected":r,forceMount:!0,onSelect:t,children:[x.jsxs("div",{className:"flex gap-1 items-center flex-1",children:[x.jsx(zi,{className:Mt("h-3 w-3 transition-transform",r&&"rotate-90")}),x.jsx("span",{className:"text-sm",children:e.name})]}),null==e.num_rows||null==e.num_columns?null:x.jsx("div",{className:"flex flex-row gap-2 items-center pl-6 group-hover:hidden",children:x.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.num_rows," rows, ",e.num_columns," columns"]})}),x.jsx(b,{content:"Add table to notebook",delayDuration:400,children:x.jsx(P,{className:"group-hover:inline-flex hidden",variant:"text",size:"icon",onClick:Fe.stopPropagation((()=>n(e))),children:x.jsx(qs,{className:"h-3 w-3"})})})]}),iM=({table:e,column:t,onExpandColumn:n})=>{const r=eM[t.type];return x.jsxs(Pe,{className:"rounded-none py-1 group",value:`${e.name}.${t.name}`,onSelect:()=>n(e,t),children:[x.jsxs("div",{className:"flex flex-row gap-2 items-center pl-6 flex-1",children:[x.jsx(r,{className:"h-3 w-3",strokeWidth:1.5}),x.jsx("span",{children:t.name})]}),x.jsx(b,{content:"Copy column name",delayDuration:400,children:x.jsx(P,{variant:"text",size:"icon",className:"group-hover:opacity-100 opacity-0 hover:bg-muted text-muted-foreground hover:text-foreground",children:x.jsx(tM,{tooltip:!1,value:t.name,className:"h-3 w-3"})})})]},`${e.name}.${t.name}`)},aM=s.lazy((()=>Wi((()=>import("./index-Bnk1doKe.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url).then((e=>({default:e.VegaLite}))))),sM=({preview:e,onAddColumnChart:t})=>{const{theme:n}=be();if(!e)return x.jsx("span",{className:"text-xs text-muted-foreground",children:"Loading..."});const r=e.error&&x.jsx("span",{className:"text-xs text-muted-foreground",children:e.error}),o=e.summary&&x.jsx("div",{className:"gap-x-16 gap-y-1 grid grid-cols-2-fit border rounded p-2 empty:hidden",children:Object.entries(e.summary).map((([e,t])=>null==t?null:x.jsxs("div",{className:"flex items-center gap-1 group",children:[x.jsx(tM,{className:"h-3 w-3 invisible group-hover:visible",value:t}),x.jsx("span",{className:"text-xs min-w-[60px] uppercase",children:e}),x.jsx("span",{className:"text-xs font-bold text-muted-foreground tracking-wide",children:Ui(t)})]},e)))}),i=e.chart_spec&&x.jsx(aM,{spec:JSON.parse(e.chart_spec),width:"container",height:100,actions:!1,theme:"dark"===n?"dark":"vox"}),a=e.chart_code&&x.jsx(b,{content:"Add chart to notebook",delayDuration:400,children:x.jsx(P,{variant:"outline",size:"icon",className:"z-10 bg-background absolute right-1 top-0",onClick:Fe.stopPropagation((()=>t(e.chart_code||""))),children:x.jsx(qs,{className:"h-3 w-3"})})}),s=e.chart_max_rows_errors&&x.jsx("span",{className:"text-xs text-muted-foreground",children:"Too many rows to render the chart."});return r||o||i||s?x.jsxs("div",{className:"flex flex-col gap-2 relative",children:[r,a,s,i,o]}):x.jsx("span",{className:"text-xs text-muted-foreground",children:"No data"})},lM=({children:e})=>{const{isOpen:t,selectedPanel:n}=pc(),{setIsOpen:r}=gc(),i=s.useRef(null),a="left";o.useEffect((()=>{if(!i.current)return;const e=i.current.isCollapsed();t&&e&&i.current.expand(),t||e||i.current.collapse(),requestAnimationFrame((()=>{requestAnimationFrame((()=>{window.dispatchEvent(new Event("resize"))}))}))}),[t]);const l=x.jsx(jp,{id:"app",className:"relative h-full",children:x.jsx(o.Suspense,{children:e})},`app-${a}`),c=x.jsx(Rg,{onDragging:e=>{e||window.dispatchEvent(new Event("resize"))},className:Mt("border-border no-print z-10",t?"resize-handle":"resize-handle-collapsed","vertical")}),d=x.jsx(o.Suspense,{children:x.jsxs("div",{className:"flex flex-col h-full flex-1 overflow-hidden mr-[-4px]",children:[x.jsxs("div",{className:"p-3 border-b flex justify-between items-center",children:[x.jsx("div",{className:"text-sm text-[var(--slate-11)] uppercase tracking-wide font-semibold flex-1",children:n}),x.jsx(P,{"data-testid":"close-helper-pane",className:"m-0",size:"xs",variant:"text",onClick:()=>r(!1),children:x.jsx(jt,{className:"w-4 h-4"})})]}),"files"===n&&x.jsx(YO,{}),"errors"===n&&x.jsx(Qg,{}),"variables"===n&&x.jsx(iC,{}),"dependencies"===n&&x.jsx(QE,{}),"outline"===n&&x.jsx(em,{}),"datasources"===n&&x.jsx(nM,{}),"documentation"===n&&x.jsx(dC,{}),"snippets"===n&&x.jsx(ZO,{}),"logs"===n&&x.jsx(aC,{})]})}),u=x.jsx(jp,{ref:i,id:"helper",collapsedSize:0,collapsible:!0,className:Mt("bg-white dark:bg-[var(--slate-1)] no-print",t&&"border-r border-l border-[var(--slate-7)]"),minSize:10,defaultSize:0,maxSize:75,onResize:(e,t)=>{var n;0===t&&10===e&&(null==(n=i.current)||n.resize(30))},onCollapse:()=>r(!1),onExpand:()=>r(!0),children:x.jsxs("span",{className:"flex flex-row h-full",children:[d," ",c]})},`helper-${a}`);return x.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden absolute inset-0",children:[x.jsxs(Pg,{autoSaveId:"marimo:chrome",direction:"horizontal",storage:(h=a,{getItem(e){if(!Zg)return Zg??null;if("left"===h)return Zg;try{const e=Xg.parse(JSON.parse(Zg));return JSON.stringify(v.mapValues(e,(e=>e.reverse())))}catch{return null}},setItem(e,t){if("left"!==h)try{const e=Xg.parse(JSON.parse(t));t=JSON.stringify(v.mapValues(e,(e=>e.reverse())))}catch{return null}Zg=t||null}}),children:[x.jsx(qg,{}),u,l]},a),x.jsx($i,{children:x.jsx($g,{})})]});var h},cM=e=>x.jsxs(lM,{children:[x.jsx(ip,{...e}),x.jsx(rc,{})]});export{cM as default};
